"use strict";(self.webpackChunklc_fe=self.webpackChunklc_fe||[]).push([[398],{8398:(jn,At,s)=>{s.r(At),s.d(At,{AdminModule:()=>Ln});var m=s(6814),Ot=s(9316),O=s(7582),lt=s(9862),t=s(5879);let T=(()=>{class n{static#t=this.USERS_BASE_URL="v1/users";static#e=this.ROLES_BASE_URL="v1/roles";static#n=this.MANAGEMENT_BASE_URL="v1/management";constructor(e){this.http=e}getAllEquipment(){const e=(new lt.LE).set("limit",1e3).set("has_equipments","true");return this.http.get("equipment",{params:e})}getUnavailablePeriodsById(e){return this.http.get(`/equipment/unavailability_periods/${e}`)}archiveEquipment(e){return this.http.post(`/equipment/achive/${e}/`,{equipmentId:e})}blockEquipment(e,i){return this.http.post(`/equipment/${e}/blocking`,{end_date:i.endDate,start_date:i.startDate})}uploadPhoto(e){const i=new FormData;return i.append("file",e,e.name),this.http.post("equipment/photos",i)}registerEquipment(e){return this.http.post("equipment",e)}editEquipment(e,i){return this.http.put(`equipment/${i}`,e)}getEquipmentStatuses(){return this.http.get("/equipment/status_names")}getEquipmentCategories(){return this.http.get("/equipment/categories")}getEquipmentUnavailabilityPeriods(e){return this.http.get(`/equipment/unavailability_periods/${e}`)}getAllUsers(){return this.http.get(n.USERS_BASE_URL)}updateUserReadonlyAccess(e,i){return this.http.put(`${n.USERS_BASE_URL}/${e}/readonly-access`,{is_readonly:i})}deleteUser(e){return this.http.delete(`${n.USERS_BASE_URL}/${e}`)}getAllRoles(){return this.http.get(n.ROLES_BASE_URL)}assignRoleToUser(e,i){return this.http.post(`${n.MANAGEMENT_BASE_URL}/users/${e}/role`,{roleId:i})}getAllOrders(){const e=(new lt.LE).set("limit",1e3).set("has_equipments","true");return this.http.get("/management/orders",{params:e})}getApplicationStatuses(){return this.http.get("/v1/status_names")}editApplicationStatus(e){return this.http.post("/v1/order_statuses/",e)}static#i=this.\u0275fac=function(i){return new(i||n)(t.LFG(lt.eN))};static#o=this.\u0275prov=t.Yz7({token:n,factory:n.\u0275fac})}return n})();var d=s(7700),y=function(n){return n.ArchiveTitle="\u0410\u0440\u0445\u0438\u0432\u0438\u0440\u043e\u0432\u0430\u043d\u0438\u0435 \u043e\u0431\u043e\u0440\u0443\u0434\u043e\u0432\u0430\u043d\u0438\u044f",n.BlockTitle="\u0411\u043b\u043e\u043a\u0438\u0440\u043e\u0432\u043a\u0430 \u043e\u0431\u043e\u0440\u0443\u0434\u043e\u0432\u0430\u043d\u0438\u044f",n.ArchiveReason="\u0410\u0440\u0445\u0438\u0432\u0438\u0440\u043e\u0432\u0430\u043d\u0438\u0435",n.ArchiveApplyButtonText="\u0410\u0440\u0445\u0438\u0432\u0438\u0440\u043e\u0432\u0430\u0442\u044c",n.BlockReason="\u0411\u043b\u043e\u043a\u0438\u0440\u043e\u0432\u043a\u0430",n.BlockApplyButtonText="\u0411\u043b\u043e\u043a\u0438\u0440\u043e\u0432\u0430\u0442\u044c",n.BlockCancelButtonText="\u0420\u0430\u0437\u0431\u043b\u043e\u043a\u0438\u0440\u043e\u0432\u0430\u0442\u044c",n.AddEquipmentHeader="\u0420\u0435\u0433\u0438\u0441\u0442\u0440\u0430\u0446\u0438\u044f \u043d\u043e\u0432\u043e\u0433\u043e \u043e\u0431\u043e\u0440\u0443\u0434\u043e\u0432\u0430\u043d\u0438\u044f",n.EditEquipmentHeader="\u0420\u0435\u0434\u0430\u043a\u0442\u0438\u0440\u043e\u0432\u0430\u043d\u0438\u0435 \u043e\u0431\u043e\u0440\u0443\u0434\u043e\u0432\u0430\u043d\u0438\u044f",n.EditEquipmentModalButtonText="\u0420\u0435\u0434\u0430\u043a\u0442\u0438\u0440\u043e\u0432\u0430\u0442\u044c",n.AddEquipmentModalButtonText="\u0417\u0430\u0440\u0435\u0433\u0438\u0441\u0442\u0440\u0438\u0440\u043e\u0432\u0430\u0442\u044c",n}(y||{}),w=s(554),x=s(2296),rt=function(n){return n.Name="\u041d\u0430\u0437\u0432\u0430\u043d\u0438\u0435",n.NameSubstring="\u041d\u0430\u0438\u043c\u0435\u043d\u043e\u0432\u0430\u043d\u0438\u0435",n.InventoryNumber="\u0418\u043d\u0432\u0435\u043d\u0442\u0430\u0440\u043d\u044b\u0439 \u043d\u043e\u043c\u0435\u0440",n}(rt||{});let Tt=(()=>{class n{static#t=this.\u0275fac=function(i){return new(i||n)};static#e=this.\u0275cmp=t.Xpm({type:n,selectors:[["lc-fake-input"]],inputs:{label:"label",text:"text"},decls:5,vars:2,consts:[[1,"label"],[1,"text"],[1,"separator"]],template:function(i,o){1&i&&(t.TgZ(0,"span",0),t._uU(1),t.qZA(),t.TgZ(2,"span",1),t._uU(3),t.qZA(),t._UZ(4,"div",2)),2&i&&(t.xp6(1),t.Oqu(o.label),t.xp6(2),t.Oqu(o.text))},styles:["[_nghost-%COMP%]{display:flex;flex-direction:column}[_nghost-%COMP%]   span[_ngcontent-%COMP%]{display:inline-block;margin-left:16px}[_nghost-%COMP%]   .label[_ngcontent-%COMP%]{font-size:12px;font-weight:400;line-height:16px;color:#5f5f5f}[_nghost-%COMP%]   .text[_ngcontent-%COMP%]{font-size:16px;color:#000}[_nghost-%COMP%]   .separator[_ngcontent-%COMP%]{border-bottom:1px solid #656565;margin-top:10px}"],changeDetection:0})}return n})();function zt(n,u){if(1&n&&t._UZ(0,"lc-fake-input",1),2&n){const e=t.oxw();t.Q6J("label",e.LabelEnum.Name)("text",e.equipment.name)}}function jt(n,u){if(1&n&&t._UZ(0,"lc-fake-input",1),2&n){const e=t.oxw();t.Q6J("label",e.LabelEnum.NameSubstring)("text",e.equipment.title)}}function Wt(n,u){if(1&n&&t._UZ(0,"lc-fake-input",1),2&n){const e=t.oxw();t.Q6J("label",e.LabelEnum.InventoryNumber)("text",e.equipment.inventoryNumber)}}let Mt=(()=>{class n{constructor(){this.LabelEnum=rt}static#t=this.\u0275fac=function(i){return new(i||n)};static#e=this.\u0275cmp=t.Xpm({type:n,selectors:[["lc-equipment-info"]],inputs:{equipment:"equipment"},decls:3,vars:3,consts:[[3,"label","text",4,"ngIf"],[3,"label","text"]],template:function(i,o){1&i&&(t.YNc(0,zt,1,2,"lc-fake-input",0),t.YNc(1,jt,1,2,"lc-fake-input",0),t.YNc(2,Wt,1,2,"lc-fake-input",0)),2&i&&(t.Q6J("ngIf",o.equipment&&o.equipment.name),t.xp6(1),t.Q6J("ngIf",o.equipment&&o.equipment.title),t.xp6(1),t.Q6J("ngIf",o.equipment&&o.equipment.inventoryNumber))},dependencies:[m.O5,Tt],styles:["lc-fake-input[_ngcontent-%COMP%]{margin-bottom:24px}lc-fake-input[_ngcontent-%COMP%]:last-child{margin-bottom:0}"],changeDetection:0})}return n})(),Kt=(()=>{class n{constructor(e){this.equipment=e,this.ModalEnum=y,this.inventoryNumber=String(this.equipment.inventoryNumber)}static#t=this.\u0275fac=function(i){return new(i||n)(t.Y36(d.WI))};static#e=this.\u0275cmp=t.Xpm({type:n,selectors:[["lc-archive-equipment-modal"]],decls:12,vars:4,consts:[["headerTitle","\u0410\u0440\u0445\u0438\u0432\u0438\u0440\u043e\u0432\u0430\u043d\u0438\u0435 \u043e\u0431\u043e\u0440\u0443\u0434\u043e\u0432\u0430\u043d\u0438\u044f"],["body",""],[1,"content"],[3,"equipment"],["footer",""],[1,"buttons"],["mat-button","",1,"cancel",3,"mat-dialog-close"],["mat-raised-button","","color","primary",3,"mat-dialog-close"]],template:function(i,o){1&i&&(t.TgZ(0,"lc-modal-layout",0),t.ynx(1,1),t.TgZ(2,"div",2)(3,"p"),t._uU(4," \u0421\u0442\u0430\u0442\u0443\u0441 \u043e\u0431\u043e\u0440\u0443\u0434\u043e\u0432\u0430\u043d\u0438\u0435 \u0438\u0437\u043c\u0435\u043d\u0438\u0442\u044c\u0441\u044f \u043d\u0430 \u201c\u0412 \u0430\u0440\u0445\u0438\u0432\u0435\u201d \u0438 \u0441\u043a\u0440\u043e\u0435\u0442\u0441\u044f \u0438\u0437 \u043e\u0431\u0449\u0435\u0433\u043e \u0441\u043f\u0438\u0441\u043a\u0430 \u043e\u0431\u043e\u0440\u0443\u0434\u043e\u0432\u0430\u043d\u0438\u044f. \u041f\u0440\u043e\u0432\u0435\u0440\u044c\u0442\u0435 \u0434\u0430\u043d\u043d\u044b\u0435. "),t.qZA(),t._UZ(5,"lc-equipment-info",3),t.qZA(),t.BQk(),t.ynx(6,4),t.TgZ(7,"div",5)(8,"button",6),t._uU(9," \u041e\u0442\u043c\u0435\u043d\u0438\u0442\u044c "),t.qZA(),t.TgZ(10,"button",7),t._uU(11),t.qZA()(),t.BQk(),t.qZA()),2&i&&(t.xp6(5),t.Q6J("equipment",o.equipment),t.xp6(3),t.Q6J("mat-dialog-close",!1),t.xp6(2),t.Q6J("mat-dialog-close",!0),t.xp6(1),t.hij(" ",o.ModalEnum.ArchiveApplyButtonText," "))},dependencies:[w.m,x.lW,d.ZT,Mt],styles:[".content[_ngcontent-%COMP%]{font-style:normal;font-weight:400;font-size:14px;line-height:24px;letter-spacing:.1px;color:#000}.content[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin-bottom:24px}.buttons[_ngcontent-%COMP%]{display:flex;justify-content:flex-end;align-items:center}.buttons[_ngcontent-%COMP%]   .cancel[_ngcontent-%COMP%]{margin-right:24px;font-style:normal;font-weight:500;color:#00677f}.buttons[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{height:56px;border-radius:10px;font-style:normal;font-weight:400;line-height:20px;padding:16px;text-transform:uppercase}"],changeDetection:0})}return n})();var G=s(5619),Z=s(9397),_=s(7398),c=s(4664),f=s(2181),F=s(2096),Xt=s(9315),l=s(6223),te=s(4347),h=s(388),H=s(9118),ee=s(4315),z=s(5659),P=s(8034),D=s(4170);let ct=class Et{constructor(u,e,i,o,a){this.dialogData=u,this.dialogRef=e,this.fb=i,this.validationService=o,this.dateRangeService=a,this.formName="block_equipment_modal",this.unavailablePeriods=[],this.ModalEnum=y,this.LabelEnum=rt,this.minDate=null,this.form=this.fb.group({startDate:[null,l.kI.required],endDate:[null,l.kI.required]})}ngOnInit(){this.equipment=this.dialogData.equipment,this.unavailablePeriods=this.dialogData.unavailablePeriods,this.minDate=new Date}blockEquipment(){this.validationService.emitSubmit(this.formName),this.form.valid?this.dialogRef.close(this.form.getRawValue()):this.form.markAllAsTouched()}openDatePicker(){this.dateRangeService.openDateRangeModal(this.dateRangeConfig).pipe((0,h.t)(this)).subscribe(u=>{u&&this.setFormValue({startDate:new Date(u.start_date),endDate:new Date(u.end_date)})})}setFormValue(u){this.form.setValue(u)}get dateRangeConfig(){return{headerText:"\u0412\u044b\u0431\u0435\u0440\u0438\u0442\u0435 \u043f\u0435\u0440\u0438\u043e\u0434 \u0431\u043b\u043e\u043a\u0438\u0440\u043e\u0432\u043a\u0438",buttonText:"\u0432\u044b\u0431\u0440\u0430\u0442\u044c",maxRentalPeriod:14,unavailableDates:this.unavailablePeriods,purpose:te.z.block}}static#t=this.\u0275fac=function(e){return new(e||Et)(t.Y36(d.WI),t.Y36(d.so),t.Y36(l.QS),t.Y36(H.R),t.Y36(ee.s))};static#e=this.\u0275cmp=t.Xpm({type:Et,selectors:[["lc-block-equipment-modal"]],decls:18,vars:9,consts:[[3,"headerTitle"],["body",""],[3,"equipment"],[3,"formGroup"],[3,"min"],["matStartDate","","formControlName","startDate","placeholder","\u041d\u0430\u0447\u0430\u043b\u043e",3,"lcValidationErrors"],["matEndDate","","formControlName","endDate","placeholder","\u041a\u043e\u043d\u0435\u0446",3,"lcValidationErrors"],["matIconSuffix","",3,"click"],["footer",""],[1,"buttons-wrapper"],[1,"buttons"],["mat-button","",1,"cancel",3,"mat-dialog-close"],["mat-raised-button","","color","primary",3,"click"]],template:function(e,i){1&e&&(t.TgZ(0,"lc-modal-layout",0),t.ynx(1,1),t._UZ(2,"lc-equipment-info",2),t.TgZ(3,"form",3)(4,"mat-form-field")(5,"mat-label"),t._uU(6,"\u041f\u0435\u0440\u0438\u043e\u0434 \u0431\u043b\u043e\u043a\u0438\u0440\u043e\u0432\u043a\u0438"),t.qZA(),t.TgZ(7,"mat-date-range-input",4),t._UZ(8,"input",5)(9,"input",6),t.qZA(),t.TgZ(10,"mat-datepicker-toggle",7),t.NdJ("click",function(){return i.openDatePicker()}),t.qZA()()(),t.BQk(),t.ynx(11,8),t.TgZ(12,"div",9)(13,"div",10)(14,"button",11),t._uU(15),t.qZA(),t.TgZ(16,"button",12),t.NdJ("click",function(){return i.blockEquipment()}),t._uU(17),t.qZA()()(),t.BQk(),t.qZA()),2&e&&(t.Q6J("headerTitle",i.ModalEnum.BlockTitle),t.xp6(2),t.Q6J("equipment",i.equipment),t.xp6(1),t.Q6J("formGroup",i.form),t.xp6(4),t.Q6J("min",i.minDate),t.xp6(1),t.Q6J("lcValidationErrors",i.formName),t.xp6(1),t.Q6J("lcValidationErrors",i.formName),t.xp6(5),t.Q6J("mat-dialog-close",!1),t.xp6(1),t.hij(" ",i.ModalEnum.BlockCancelButtonText," "),t.xp6(2),t.hij(" ",i.ModalEnum.BlockApplyButtonText," "))},dependencies:[w.m,z.D,x.lW,P.nW,P.wx,P.zY,P.By,d.ZT,D.KE,D.hX,D.R9,l._Y,l.Fj,l.JJ,l.JL,l.sg,l.u,Mt],styles:["[_nghost-%COMP%]{display:block}form[_ngcontent-%COMP%]{margin-top:24px}form[_ngcontent-%COMP%]   mat-form-field[_ngcontent-%COMP%]{width:100%}form[_ngcontent-%COMP%]   .date[_ngcontent-%COMP%]{max-width:200px}.buttons[_ngcontent-%COMP%]{display:flex;justify-content:flex-end;align-items:center}.buttons[_ngcontent-%COMP%]   .cancel[_ngcontent-%COMP%]{font-style:normal;font-weight:500;color:#00677f}.buttons[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{font-style:normal;font-weight:400;margin-right:24px;line-height:20px;text-transform:uppercase;height:56px;border-radius:10px}.buttons[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]:last-child{margin-right:0}"],changeDetection:0})};ct=(0,O.gn)([h.c],ct);var k=s(3612),pt=s(617);function ne(n,u){1&n&&(t.ynx(0),t._uU(1," \u0412 \u044d\u0442\u0438 \u0434\u0430\u0442\u044b \u043e\u0431\u043e\u0440\u0443\u0434\u043e\u0432\u0430\u043d\u0438\u0435 \u0437\u0430\u0431\u0440\u043e\u043d\u0438\u0440\u043e\u0432\u0430\u043d\u043e. \u0411\u043b\u043e\u043a\u0438\u0440\u043e\u0432\u043a\u0430 \u0441\u0431\u0440\u043e\u0441\u0438\u0442 \u0434\u0430\u043d\u043d\u043e\u0435 \u0431\u0440\u043e\u043d\u0438\u0440\u043e\u0432\u0430\u043d\u0438\u0435. "),t.BQk())}function ie(n,u){1&n&&(t.ynx(0),t._uU(1," \u0410\u0440\u0445\u0438\u0432\u0438\u0440\u043e\u0432\u0430\u043d\u0438\u0435 \u0441\u0431\u0440\u043e\u0441\u0438\u0442 \u0432\u0441\u0435 \u0431\u0440\u043e\u043d\u0438\u0440\u043e\u0432\u0430\u043d\u0438\u044f \u0434\u0430\u043d\u043d\u043e\u0433\u043e \u043e\u0431\u043e\u0440\u0443\u0434\u043e\u0432\u0430\u043d\u0438\u044f. "),t.BQk())}let oe=(()=>{class n{constructor(e){this.action=e,this.actions=k.v,this.header="",this.actionText=""}ngOnInit(){switch(this.action){case this.actions.Block:this.header=y.BlockTitle,this.actionText=y.BlockApplyButtonText;break;case this.actions.Archivate:this.header=y.ArchiveTitle,this.actionText=y.ArchiveApplyButtonText}}static#t=this.\u0275fac=function(i){return new(i||n)(t.Y36(d.WI))};static#e=this.\u0275cmp=t.Xpm({type:n,selectors:[["lc-order-notification-modal"]],decls:17,vars:6,consts:[[3,"headerTitle"],["body",""],[1,"content"],[4,"ngIf"],["fontSet","material-icons-outlined"],["footer",""],[1,"buttons"],["mat-button","",1,"cancel",3,"mat-dialog-close"],["mat-raised-button","","color","primary",3,"mat-dialog-close"]],template:function(i,o){1&i&&(t.TgZ(0,"lc-modal-layout",0),t.ynx(1,1),t.TgZ(2,"div",2)(3,"p"),t.YNc(4,ne,2,0,"ng-container",3),t.YNc(5,ie,2,0,"ng-container",3),t.qZA(),t.TgZ(6,"p"),t._uU(7," \u0414\u043b\u044f \u043f\u0440\u043e\u0441\u043c\u043e\u0442\u0440\u0430 \u0441\u043f\u0438\u0441\u043a\u0430 \u0437\u0430\u044f\u0432\u043e\u043a \u043d\u0430 \u0434\u0430\u043d\u043d\u043e\u0435 \u043e\u0431\u043e\u0440\u0443\u0434\u043e\u0432\u0430\u043d\u0438\u0435, \u0432\u043e\u0441\u043f\u043e\u043b\u044c\u0437\u0443\u0439\u0442\u0435\u0441\u044c \u043a\u043d\u043e\u043f\u043a\u043e\u0439 "),t.TgZ(8,"mat-icon",4),t._uU(9,"list_alt"),t.qZA(),t._uU(10," \u0432 \u0442\u0430\u0431\u043b\u0438\u0446\u0435 \u043e\u0431\u043e\u0440\u0443\u0434\u043e\u0432\u0430\u043d\u0438\u044f. "),t.qZA()(),t.BQk(),t.ynx(11,5),t.TgZ(12,"div",6)(13,"button",7),t._uU(14," \u041e\u0442\u043c\u0435\u043d\u0438\u0442\u044c "),t.qZA(),t.TgZ(15,"button",8),t._uU(16),t.qZA()(),t.BQk(),t.qZA()),2&i&&(t.Q6J("headerTitle",o.header),t.xp6(4),t.Q6J("ngIf",o.action===o.actions.Block),t.xp6(1),t.Q6J("ngIf",o.action===o.actions.Archivate),t.xp6(8),t.Q6J("mat-dialog-close",!1),t.xp6(2),t.Q6J("mat-dialog-close",!0),t.xp6(1),t.hij(" ",o.actionText," "))},dependencies:[m.O5,w.m,x.lW,d.ZT,pt.Hw],styles:["p[_ngcontent-%COMP%]{margin-bottom:0;color:#000000de;font-size:14px;font-weight:400;line-height:22px;letter-spacing:.1px;word-wrap:break-word}mat-icon[_ngcontent-%COMP%]{position:relative;top:8px}.buttons[_ngcontent-%COMP%]{display:flex;justify-content:flex-end;align-items:center}.buttons[_ngcontent-%COMP%]   .cancel[_ngcontent-%COMP%]{margin-right:24px;font-style:normal;font-weight:500;color:#00677f}.buttons[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{height:56px;border-radius:10px;font-style:normal;font-weight:400;line-height:20px;padding:16px;text-transform:uppercase}"],changeDetection:0})}return n})();const ue={available:null,booked:null,"in use":null,"not available":null,archived:null};var q=function(n){return n.is="\u0435\u0441\u0442\u044c",n.not="\u043d\u0435\u0442",n}(q||{});class ae{constructor(u){this.category=u.category,this.compensationCost=u.compensationCost,this.description=u.description,this.inventoryNumber=u.inventoryNumber,this.location=u.location,this.maximumDays=u.maximumDays,this.name=u.name,this.petKinds=u.petKinds,this.petSize=u.petSize,this.photoID=u.photoID,this.receiptDate=this.getDate(u.receiptDate),this.status=u.status,this.supplier=u.supplier,this.technicalIssues=u.technicalIssues===q.is,this.termsOfUse=u.termsOfUse,this.title=u.title,this.subCategory=u.subCategory,this.nameSubstring="str",u.condition&&(this.condition=u.condition),u.nameSubstring&&(this.nameSubstring=u.nameSubstring)}getDate(u){return Number(`${u.getTime()}`.slice(0,-3))}}const Bt=1e50,M={maxWidth:472,minWidth:472,autoFocus:!1};var St=function(n){return n.Users="\u041f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u0438",n.Equipment="\u041e\u0431\u043e\u0440\u0443\u0434\u043e\u0432\u0430\u043d\u0438\u0435",n}(St||{}),p=s(2559);const le=[{header:"\u0418\u043d\u0432\u0435\u043d\u0442\u0430\u0440\u043d\u044b\u0439 \u043d\u043e\u043c\u0435\u0440",columnDef:"inventoryNumber",style:{"width.px":150}},{header:"\u041d\u0430\u0437\u0432\u0430\u043d\u0438\u0435",columnDef:"name",style:null},{header:"\u041d\u0430\u0438\u043c\u0435\u043d\u043e\u0432\u0430\u043d\u0438\u0435",columnDef:"title",style:null},{header:"\u041a\u0430\u0442\u0435\u0433\u043e\u0440\u0438\u044f",columnDef:"categoryName",style:{"width.px":150}},{header:"\u0421\u0442\u0430\u0442\u0443\u0441",columnDef:"statusName",style:{"width.px":150}},{header:"",columnDef:p.vk.Block,action:p.vk.Block,tooltip:"\u0411\u043b\u043e\u043a\u0438\u0440\u043e\u0432\u043a\u0430",style:{"width.px":32,"padding.px":0}},{header:"",columnDef:p.vk.Edit,action:p.vk.Edit,tooltip:"\u0420\u0435\u0434\u0430\u043a\u0442\u0438\u0440\u043e\u0432\u0430\u043d\u0438\u0435",style:{"width.px":32,"padding.px":0}},{header:"",columnDef:p.vk.Archivate,action:p.vk.Archivate,tooltip:"\u0410\u0440\u0445\u0438\u0432\u0438\u0440\u043e\u0432\u0430\u043d\u0438\u0435",style:{"width.px":32,"padding.px":0}},{header:"",columnDef:p.vk.Orders,action:p.vk.Orders,tooltip:"\u041f\u0435\u0440\u0435\u0439\u0442\u0438 \u043a \u0437\u0430\u044f\u0432\u043a\u0430\u043c",style:{"width.px":32,"padding.px":0}}],re={available:"\u0434\u043e\u0441\u0442\u0443\u043f\u043d\u043e",booked:"\u0437\u0430\u0431\u0440\u043e\u043d\u0438\u0440\u043e\u0432\u0430\u043d\u043d\u043e","in use":"\u0438\u0441\u043f\u043e\u043b\u044c\u0437\u0443\u0435\u0442\u0441\u044f","not available":"\u043d\u0435 \u0434\u043e\u0441\u0442\u0443\u043f\u043d\u043e",archived:"\u0430\u0440\u0445\u0438\u0432\u0438\u0440\u043e\u0432\u0430\u043d\u043d\u043e"};var J=function(n){return n.Profile="\u041f\u0440\u043e\u0444\u0438\u043b\u044c",n.Block="\u0411\u043b\u043e\u043a\u0438\u0440\u043e\u0432\u043a\u0430",n.Delete="\u0423\u0434\u0430\u043b\u0435\u043d\u0438\u0435",n.NoDelete="\u0423\u0434\u0430\u043b\u0438\u0442\u044c \u043c\u043e\u0436\u043d\u043e \u0442\u043e\u043b\u044c\u043a\u043e \u0437\u0430\u0431\u043b\u043e\u043a\u0438\u0440\u043e\u0432\u0430\u043d\u043d\u043e\u0433\u043e \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044f",n}(J||{});const ce=[{header:"\u042d\u043b\u0435\u043a\u0442\u0440\u043e\u043d\u043d\u0430\u044f \u043f\u043e\u0447\u0442\u0430",columnDef:"email",style:{"minWidth.px":200}},{header:"\u0422\u0435\u043b\u0435\u0444\u043e\u043d",columnDef:"phone_umber",style:{"minWidth.px":150}},{header:"\u0424\u0430\u043c\u0438\u043b\u0438\u044f",columnDef:"surname",style:{"minWidth.px":200}},{header:"\u0418\u043c\u044f",columnDef:"name",style:{"minWidth.px":200}},{header:"\u0421\u0442\u0430\u0442\u0443\u0441",columnDef:"status",style:{"width.px":150}},{header:"",columnDef:p.Vw.Profile,action:p.Vw.Profile,tooltip:J.Profile,style:{"width.px":32,"padding.px":0}},{header:"",columnDef:p.Vw.Block,action:p.Vw.Block,tooltip:J.Block,style:{"width.px":32,"padding.px":0}},{header:"",columnDef:p.Vw.Delete,action:p.Vw.Delete,tooltip:J.NoDelete,style:{"width.px":32,"padding.px":0}}];var v=function(n){return n.CancelButtonText="\u041e\u0442\u043c\u0435\u043d\u0438\u0442\u044c",n.BlockTitle="\u0411\u043b\u043e\u043a\u0438\u0440\u043e\u0432\u0430\u0442\u044c \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044f",n.BlockButtonText="\u0411\u043b\u043e\u043a\u0438\u0440\u043e\u0432\u0430\u0442\u044c",n.BlockConfirmationText="\u0412\u044b \u0443\u0432\u0435\u0440\u0435\u043d\u044b, \u0447\u0442\u043e \u0445\u043e\u0442\u0438\u0442\u0435 \u0437\u0430\u0431\u043b\u043e\u043a\u0438\u0440\u043e\u0432\u0430\u0442\u044c \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044f",n.BlockDescriptionText="\u0412\u044b\u0431\u0440\u0430\u043d\u043d\u044b\u0439 \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044c \u043d\u0435 \u0431\u0443\u0434\u0435\u0442 \u0438\u043c\u0435\u0442\u044c \u0432\u043e\u0437\u043c\u043e\u0436\u043d\u043e\u0441\u0442\u044c \u0440\u0435\u0434\u0430\u043a\u0442\u0438\u0440\u043e\u0432\u0430\u0442\u044c \u0441\u0432\u043e\u0439 \u043f\u0440\u043e\u0444\u0438\u043b\u044c \u0438 \u043e\u0441\u0442\u0430\u0432\u043b\u044f\u0442\u044c \u0437\u0430\u044f\u0432\u043a\u0438.",n.UnblockTitle="\u0420\u0430\u0437\u0431\u043b\u043e\u043a\u0438\u0440\u043e\u0432\u0430\u0442\u044c \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044f",n.UnblockButtonText="\u0420\u0430\u0437\u0431\u043b\u043e\u043a\u0438\u0440\u043e\u0432\u0430\u0442\u044c",n.UnblockConfirmationText="\u0412\u044b \u0443\u0432\u0435\u0440\u0435\u043d\u044b, \u0447\u0442\u043e \u0445\u043e\u0442\u0438\u0442\u0435 \u0440\u0430\u0437\u0431\u043b\u043e\u043a\u0438\u0440\u043e\u0432\u0430\u0442\u044c \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044f",n.UnblockDescriptionText="\u0412\u044b\u0431\u0440\u0430\u043d\u043d\u044b\u0439 \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044c \u0431\u0443\u0434\u0435\u0442 \u0438\u043c\u0435\u0442\u044c \u0432\u043e\u0437\u043c\u043e\u0436\u043d\u043e\u0441\u0442\u044c \u0440\u0435\u0434\u0430\u043a\u0442\u0438\u0440\u043e\u0432\u0430\u0442\u044c \u0441\u0432\u043e\u0439 \u043f\u0440\u043e\u0444\u0438\u043b\u044c \u0438 \u043e\u0441\u0442\u0430\u0432\u043b\u044f\u0442\u044c \u0437\u0430\u044f\u0432\u043a\u0438.",n.DeleteTitle="\u0423\u0434\u0430\u043b\u0438\u0442\u044c \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044f",n.DeleteButtonText="\u0423\u0434\u0430\u043b\u0438\u0442\u044c",n.DeleteConfirmationText="\u0412\u044b \u0443\u0432\u0435\u0440\u0435\u043d\u044b, \u0447\u0442\u043e \u0445\u043e\u0442\u0438\u0442\u0435 \u0443\u0434\u0430\u043b\u0438\u0442\u044c \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044f",n}(v||{}),j=function(n){return n.Blocked="\u041f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044c \u0437\u0430\u0431\u043b\u043e\u043a\u0438\u0440\u043e\u0432\u0430\u043d",n.Unblocked="\u041f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044c \u0440\u0430\u0437\u0431\u043b\u043e\u043a\u0438\u0440\u043e\u0432\u0430\u043d",n.Deleted="\u041f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044c \u0443\u0434\u0430\u043b\u0435\u043d",n}(j||{}),mt=function(n){return n.Active="\u0410\u043a\u0442\u0438\u0432\u0435\u043d",n.Blocked="\u0417\u0430\u0431\u043b\u043e\u043a\u0438\u0440\u043e\u0432\u0430\u043d",n}(mt||{}),wt=function(n){return n.name="\u041d\u0430\u0437\u0432\u0430\u043d\u0438\u0435",n.title="\u041d\u0430\u0438\u043c\u0435\u043d\u043e\u0432\u0430\u043d\u0438\u0435",n.description="\u041e\u043f\u0438\u0441\u0430\u043d\u0438\u0435",n.category="\u041a\u0430\u0442\u0435\u0433\u043e\u0440\u0438\u044f",n.technicalIssues="\u0422\u0435\u0445\u043d\u0438\u0447\u0435\u0441\u043a\u0438\u0435 \u041e\u0441\u043e\u0431\u0435\u043d\u043d\u043e\u0441\u0442\u0438",n.condition="\u0421\u043e\u0441\u0442\u043e\u044f\u043d\u0438\u0435 \u0438\u0441\u043f\u0440\u0430\u0432\u043d\u043e\u0441\u0442\u0438",n.inventoryNumber="\u0418\u043d\u0432\u0435\u043d\u0442\u0430\u0440\u043d\u044b\u0439 \u043d\u043e\u043c\u0435\u0440",n.compensationCost="\u041f\u043b\u0430\u0442\u0430 \u0437\u0430 \u043f\u043e\u0440\u0447\u0443 \u043e\u0431\u043e\u0440\u0443\u0434\u043e\u0432\u0430\u043d\u0438\u044f, \u0440\u0443\u0431",n.supplier="\u041f\u043e\u0441\u0442\u0430\u0432\u0449\u0438\u043a",n.termsOfUse="\u0421\u0441\u044b\u043b\u043a\u0430 \u043d\u0430 \u043f\u0440\u0430\u0432\u0438\u043b\u0430 \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u043d\u0438\u044f",n.petKinds="\u0416\u0438\u0432\u043e\u0442\u043d\u043e\u0435",n.petSize="\u0420a\u0437\u043c\u0435\u0440 \u0436\u0438\u0432\u043e\u0442\u043d\u043e\u0433\u043e",n.maximumDays="\u041c\u0430\u043a\u0441\u0438\u043c\u0430\u043b\u044c\u043d\u044b\u0439 \u0441\u0440\u043e\u043a \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u043d\u0438\u044f",n.receiptDate="\u0414\u0430\u0442\u0430 \u043f\u043e\u0441\u0442\u0443\u043f\u043b\u0435\u043d\u0438\u044f \u0432 \u0444\u043e\u043d\u0434",n.photoID="\u0437\u0430\u0433\u0440\u0443\u0437\u0438\u0442\u044c \u0444\u043e\u0442\u043e",n.cancel="\u041e\u0442\u043c\u0435\u043d\u0430",n}(wt||{}),Pt=s(2032),dt=s(8525),g=s(3680);const pe=["photoInput"];function me(n,u){if(1&n&&(t.TgZ(0,"mat-option",40),t._uU(1),t.qZA()),2&n){const e=u.$implicit;t.Q6J("value",e.id),t.xp6(1),t.Oqu(e.name)}}function de(n,u){if(1&n&&(t.TgZ(0,"mat-option",40),t._uU(1),t.qZA()),2&n){const e=u.$implicit;t.Q6J("value",e),t.xp6(1),t.Oqu(e)}}function he(n,u){if(1&n&&(t.TgZ(0,"mat-option",40),t._uU(1),t.qZA()),2&n){const e=u.$implicit;t.Q6J("value",e.id),t.xp6(1),t.hij(" ",e.name," ")}}function fe(n,u){if(1&n&&(t.TgZ(0,"mat-option",40),t._uU(1),t.qZA()),2&n){const e=u.$implicit;t.Q6J("value",e.id),t.xp6(1),t.Oqu(e.name)}}function ge(n,u){if(1&n){const e=t.EpF();t.TgZ(0,"form",7)(1,"div",8)(2,"div",9)(3,"mat-form-field",10)(4,"mat-label"),t._uU(5),t.qZA(),t._UZ(6,"input",11),t.qZA(),t.TgZ(7,"mat-form-field",10)(8,"mat-label"),t._uU(9),t.qZA(),t._UZ(10,"input",12),t.qZA()(),t.TgZ(11,"mat-form-field",13)(12,"mat-label"),t._uU(13),t.qZA(),t._UZ(14,"textarea",14),t.qZA()(),t.TgZ(15,"div",8)(16,"div",9)(17,"mat-form-field",15)(18,"mat-label"),t._uU(19),t.qZA(),t.TgZ(20,"mat-select",16),t.YNc(21,me,2,2,"mat-option",17),t.qZA()(),t.TgZ(22,"mat-form-field",18)(23,"mat-label"),t._uU(24),t.qZA(),t.TgZ(25,"mat-select",19),t.NdJ("valueChange",function(o){t.CHM(e);const a=t.oxw();return t.KtG(a.setConditionState(o))}),t.YNc(26,de,2,2,"mat-option",17),t.qZA()()(),t.TgZ(27,"mat-form-field",20)(28,"mat-label"),t._uU(29),t.qZA(),t._UZ(30,"textarea",21),t.qZA()(),t.TgZ(31,"div",8)(32,"mat-form-field",10)(33,"mat-label"),t._uU(34),t.qZA(),t._UZ(35,"input",22),t.qZA(),t.TgZ(36,"mat-form-field",10)(37,"mat-label"),t._uU(38),t.qZA(),t._UZ(39,"input",23),t.qZA()(),t.TgZ(40,"div",8)(41,"mat-form-field",10)(42,"mat-label"),t._uU(43),t.qZA(),t._UZ(44,"input",24),t.qZA(),t.TgZ(45,"mat-form-field",10)(46,"mat-label"),t._uU(47),t.qZA(),t._UZ(48,"input",25),t.qZA()(),t.TgZ(49,"div",8)(50,"mat-form-field",10)(51,"mat-label"),t._uU(52),t.qZA(),t.TgZ(53,"mat-select",26),t.YNc(54,he,2,2,"mat-option",17),t.qZA()(),t.TgZ(55,"mat-form-field",18)(56,"mat-label"),t._uU(57),t.qZA(),t.TgZ(58,"mat-select",27),t.YNc(59,fe,2,2,"mat-option",17),t.qZA()()(),t.TgZ(60,"div",8)(61,"mat-form-field",15)(62,"mat-label"),t._uU(63),t.qZA(),t._UZ(64,"input",28),t.qZA(),t.TgZ(65,"mat-form-field",29)(66,"mat-label"),t._uU(67),t.qZA(),t._UZ(68,"input",30)(69,"mat-datepicker-toggle",31)(70,"mat-datepicker",null,32),t.qZA()(),t.TgZ(72,"div",8)(73,"div",33)(74,"button",34),t.NdJ("click",function(){t.CHM(e);const o=t.oxw();return t.KtG(o.choosePhoto())}),t.TgZ(75,"mat-icon",35),t._uU(76,"photo_camera"),t.qZA(),t._uU(77),t.qZA(),t.TgZ(78,"mat-form-field")(79,"input",36),t.NdJ("keydown",function(o){t.CHM(e);const a=t.oxw();return t.KtG(a.preventDefault(o))}),t.qZA()(),t.TgZ(80,"div",37)(81,"input",38,39),t.NdJ("change",function(o){t.CHM(e);const a=t.oxw();return t.KtG(a.addPhoto(o))}),t.qZA()()()()()}if(2&n){const e=t.MAs(71),i=t.oxw();t.Q6J("formGroup",i.form),t.xp6(5),t.Oqu(i.labels.name),t.xp6(1),t.Q6J("lcValidationErrors",i.formName),t.xp6(3),t.Oqu(i.labels.title),t.xp6(1),t.Q6J("lcValidationErrors",i.formName),t.xp6(3),t.Oqu(i.labels.description),t.xp6(1),t.Q6J("lcValidationErrors",i.formName),t.xp6(5),t.Oqu(i.labels.category),t.xp6(1),t.Q6J("lcValidationErrors",i.formName),t.xp6(1),t.Q6J("ngForOf",i.equipmentCategories),t.xp6(3),t.Oqu(i.labels.technicalIssues),t.xp6(1),t.Q6J("lcValidationErrors",i.formName),t.xp6(1),t.Q6J("ngForOf",i.technicalIssuesOptions),t.xp6(3),t.Oqu(i.labels.condition),t.xp6(1),t.Q6J("maxlength",1e3),t.xp6(4),t.Oqu(i.labels.inventoryNumber),t.xp6(1),t.Q6J("max",i.maxInventoryNumber)("lcValidationErrors",i.formName),t.xp6(3),t.Oqu(i.labels.compensationCost),t.xp6(1),t.Q6J("lcValidationErrors",i.formName),t.xp6(4),t.Oqu(i.labels.supplier),t.xp6(1),t.Q6J("lcValidationErrors",i.formName),t.xp6(3),t.Oqu(i.labels.termsOfUse),t.xp6(1),t.Q6J("lcValidationErrors",i.formName),t.xp6(4),t.Oqu(i.labels.petKinds),t.xp6(1),t.Q6J("lcValidationErrors",i.formName),t.xp6(1),t.Q6J("ngForOf",i.petKinds),t.xp6(3),t.Oqu(i.labels.petSize),t.xp6(1),t.Q6J("lcValidationErrors",i.formName),t.xp6(1),t.Q6J("ngForOf",i.petSizes),t.xp6(4),t.Oqu(i.labels.maximumDays),t.xp6(1),t.Q6J("lcValidationErrors",i.formName),t.xp6(3),t.Oqu(i.labels.receiptDate),t.xp6(1),t.Q6J("matDatepicker",e)("lcValidationErrors",i.formName),t.xp6(1),t.Q6J("for",e),t.xp6(8),t.hij(" ",i.labels.photoID," "),t.xp6(2),t.Q6J("lcValidationErrors",i.formName)}}let _e=(()=>{class n{constructor(e,i,o,a){this.data=e,this.formBuilder=i,this.dialogRef=o,this.validationService=a,this.maxInventoryNumber=Bt,this.labels=wt,this.formName="equipment_form",this.inventoryNumberErrorOptions={message:"\u0418\u043d\u0432\u0435\u043d\u0442\u0430\u0440\u043d\u044b\u0439 \u043d\u043e\u043c\u0435\u0440 \u0443\u0436\u0435 \u0441\u0443\u0449\u0435\u0441\u0442\u0432\u0443\u0435\u0442"},this.technicalIssuesOptions=[q.is,q.not],this.equipmentCategories=[],this.petKinds=[],this.petSizes=[],this.modalHeader="",this.actionButtonText="",this.inventoryNumbersValidator=r=>!((!this.equipment||this.equipment.inventoryNumber!==r)&&this.inventoryNumbers&&this.inventoryNumbers.includes(r))}ngOnInit(){this.data.equipment&&(this.equipment={...this.data.equipment}),this.inventoryNumbers=this.data.inventoryNumbers,this.petSizes=this.data.petSizes||[],this.petKinds=this.data.petKinds||[],this.equipmentCategories=this.data.categories||[],this.modalHeader=this.equipment?y.EditEquipmentHeader:y.AddEquipmentHeader,this.actionButtonText=this.equipment?y.EditEquipmentModalButtonText:y.AddEquipmentModalButtonText,this.createForm(this.equipment),this.conditionControl=this.form?.get("condition"),this.photoIdControl=this.form?.get("photoID")}createForm(e){this.form=this.formBuilder.group({category:[e?.category||null,l.kI.required],compensationCost:[this.equipment?.compensationCost||null,[l.kI.required,l.kI.max(9999999999)]],condition:[{value:e?.condition||null,disabled:!e||this.getConditionDisableState(e)},l.kI.maxLength(1e3)],description:[e?.description||"",l.kI.required],inventoryNumber:[e?.inventoryNumber||null,[l.kI.required,l.kI.max(Bt),this.validationService.getCustomValidator(this.inventoryNumberErrorOptions,this.inventoryNumbersValidator)]],location:[1,l.kI.required],maximumDays:[e?.maximumDays||null,[l.kI.required,l.kI.min(1)]],name:[e?.name||"",l.kI.required],nameSubstring:[""],petKinds:[e?.petKinds||[null],l.kI.required],petSize:[e?.petSize?e.petSize:null,l.kI.required],photoID:[e?.photoID||null,l.kI.required],receiptDate:[e?.receiptDate?new Date(e.receiptDate):"",l.kI.required],status:[1,l.kI.required],subCategory:[1],supplier:[e?.supplier||"",[l.kI.required,l.kI.maxLength(50)]],technicalIssues:[e?this.getTechnicalIssuesValue(e):null,[l.kI.required]],termsOfUse:[e?.termsOfUse||"",[l.kI.required,l.kI.maxLength(249)]],title:[e?.title||"",[l.kI.required,l.kI.maxLength(49)]]})}getTechnicalIssuesValue(e){return e.technicalIssues?q.is:q.not}getConditionDisableState(e){return!e.technicalIssues}setConditionState(e){this.setControlState(e===q.is,this.conditionControl)}setControlState(e,i){e?i?.enable():(i?.disable(),i?.setValue(null)),i?.setValidators(e?l.kI.required:null)}choosePhoto(){this.photoInput?.nativeElement.click()}preventDefault(e){e.preventDefault()}addPhoto(e){let i=e.target;this.file=i?.files?.length?i.files[0]:void 0,this.file&&this.photoIdControl?.setValue(this.file.name)}returnEquipment(){this.validationService.emitSubmit(this.formName),this.form?.valid&&this.dialogRef.close({file:this.file,equipment:new ae(this.form.value)})}static#t=this.\u0275fac=function(i){return new(i||n)(t.Y36(d.WI),t.Y36(l.qu),t.Y36(d.so),t.Y36(H.R))};static#e=this.\u0275cmp=t.Xpm({type:n,selectors:[["lc-equipment"]],viewQuery:function(i,o){if(1&i&&t.Gf(pe,5),2&i){let a;t.iGM(a=t.CRH())&&(o.photoInput=a.first)}},decls:9,vars:5,consts:[[3,"headerTitle"],["body",""],[3,"formGroup",4,"ngIf"],["footer",""],[1,"buttons"],["mat-button","",1,"cancel",3,"mat-dialog-close"],["mat-raised-button","","color","primary",3,"click"],[3,"formGroup"],[1,"row"],[1,"column"],["appearance","fill","floatLabel","auto"],["matInput","","formControlName","name",3,"lcValidationErrors"],["matInput","","formControlName","title",3,"lcValidationErrors"],["width","370px","appearance","fill"],["rows","4","matInput","","formControlName","description",3,"lcValidationErrors"],["floatLabel","auto"],["formControlName","category",3,"lcValidationErrors"],[3,"value",4,"ngFor","ngForOf"],["floatLabel","auto","appearance","fill"],["formControlName","technicalIssues",3,"lcValidationErrors","valueChange"],["appearance","fill"],["matInput","","rows","4","formControlName","condition",3,"maxlength"],["matInput","","type","number","formControlName","inventoryNumber",3,"max","lcValidationErrors"],["matInput","","type","number","formControlName","compensationCost",3,"lcValidationErrors"],["matInput","","formControlName","supplier",3,"lcValidationErrors"],["matInput","","type","url","formControlName","termsOfUse",3,"lcValidationErrors"],["formControlName","petKinds","multiple","",3,"lcValidationErrors"],["formControlName","petSize",3,"lcValidationErrors"],["matInput","","type","number","formControlName","maximumDays",3,"lcValidationErrors"],["floatLabel","auto","appearance","fill",1,"registration-form-field-input"],["matInput","","formControlName","receiptDate",3,"matDatepicker","lcValidationErrors"],["matSuffix","",3,"for"],["picker",""],[1,"photo-field"],["mat-flat-button","","type","button",1,"registration-controls-button",3,"click"],["color","primary"],["matInput","","formControlName","photoID","type","text",3,"lcValidationErrors","keydown"],[1,"hidden"],["type","file",1,"registration-form-field-input",3,"change"],["photoInput",""],[3,"value"]],template:function(i,o){1&i&&(t.TgZ(0,"lc-modal-layout",0),t.ynx(1,1),t.YNc(2,ge,83,38,"form",2),t.BQk(),t.ynx(3,3),t.TgZ(4,"div",4)(5,"button",5),t._uU(6),t.qZA(),t.TgZ(7,"button",6),t.NdJ("click",function(){return o.returnEquipment()}),t._uU(8),t.qZA()(),t.BQk(),t.qZA()),2&i&&(t.Q6J("headerTitle",o.modalHeader),t.xp6(2),t.Q6J("ngIf",o.form),t.xp6(3),t.Q6J("mat-dialog-close",!1),t.xp6(1),t.hij(" ",o.labels.cancel," "),t.xp6(2),t.hij(" ",o.actionButtonText," "))},dependencies:[m.sg,m.O5,w.m,z.D,x.lW,P.Mq,P.hl,P.nW,d.ZT,pt.Hw,Pt.Nt,D.KE,D.hX,D.R9,dt.gD,g.ey,l._Y,l.Fj,l.wV,l.JJ,l.JL,l.nD,l.Fd,l.sg,l.u],styles:["form[_ngcontent-%COMP%]{width:789px}form[_ngcontent-%COMP%]   .row[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:flex-start;margin-bottom:16px}form[_ngcontent-%COMP%]   .column[_ngcontent-%COMP%]{width:370px}form[_ngcontent-%COMP%]   .column[_ngcontent-%COMP%]   mat-form-field[_ngcontent-%COMP%]{margin-bottom:16px}form[_ngcontent-%COMP%]   .column[_ngcontent-%COMP%]   mat-form-field[_ngcontent-%COMP%]:last-child{margin-bottom:0}form[_ngcontent-%COMP%]   .condition[_ngcontent-%COMP%]{height:56px}form[_ngcontent-%COMP%]   mat-form-field[_ngcontent-%COMP%]{width:370px}textarea[_ngcontent-%COMP%]{resize:none;height:157px}.photo-field[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{height:54px;margin-right:5px}.photo-field[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{font-size:24px;width:24px;height:24px}.photo-field[_ngcontent-%COMP%]   mat-form-field[_ngcontent-%COMP%]{width:188px}.buttons[_ngcontent-%COMP%]{display:flex;justify-content:flex-end;align-items:center}.buttons[_ngcontent-%COMP%]   .cancel[_ngcontent-%COMP%]{margin-right:24px;font-style:normal;font-weight:500;color:#00677f}.buttons[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{height:56px;border-radius:10px;font-style:normal;font-weight:400;line-height:20px;padding:16px;text-transform:uppercase}.hidden[_ngcontent-%COMP%]{display:none}"],changeDetection:0})}return n})();function ve(n,u){if(1&n&&(t.ynx(0),t.TgZ(1,"p"),t._uU(2),t.TgZ(3,"strong"),t._uU(4),t.qZA(),t._uU(5,"?"),t.qZA(),t.TgZ(6,"p"),t._uU(7),t.qZA(),t.BQk()),2&n){const e=t.oxw();t.xp6(2),t.hij("",e.isUserBlocked?e.ModalEnum.UnblockConfirmationText:e.ModalEnum.BlockConfirmationText," "),t.xp6(2),t.AsE("",e.user.name,"",e.user.surname?" "+e.user.surname:"",""),t.xp6(3),t.Oqu(e.isUserBlocked?e.ModalEnum.UnblockDescriptionText:e.ModalEnum.BlockDescriptionText)}}let Ce=(()=>{class n{constructor(){this.ModalEnum=v,this.isUserBlocked=!1}ngOnInit(){this.data&&(this.user=this.data,this.isUserBlocked=this.user.is_readonly)}static#t=this.\u0275fac=function(i){return new(i||n)};static#e=this.\u0275cmp=t.Xpm({type:n,selectors:[["lc-block-user-modal-content"]],inputs:{data:"data"},decls:1,vars:1,consts:[[4,"ngIf"]],template:function(i,o){1&i&&t.YNc(0,ve,8,4,"ng-container",0),2&i&&t.Q6J("ngIf",o.user)},dependencies:[m.O5],changeDetection:0})}return n})();function ye(n,u){if(1&n&&(t.ynx(0),t.TgZ(1,"p"),t._uU(2),t.TgZ(3,"strong"),t._uU(4),t.qZA(),t._uU(5,"?"),t.qZA(),t.BQk()),2&n){const e=t.oxw();t.xp6(2),t.hij("",e.ModalEnum.DeleteConfirmationText," "),t.xp6(2),t.AsE("",e.user.name,"",e.user.surname?" "+e.user.surname:"","")}}let be=(()=>{class n{constructor(){this.ModalEnum=v}ngOnInit(){this.data&&(this.user=this.data)}static#t=this.\u0275fac=function(i){return new(i||n)};static#e=this.\u0275cmp=t.Xpm({type:n,selectors:[["lc-delete-user-modal-content"]],inputs:{data:"data"},decls:1,vars:1,consts:[[4,"ngIf"]],template:function(i,o){1&i&&t.YNc(0,ye,6,3,"ng-container",0),2&i&&t.Q6J("ngIf",o.user)},dependencies:[m.O5],encapsulation:2,changeDetection:0})}return n})();var L=function(n){return n.AssignTitle="\u041d\u0430\u0437\u043d\u0430\u0447\u0438\u0442\u044c \u0440\u043e\u043b\u044c",n.AssignButtonText="\u041d\u0430\u0437\u043d\u0430\u0447\u0438\u0442\u044c",n.DeleteTitle="\u0423\u0434\u0430\u043b\u0438\u0442\u044c \u0440\u043e\u043b\u044c",n.DeleteButtonText="\u0423\u0434\u0430\u043b\u0438\u0442\u044c",n.DeleteConfirmationText="\u0412\u044b \u0443\u0432\u0435\u0440\u0435\u043d\u044b, \u0447\u0442\u043e \u0445\u043e\u0442\u0438\u0442\u0435 \u0443\u0434\u0430\u043b\u0438\u0442\u044c \u0440\u043e\u043b\u044c",n.CancelButtonText="\u041e\u0442\u043c\u0435\u043d\u0438\u0442\u044c",n.User="\u041f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044c",n.Role="\u0420\u043e\u043b\u044c",n}(L||{});function Ee(n,u){if(1&n&&(t.ynx(0),t.TgZ(1,"p"),t._uU(2),t.TgZ(3,"strong"),t._uU(4),t.qZA(),t._uU(5," \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044f "),t.TgZ(6,"strong"),t._uU(7),t.qZA(),t._uU(8,"?"),t.qZA(),t.BQk()),2&n){const e=t.oxw();t.xp6(2),t.hij("",e.ModalEnum.DeleteConfirmationText," "),t.xp6(2),t.Oqu(e.user.role.name),t.xp6(3),t.AsE("",e.user.name,"",e.user.surname?" "+e.user.surname:"","")}}let xe=(()=>{class n{constructor(){this.ModalEnum=L}ngOnInit(){this.data&&(this.user=this.data)}static#t=this.\u0275fac=function(i){return new(i||n)};static#e=this.\u0275cmp=t.Xpm({type:n,selectors:[["lc-delete-role-modal-content"]],inputs:{data:"data"},decls:1,vars:1,consts:[[4,"ngIf"]],template:function(i,o){1&i&&t.YNc(0,Ee,9,4,"ng-container",0),2&i&&t.Q6J("ngIf",o.user)},dependencies:[m.O5],changeDetection:0})}return n})();var kt=s(7921),qt=s(799),W=s(3651),N=s(4300),U=s(2495),It=s(2831),C=s(6825),Zt=s(7394),De=s(8645),Ae=s(4911),K=s(3019),ht=s(2438),A=s(6028),Oe=s(8484),R=s(8180),Te=s(6321),Me=s(5211),Be=s(9360),Se=s(8251),we=s(2420),ke=s(975),qe=s(1631);function Ft(n,u){return u?e=>(0,Me.z)(u.pipe((0,R.q)(1),function Pe(){return(0,Be.e)((n,u)=>{n.subscribe((0,Se.x)(u,we.Z))})}()),e.pipe(Ft(n))):(0,qe.z)((e,i)=>n(e,i).pipe((0,R.q)(1),(0,ke.h)(e)))}var Ie=s(4825),Fe=s(9388);const Ne=["panel"];function Ue(n,u){if(1&n){const e=t.EpF();t.TgZ(0,"div",0,1),t.NdJ("@panelAnimation.done",function(o){t.CHM(e);const a=t.oxw();return t.KtG(a._animationDone.next(o))}),t.Hsn(2),t.qZA()}if(2&n){const e=u.id,i=t.oxw();t.Q6J("id",i.id)("ngClass",i._classList)("@panelAnimation",i.isOpen?"visible":"hidden"),t.uIk("aria-label",i.ariaLabel||null)("aria-labelledby",i._getPanelAriaLabelledby(e))}}const Re=["*"],Qe=(0,C.X$)("panelAnimation",[(0,C.SB)("void, hidden",(0,C.oB)({opacity:0,transform:"scaleY(0.8)"})),(0,C.eR)(":enter, hidden => visible",[(0,C.ru)([(0,C.jt)("0.03s linear",(0,C.oB)({opacity:1})),(0,C.jt)("0.12s cubic-bezier(0, 0, 0.2, 1)",(0,C.oB)({transform:"scaleY(1)"}))])]),(0,C.eR)(":leave, visible => hidden",[(0,C.jt)("0.075s linear",(0,C.oB)({opacity:0}))])]);let Je=0;class Le{constructor(u,e){this.source=u,this.option=e}}const Ye=(0,g.Kr)(class{}),Nt=new t.OlP("mat-autocomplete-default-options",{providedIn:"root",factory:function Ve(){return{autoActiveFirstOption:!1,autoSelectActiveOption:!1,hideSingleSelectionIndicator:!1,requireSelection:!1}}});let $e=(()=>{class n extends Ye{get isOpen(){return this._isOpen&&this.showPanel}_setColor(e){this._color=e,this._setThemeClasses(this._classList)}get autoActiveFirstOption(){return this._autoActiveFirstOption}set autoActiveFirstOption(e){this._autoActiveFirstOption=(0,U.Ig)(e)}get autoSelectActiveOption(){return this._autoSelectActiveOption}set autoSelectActiveOption(e){this._autoSelectActiveOption=(0,U.Ig)(e)}get requireSelection(){return this._requireSelection}set requireSelection(e){this._requireSelection=(0,U.Ig)(e)}set classList(e){this._classList=e&&e.length?(0,U.du)(e).reduce((i,o)=>(i[o]=!0,i),{}):{},this._setVisibilityClasses(this._classList),this._setThemeClasses(this._classList),this._elementRef.nativeElement.className=""}constructor(e,i,o,a){super(),this._changeDetectorRef=e,this._elementRef=i,this._defaults=o,this._activeOptionChanges=Zt.w0.EMPTY,this.showPanel=!1,this._isOpen=!1,this.displayWith=null,this.optionSelected=new t.vpe,this.opened=new t.vpe,this.closed=new t.vpe,this.optionActivated=new t.vpe,this._classList={},this.id="mat-autocomplete-"+Je++,this.inertGroups=a?.SAFARI||!1,this._autoActiveFirstOption=!!o.autoActiveFirstOption,this._autoSelectActiveOption=!!o.autoSelectActiveOption,this._requireSelection=!!o.requireSelection}ngAfterContentInit(){this._keyManager=new N.s1(this.options).withWrap().skipPredicate(this._skipPredicate),this._activeOptionChanges=this._keyManager.change.subscribe(e=>{this.isOpen&&this.optionActivated.emit({source:this,option:this.options.toArray()[e]||null})}),this._setVisibility()}ngOnDestroy(){this._keyManager?.destroy(),this._activeOptionChanges.unsubscribe()}_setScrollTop(e){this.panel&&(this.panel.nativeElement.scrollTop=e)}_getScrollTop(){return this.panel?this.panel.nativeElement.scrollTop:0}_setVisibility(){this.showPanel=!!this.options.length,this._setVisibilityClasses(this._classList),this._changeDetectorRef.markForCheck()}_emitSelectEvent(e){const i=new Le(this,e);this.optionSelected.emit(i)}_getPanelAriaLabelledby(e){return this.ariaLabel?null:this.ariaLabelledby?(e?e+" ":"")+this.ariaLabelledby:e}_setVisibilityClasses(e){e[this._visibleClass]=this.showPanel,e[this._hiddenClass]=!this.showPanel}_setThemeClasses(e){e["mat-primary"]="primary"===this._color,e["mat-warn"]="warn"===this._color,e["mat-accent"]="accent"===this._color}_skipPredicate(e){return e.disabled}static#t=this.\u0275fac=function(i){return new(i||n)(t.Y36(t.sBO),t.Y36(t.SBq),t.Y36(Nt),t.Y36(It.t4))};static#e=this.\u0275dir=t.lG2({type:n,viewQuery:function(i,o){if(1&i&&(t.Gf(t.Rgc,7),t.Gf(Ne,5)),2&i){let a;t.iGM(a=t.CRH())&&(o.template=a.first),t.iGM(a=t.CRH())&&(o.panel=a.first)}},inputs:{ariaLabel:["aria-label","ariaLabel"],ariaLabelledby:["aria-labelledby","ariaLabelledby"],displayWith:"displayWith",autoActiveFirstOption:"autoActiveFirstOption",autoSelectActiveOption:"autoSelectActiveOption",requireSelection:"requireSelection",panelWidth:"panelWidth",classList:["class","classList"]},outputs:{optionSelected:"optionSelected",opened:"opened",closed:"closed",optionActivated:"optionActivated"},features:[t.qOj]})}return n})(),Ge=(()=>{class n extends $e{constructor(){super(...arguments),this._visibleClass="mat-mdc-autocomplete-visible",this._hiddenClass="mat-mdc-autocomplete-hidden",this._animationDone=new t.vpe,this._hideSingleSelectionIndicator=this._defaults.hideSingleSelectionIndicator??!1}get hideSingleSelectionIndicator(){return this._hideSingleSelectionIndicator}set hideSingleSelectionIndicator(e){this._hideSingleSelectionIndicator=(0,U.Ig)(e),this._syncParentProperties()}_syncParentProperties(){if(this.options)for(const e of this.options)e._changeDetectorRef.markForCheck()}ngOnDestroy(){super.ngOnDestroy(),this._animationDone.complete()}_skipPredicate(e){return!1}static#t=this.\u0275fac=function(){let e;return function(o){return(e||(e=t.n5z(n)))(o||n)}}();static#e=this.\u0275cmp=t.Xpm({type:n,selectors:[["mat-autocomplete"]],contentQueries:function(i,o,a){if(1&i&&(t.Suo(a,g.K7,5),t.Suo(a,g.ey,5)),2&i){let r;t.iGM(r=t.CRH())&&(o.optionGroups=r),t.iGM(r=t.CRH())&&(o.options=r)}},hostAttrs:["ngSkipHydration","",1,"mat-mdc-autocomplete"],inputs:{disableRipple:"disableRipple",hideSingleSelectionIndicator:"hideSingleSelectionIndicator"},exportAs:["matAutocomplete"],features:[t._Bn([{provide:g.HF,useExisting:n}]),t.qOj],ngContentSelectors:Re,decls:1,vars:0,consts:[["role","listbox",1,"mat-mdc-autocomplete-panel","mdc-menu-surface","mdc-menu-surface--open",3,"id","ngClass"],["panel",""]],template:function(i,o){1&i&&(t.F$t(),t.YNc(0,Ue,3,5,"ng-template"))},dependencies:[m.mk],styles:["div.mat-mdc-autocomplete-panel{box-shadow:0px 5px 5px -3px rgba(0, 0, 0, 0.2), 0px 8px 10px 1px rgba(0, 0, 0, 0.14), 0px 3px 14px 2px rgba(0, 0, 0, 0.12);width:100%;max-height:256px;visibility:hidden;transform-origin:center top;overflow:auto;padding:8px 0;border-radius:4px;box-sizing:border-box;position:static;background-color:var(--mat-autocomplete-background-color)}.cdk-high-contrast-active div.mat-mdc-autocomplete-panel{outline:solid 1px}.cdk-overlay-pane:not(.mat-mdc-autocomplete-panel-above) div.mat-mdc-autocomplete-panel{border-top-left-radius:0;border-top-right-radius:0}.mat-mdc-autocomplete-panel-above div.mat-mdc-autocomplete-panel{border-bottom-left-radius:0;border-bottom-right-radius:0;transform-origin:center bottom}div.mat-mdc-autocomplete-panel.mat-mdc-autocomplete-visible{visibility:visible}div.mat-mdc-autocomplete-panel.mat-mdc-autocomplete-hidden{visibility:hidden}mat-autocomplete{display:none}"],encapsulation:2,data:{animation:[Qe]},changeDetection:0})}return n})();const He={provide:l.JU,useExisting:(0,t.Gpc)(()=>Rt),multi:!0},Ut=new t.OlP("mat-autocomplete-scroll-strategy"),je={provide:Ut,deps:[W.aV],useFactory:function ze(n){return()=>n.scrollStrategies.reposition()}};let We=(()=>{class n{get autocompleteDisabled(){return this._autocompleteDisabled}set autocompleteDisabled(e){this._autocompleteDisabled=(0,U.Ig)(e)}constructor(e,i,o,a,r,bt,Yn,Vn,$n,Gn,Hn){this._element=e,this._overlay=i,this._viewContainerRef=o,this._zone=a,this._changeDetectorRef=r,this._dir=Yn,this._formField=Vn,this._document=$n,this._viewportRuler=Gn,this._defaults=Hn,this._componentDestroyed=!1,this._autocompleteDisabled=!1,this._manuallyFloatingLabel=!1,this._viewportSubscription=Zt.w0.EMPTY,this._canOpenOnNextFocus=!0,this._closeKeyEventStream=new De.x,this._windowBlurHandler=()=>{this._canOpenOnNextFocus=this._document.activeElement!==this._element.nativeElement||this.panelOpen},this._onChange=()=>{},this._onTouched=()=>{},this.position="auto",this.autocompleteAttribute="off",this._overlayAttached=!1,this.optionSelections=(0,Ae.P)(()=>{const E=this.autocomplete?this.autocomplete.options:null;return E?E.changes.pipe((0,kt.O)(E),(0,c.w)(()=>(0,K.T)(...E.map(zn=>zn.onSelectionChange)))):this._zone.onStable.pipe((0,R.q)(1),(0,c.w)(()=>this.optionSelections))}),this._handlePanelKeydown=E=>{(E.keyCode===A.hY&&!(0,A.Vb)(E)||E.keyCode===A.LH&&(0,A.Vb)(E,"altKey"))&&(this._pendingAutoselectedOption&&(this._updateNativeInputValue(this._valueBeforeAutoSelection??""),this._pendingAutoselectedOption=null),this._closeKeyEventStream.next(),this._resetActiveItem(),E.stopPropagation(),E.preventDefault())},this._trackedModal=null,this._scrollStrategy=bt}ngAfterViewInit(){const e=this._getWindow();typeof e<"u"&&this._zone.runOutsideAngular(()=>e.addEventListener("blur",this._windowBlurHandler))}ngOnChanges(e){e.position&&this._positionStrategy&&(this._setStrategyPositions(this._positionStrategy),this.panelOpen&&this._overlayRef.updatePosition())}ngOnDestroy(){const e=this._getWindow();typeof e<"u"&&e.removeEventListener("blur",this._windowBlurHandler),this._viewportSubscription.unsubscribe(),this._componentDestroyed=!0,this._destroyPanel(),this._closeKeyEventStream.complete(),this._clearFromModal()}get panelOpen(){return this._overlayAttached&&this.autocomplete.showPanel}openPanel(){this._attachOverlay(),this._floatLabel(),this._trackedModal&&(0,N.Zf)(this._trackedModal,"aria-owns",this.autocomplete.id)}closePanel(){this._resetLabel(),this._overlayAttached&&(this.panelOpen&&this._zone.run(()=>{this.autocomplete.closed.emit()}),this.autocomplete._isOpen=this._overlayAttached=!1,this._pendingAutoselectedOption=null,this._overlayRef&&this._overlayRef.hasAttached()&&(this._overlayRef.detach(),this._closingActionsSubscription.unsubscribe()),this._updatePanelState(),this._componentDestroyed||this._changeDetectorRef.detectChanges(),this._trackedModal)&&(0,N.iD)(this._trackedModal,"aria-owns",this.autocomplete.id)}updatePosition(){this._overlayAttached&&this._overlayRef.updatePosition()}get panelClosingActions(){return(0,K.T)(this.optionSelections,this.autocomplete._keyManager.tabOut.pipe((0,f.h)(()=>this._overlayAttached)),this._closeKeyEventStream,this._getOutsideClickStream(),this._overlayRef?this._overlayRef.detachments().pipe((0,f.h)(()=>this._overlayAttached)):(0,F.of)()).pipe((0,_.U)(e=>e instanceof g.rN?e:null))}get activeOption(){return this.autocomplete&&this.autocomplete._keyManager?this.autocomplete._keyManager.activeItem:null}_getOutsideClickStream(){return(0,K.T)((0,ht.R)(this._document,"click"),(0,ht.R)(this._document,"auxclick"),(0,ht.R)(this._document,"touchend")).pipe((0,f.h)(e=>{const i=(0,It.sA)(e),o=this._formField?this._formField._elementRef.nativeElement:null,a=this.connectedTo?this.connectedTo.elementRef.nativeElement:null;return this._overlayAttached&&i!==this._element.nativeElement&&this._document.activeElement!==this._element.nativeElement&&(!o||!o.contains(i))&&(!a||!a.contains(i))&&!!this._overlayRef&&!this._overlayRef.overlayElement.contains(i)}))}writeValue(e){Promise.resolve(null).then(()=>this._assignOptionValue(e))}registerOnChange(e){this._onChange=e}registerOnTouched(e){this._onTouched=e}setDisabledState(e){this._element.nativeElement.disabled=e}_handleKeydown(e){const i=e.keyCode,o=(0,A.Vb)(e);if(i===A.hY&&!o&&e.preventDefault(),this.activeOption&&i===A.K5&&this.panelOpen&&!o)this.activeOption._selectViaInteraction(),this._resetActiveItem(),e.preventDefault();else if(this.autocomplete){const a=this.autocomplete._keyManager.activeItem,r=i===A.LH||i===A.JH;i===A.Mf||r&&!o&&this.panelOpen?this.autocomplete._keyManager.onKeydown(e):r&&this._canOpen()&&this.openPanel(),(r||this.autocomplete._keyManager.activeItem!==a)&&(this._scrollToOption(this.autocomplete._keyManager.activeItemIndex||0),this.autocomplete.autoSelectActiveOption&&this.activeOption&&(this._pendingAutoselectedOption||(this._valueBeforeAutoSelection=this._element.nativeElement.value),this._pendingAutoselectedOption=this.activeOption,this._assignOptionValue(this.activeOption.value)))}}_handleInput(e){let i=e.target,o=i.value;"number"===i.type&&(o=""==o?null:parseFloat(o)),this._previousValue!==o&&(this._previousValue=o,this._pendingAutoselectedOption=null,(!this.autocomplete||!this.autocomplete.requireSelection)&&this._onChange(o),o||this._clearPreviousSelectedOption(null,!1),this._canOpen()&&this._document.activeElement===e.target&&this.openPanel())}_handleFocus(){this._canOpenOnNextFocus?this._canOpen()&&(this._previousValue=this._element.nativeElement.value,this._attachOverlay(),this._floatLabel(!0)):this._canOpenOnNextFocus=!0}_handleClick(){this._canOpen()&&!this.panelOpen&&this.openPanel()}_floatLabel(e=!1){this._formField&&"auto"===this._formField.floatLabel&&(e?this._formField._animateAndLockLabel():this._formField.floatLabel="always",this._manuallyFloatingLabel=!0)}_resetLabel(){this._manuallyFloatingLabel&&(this._formField&&(this._formField.floatLabel="auto"),this._manuallyFloatingLabel=!1)}_subscribeToClosingActions(){const e=this._zone.onStable.pipe((0,R.q)(1)),i=this.autocomplete.options.changes.pipe((0,Z.b)(()=>this._positionStrategy.reapplyLastPosition()),function Ze(n,u=Te.z){const e=(0,Ie.H)(n,u);return Ft(()=>e)}(0));return(0,K.T)(e,i).pipe((0,c.w)(()=>(this._zone.run(()=>{const o=this.panelOpen;this._resetActiveItem(),this._updatePanelState(),this._changeDetectorRef.detectChanges(),this.panelOpen&&this._overlayRef.updatePosition(),o!==this.panelOpen&&(this.panelOpen?(this._captureValueOnAttach(),this._emitOpened()):this.autocomplete.closed.emit())}),this.panelClosingActions)),(0,R.q)(1)).subscribe(o=>this._setValueAndClose(o))}_emitOpened(){this.autocomplete.opened.emit()}_captureValueOnAttach(){this._valueOnAttach=this._element.nativeElement.value}_destroyPanel(){this._overlayRef&&(this.closePanel(),this._overlayRef.dispose(),this._overlayRef=null)}_assignOptionValue(e){const i=this.autocomplete&&this.autocomplete.displayWith?this.autocomplete.displayWith(e):e;this._updateNativeInputValue(i??"")}_updateNativeInputValue(e){this._formField?this._formField._control.value=e:this._element.nativeElement.value=e,this._previousValue=e}_setValueAndClose(e){const i=this.autocomplete,o=e?e.source:this._pendingAutoselectedOption;o?(this._clearPreviousSelectedOption(o),this._assignOptionValue(o.value),this._onChange(o.value),i._emitSelectEvent(o),this._element.nativeElement.focus()):i.requireSelection&&this._element.nativeElement.value!==this._valueOnAttach&&(this._clearPreviousSelectedOption(null),this._assignOptionValue(null),i._animationDone?i._animationDone.pipe((0,R.q)(1)).subscribe(()=>this._onChange(null)):this._onChange(null)),this.closePanel()}_clearPreviousSelectedOption(e,i){this.autocomplete?.options?.forEach(o=>{o!==e&&o.selected&&o.deselect(i)})}_attachOverlay(){let e=this._overlayRef;e?(this._positionStrategy.setOrigin(this._getConnectedElement()),e.updateSize({width:this._getPanelWidth()})):(this._portal=new Oe.UE(this.autocomplete.template,this._viewContainerRef,{id:this._formField?.getLabelId()}),e=this._overlay.create(this._getOverlayConfig()),this._overlayRef=e,this._viewportSubscription=this._viewportRuler.change().subscribe(()=>{this.panelOpen&&e&&e.updateSize({width:this._getPanelWidth()})})),e&&!e.hasAttached()&&(e.attach(this._portal),this._closingActionsSubscription=this._subscribeToClosingActions());const i=this.panelOpen;this.autocomplete._isOpen=this._overlayAttached=!0,this.autocomplete._setColor(this._formField?.color),this._updatePanelState(),this._applyModalPanelOwnership(),this._captureValueOnAttach(),this.panelOpen&&i!==this.panelOpen&&this._emitOpened()}_updatePanelState(){if(this.autocomplete._setVisibility(),this.panelOpen){const e=this._overlayRef;this._keydownSubscription||(this._keydownSubscription=e.keydownEvents().subscribe(this._handlePanelKeydown)),this._outsideClickSubscription||(this._outsideClickSubscription=e.outsidePointerEvents().subscribe())}else this._keydownSubscription?.unsubscribe(),this._outsideClickSubscription?.unsubscribe(),this._keydownSubscription=this._outsideClickSubscription=null}_getOverlayConfig(){return new W.X_({positionStrategy:this._getOverlayPosition(),scrollStrategy:this._scrollStrategy(),width:this._getPanelWidth(),direction:this._dir??void 0,panelClass:this._defaults?.overlayPanelClass})}_getOverlayPosition(){const e=this._overlay.position().flexibleConnectedTo(this._getConnectedElement()).withFlexibleDimensions(!1).withPush(!1);return this._setStrategyPositions(e),this._positionStrategy=e,e}_setStrategyPositions(e){const i=[{originX:"start",originY:"bottom",overlayX:"start",overlayY:"top"},{originX:"end",originY:"bottom",overlayX:"end",overlayY:"top"}],o=this._aboveClass,a=[{originX:"start",originY:"top",overlayX:"start",overlayY:"bottom",panelClass:o},{originX:"end",originY:"top",overlayX:"end",overlayY:"bottom",panelClass:o}];let r;r="above"===this.position?a:"below"===this.position?i:[...i,...a],e.withPositions(r)}_getConnectedElement(){return this.connectedTo?this.connectedTo.elementRef:this._formField?this._formField.getConnectedOverlayOrigin():this._element}_getPanelWidth(){return this.autocomplete.panelWidth||this._getHostWidth()}_getHostWidth(){return this._getConnectedElement().nativeElement.getBoundingClientRect().width}_resetActiveItem(){const e=this.autocomplete;if(e.autoActiveFirstOption){let i=-1;for(let o=0;o<e.options.length;o++)if(!e.options.get(o).disabled){i=o;break}e._keyManager.setActiveItem(i)}else e._keyManager.setActiveItem(-1)}_canOpen(){const e=this._element.nativeElement;return!e.readOnly&&!e.disabled&&!this._autocompleteDisabled}_getWindow(){return this._document?.defaultView||window}_scrollToOption(e){const i=this.autocomplete,o=(0,g.CB)(e,i.options,i.optionGroups);if(0===e&&1===o)i._setScrollTop(0);else if(i.panel){const a=i.options.toArray()[e];if(a){const r=a._getHostElement(),bt=(0,g.jH)(r.offsetTop,r.offsetHeight,i._getScrollTop(),i.panel.nativeElement.offsetHeight);i._setScrollTop(bt)}}}_applyModalPanelOwnership(){const e=this._element.nativeElement.closest('body > .cdk-overlay-container [aria-modal="true"]');if(!e)return;const i=this.autocomplete.id;this._trackedModal&&(0,N.iD)(this._trackedModal,"aria-owns",i),(0,N.Zf)(e,"aria-owns",i),this._trackedModal=e}_clearFromModal(){this._trackedModal&&((0,N.iD)(this._trackedModal,"aria-owns",this.autocomplete.id),this._trackedModal=null)}static#t=this.\u0275fac=function(i){return new(i||n)(t.Y36(t.SBq),t.Y36(W.aV),t.Y36(t.s_b),t.Y36(t.R0b),t.Y36(t.sBO),t.Y36(Ut),t.Y36(Fe.Is,8),t.Y36(D.G_,9),t.Y36(m.K0,8),t.Y36(qt.rL),t.Y36(Nt,8))};static#e=this.\u0275dir=t.lG2({type:n,inputs:{autocomplete:["matAutocomplete","autocomplete"],position:["matAutocompletePosition","position"],connectedTo:["matAutocompleteConnectedTo","connectedTo"],autocompleteAttribute:["autocomplete","autocompleteAttribute"],autocompleteDisabled:["matAutocompleteDisabled","autocompleteDisabled"]},features:[t.TTD]})}return n})(),Rt=(()=>{class n extends We{constructor(){super(...arguments),this._aboveClass="mat-mdc-autocomplete-panel-above"}static#t=this.\u0275fac=function(){let e;return function(o){return(e||(e=t.n5z(n)))(o||n)}}();static#e=this.\u0275dir=t.lG2({type:n,selectors:[["input","matAutocomplete",""],["textarea","matAutocomplete",""]],hostAttrs:[1,"mat-mdc-autocomplete-trigger"],hostVars:7,hostBindings:function(i,o){1&i&&t.NdJ("focusin",function(){return o._handleFocus()})("blur",function(){return o._onTouched()})("input",function(r){return o._handleInput(r)})("keydown",function(r){return o._handleKeydown(r)})("click",function(){return o._handleClick()}),2&i&&t.uIk("autocomplete",o.autocompleteAttribute)("role",o.autocompleteDisabled?null:"combobox")("aria-autocomplete",o.autocompleteDisabled?null:"list")("aria-activedescendant",o.panelOpen&&o.activeOption?o.activeOption.id:null)("aria-expanded",o.autocompleteDisabled?null:o.panelOpen.toString())("aria-controls",o.autocompleteDisabled||!o.panelOpen||null==o.autocomplete?null:o.autocomplete.id)("aria-haspopup",o.autocompleteDisabled?null:"listbox")},exportAs:["matAutocompleteTrigger"],features:[t._Bn([He]),t.qOj]})}return n})(),Ke=(()=>{class n{static#t=this.\u0275fac=function(i){return new(i||n)};static#e=this.\u0275mod=t.oAB({type:n});static#n=this.\u0275inj=t.cJS({providers:[je],imports:[W.U8,g.Ng,g.BQ,m.ez,qt.ZD,g.Ng,g.BQ]})}return n})();function Xe(n,u){if(1&n&&(t.TgZ(0,"mat-option",13)(1,"div",14)(2,"p",15),t._uU(3),t.qZA(),t.TgZ(4,"p",16),t._uU(5),t.qZA()()()),2&n){const e=u.$implicit;t.Q6J("value",e),t.xp6(3),t.AsE("",e.name," ",e.surname,""),t.xp6(2),t.Oqu(e.email)}}function tn(n,u){if(1&n&&(t.TgZ(0,"mat-option",13),t._uU(1),t.qZA()),2&n){const e=u.$implicit;t.Q6J("value",e.id),t.xp6(1),t.Oqu(e.name)}}let ft=class xt{constructor(u,e,i,o){this.data=u,this.formBuilder=e,this.validationService=i,this.dialogRef=o,this.formName="role_assignment_form",this.labels=L,this.roles=[],this.form=this.formBuilder.group({user:[null,l.kI.required],role:[null,l.kI.required]})}ngOnInit(){this.roles=this.data.roles,this.filteredUserOptions$=this.form.get("user")?.valueChanges.pipe((0,kt.O)(""),(0,_.U)(u=>{const e="string"==typeof u?u:u&&u?.name;return e?this.filterUsersByName(e):this.data.users.slice()}),(0,h.t)(this))}getUserName(u){return u&&u.name?`${u.name} ${u.surname}`:""}filterUsersByName(u){const e=u.toLowerCase();return this.data.users.filter(i=>i.name.toLowerCase().includes(e)||i.surname.toLowerCase().includes(e)||i.email.toLowerCase().includes(e))}assignRole(){const{role:u,user:e}=this.form.value;this.validationService.emitSubmit(this.formName),this.form?.valid&&this.dialogRef.close({roleId:u&&u,userId:e&&e.id})}static#t=this.\u0275fac=function(e){return new(e||xt)(t.Y36(d.WI),t.Y36(l.qu),t.Y36(H.R),t.Y36(d.so))};static#e=this.\u0275cmp=t.Xpm({type:xt,selectors:[["lc-assign-role-modal"]],decls:18,vars:15,consts:[[3,"headerTitle"],["body",""],[1,"form",3,"formGroup"],["appearance","fill",1,"field"],["type","text","matInput","","formControlName","user",3,"placeholder","matAutocomplete","lcValidationErrors"],[3,"displayWith"],["auto","matAutocomplete"],[3,"value",4,"ngFor","ngForOf"],["formControlName","role",3,"placeholder","lcValidationErrors"],["footer",""],[1,"buttons"],["mat-button","",1,"cancel",3,"mat-dialog-close"],["mat-raised-button","","color","primary",3,"click"],[3,"value"],[1,"option"],[1,"option-title"],[1,"option-subtitle"]],template:function(e,i){if(1&e&&(t.TgZ(0,"lc-modal-layout",0),t.ynx(1,1),t.TgZ(2,"form",2)(3,"mat-form-field",3),t._UZ(4,"input",4),t.TgZ(5,"mat-autocomplete",5,6),t.YNc(7,Xe,6,4,"mat-option",7),t.ALo(8,"async"),t.qZA()(),t.TgZ(9,"mat-form-field",3)(10,"mat-select",8),t.YNc(11,tn,2,2,"mat-option",7),t.qZA()()(),t.BQk(),t.ynx(12,9),t.TgZ(13,"div",10)(14,"button",11),t._uU(15),t.qZA(),t.TgZ(16,"button",12),t.NdJ("click",function(){return i.assignRole()}),t._uU(17),t.qZA()(),t.BQk(),t.qZA()),2&e){const o=t.MAs(6);t.Q6J("headerTitle",i.labels.AssignTitle),t.xp6(2),t.Q6J("formGroup",i.form),t.xp6(2),t.s9C("placeholder",i.labels.User),t.Q6J("matAutocomplete",o)("lcValidationErrors",i.formName),t.xp6(1),t.Q6J("displayWith",i.getUserName),t.xp6(2),t.Q6J("ngForOf",t.lcZ(8,13,i.filteredUserOptions$)),t.xp6(3),t.s9C("placeholder",i.labels.Role),t.Q6J("lcValidationErrors",i.formName),t.xp6(1),t.Q6J("ngForOf",i.roles),t.xp6(3),t.Q6J("mat-dialog-close",!1),t.xp6(1),t.hij(" ",i.labels.CancelButtonText," "),t.xp6(2),t.hij(" ",i.labels.AssignButtonText," ")}},dependencies:[m.sg,w.m,z.D,x.lW,d.ZT,Pt.Nt,D.KE,dt.gD,g.ey,l._Y,l.Fj,l.JJ,l.JL,l.sg,l.u,Ge,Rt,m.Ov],styles:[".form[_ngcontent-%COMP%]{display:flex;flex-direction:column}.option[_ngcontent-%COMP%]{display:flex;flex-direction:column;line-height:.8;padding:10px 0}.option-subtitle[_ngcontent-%COMP%]{font-size:14px;color:#656565}.buttons[_ngcontent-%COMP%]{display:flex;justify-content:flex-end;align-items:center}.buttons[_ngcontent-%COMP%]   .cancel[_ngcontent-%COMP%]{margin-right:24px;font-style:normal;font-weight:500;color:#00677f}.buttons[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{height:56px;border-radius:10px;font-style:normal;font-weight:400;line-height:20px;padding:16px;text-transform:uppercase}.field[_ngcontent-%COMP%]{margin-bottom:22px}"],changeDetection:0})};ft=(0,O.gn)([h.c],ft);var Q=function(n){return n.inReview="in review",n.approved="approved",n.inProgress="in progress",n.rejected="rejected",n.closed="closed",n.prepared="prepared",n.overdue="overdue",n.blocked="blocked",n}(Q||{});function en(n,u){if(1&n&&(t.TgZ(0,"mat-option",18),t._uU(1),t.qZA()),2&n){const e=u.$implicit;t.Q6J("value",e.name),t.xp6(1),t.Oqu(e.translation)}}function nn(n,u){if(1&n&&(t.TgZ(0,"mat-form-field",15)(1,"mat-label"),t._uU(2,"\u041d\u043e\u0432\u044b\u0439 \u0441\u0442\u0430\u0442\u0443\u0441"),t.qZA(),t.TgZ(3,"mat-select",16),t.YNc(4,en,2,2,"mat-option",17),t.qZA()()),2&n){const e=t.oxw(2);t.xp6(3),t.Q6J("lcValidationErrors",e.formName),t.xp6(1),t.Q6J("ngForOf",e.statuses)}}function on(n,u){if(1&n&&(t.TgZ(0,"div",7),t._UZ(1,"lc-fake-input",8)(2,"lc-fake-input",9)(3,"lc-fake-input",10)(4,"lc-fake-input",11),t.TgZ(5,"div",12),t._UZ(6,"lc-fake-input",13),t.YNc(7,nn,5,2,"mat-form-field",14),t.qZA()()),2&n){const e=t.oxw();t.xp6(1),t.Q6J("text",e.equipment.title),t.xp6(1),t.Q6J("text",e.equipment.name),t.xp6(1),t.Q6J("text",e.equipment.inventoryNumber),t.xp6(1),t.Q6J("text",e.rentPeriod),t.xp6(1),t.Q6J("formGroup",e.form),t.xp6(1),t.Q6J("text",e.statusName),t.xp6(1),t.Q6J("ngIf",e.statuses)}}let un=(()=>{class n{constructor(e,i,o,a){this.data=e,this.dialogRef=i,this.validationService=o,this.fb=a,this.formName="application status form",this.statuses=[],this.rentPeriod="",this.statusName="",this.form=this.fb.group({newStatusId:[null,l.kI.required]})}ngOnInit(){const e=this.data;this.equipment=e.application.equipments[0],this.rentPeriod=e.rentPeriod,this.statusName=e.statusTranslation,this.statuses=this.getStatuses(e.statuses,e.application.last_status.status)}getStatuses(e,i){return e.filter(o=>{const a=o.name;return a!==i&&a!==Q.inProgress})}saveStatus(){this.validationService.emitSubmit(this.formName),this.form.valid&&this.dialogRef.close(this.form.value.newStatusId)}static#t=this.\u0275fac=function(i){return new(i||n)(t.Y36(d.WI),t.Y36(d.so),t.Y36(H.R),t.Y36(l.qu))};static#e=this.\u0275cmp=t.Xpm({type:n,selectors:[["lc-edit-application-status"]],decls:9,vars:2,consts:[["headerTitle","\u0418\u0437\u043c\u0435\u043d\u0438\u0442\u044c \u0441\u0442\u0430\u0442\u0443\u0441 \u0437\u0430\u044f\u0432\u043a\u0438"],["body",""],["class","content",4,"ngIf"],["footer",""],[1,"buttons"],["mat-button","",1,"cancel",3,"mat-dialog-close"],["mat-raised-button","","color","primary",3,"click"],[1,"content"],["label","\u041d\u0430\u0437\u0432\u0430\u043d\u0438\u0435",3,"text"],["label","\u041d\u0430\u0438\u043c\u0435\u043d\u043e\u0432\u0430\u043d\u0438\u0435",3,"text"],["label","\u0418\u043d\u0432\u0435\u043d\u0442\u0430\u0440\u043d\u044b\u0439 \u043d\u043e\u043c\u0435\u0440",3,"text"],["label","\u041f\u0435\u0440\u0438\u043e\u0434 \u0431\u0440\u043e\u043d\u0438\u0440\u043e\u0432\u0430\u043d\u0438\u044f",3,"text"],[1,"status",3,"formGroup"],["label","\u0410\u043a\u0442\u0443\u0430\u043b\u044c\u043d\u044b\u0439 \u0441\u0442\u0430\u0442\u0443\u0441",3,"text"],["floatLabel","auto",4,"ngIf"],["floatLabel","auto"],["formControlName","newStatusId",3,"lcValidationErrors"],[3,"value",4,"ngFor","ngForOf"],[3,"value"]],template:function(i,o){1&i&&(t.TgZ(0,"lc-modal-layout",0),t.ynx(1,1),t.YNc(2,on,8,7,"div",2),t.BQk(),t.ynx(3,3),t.TgZ(4,"div",4)(5,"button",5),t._uU(6," \u041e\u0442\u043c\u0435\u043d\u0438\u0442\u044c "),t.qZA(),t.TgZ(7,"button",6),t.NdJ("click",function(){return o.saveStatus()}),t._uU(8," \u0421\u043e\u0445\u0440\u0430\u043d\u0438\u0442\u044c "),t.qZA()(),t.BQk(),t.qZA()),2&i&&(t.xp6(2),t.Q6J("ngIf",o.equipment),t.xp6(3),t.Q6J("mat-dialog-close",!1))},dependencies:[m.sg,m.O5,Tt,w.m,z.D,x.lW,d.ZT,D.KE,D.hX,dt.gD,g.ey,l.JJ,l.JL,l.sg,l.u],styles:[".content[_ngcontent-%COMP%]   lc-fake-input[_ngcontent-%COMP%]{margin-bottom:20px}.content[_ngcontent-%COMP%]   .status[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:flex-end}.content[_ngcontent-%COMP%]   .status[_ngcontent-%COMP%]   lc-fake-input[_ngcontent-%COMP%]{width:200px;margin-bottom:0}.buttons[_ngcontent-%COMP%]{display:flex;justify-content:flex-end;align-items:center}.buttons[_ngcontent-%COMP%]   .cancel[_ngcontent-%COMP%]{margin-right:24px;font-style:normal;font-weight:500;color:#00677f}.buttons[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{height:56px;border-radius:10px;font-style:normal;font-weight:400;line-height:20px;padding:16px;text-transform:uppercase}"],changeDetection:0})}return n})();var Y=function(n){return n.added="\u041e\u0431\u043e\u0440\u0443\u0434\u043e\u0432\u0430\u043d\u0438\u0435 \u0434\u043e\u0431\u0430\u0432\u043b\u0435\u043d\u043e",n.archived="\u0431\u044b\u043b\u043e \u0437\u0430\u0430\u0440\u0445\u0438\u0432\u0438\u0440\u043e\u0432\u0430\u043d\u043e!",n.blocked="\u0431\u044b\u043b\u043e \u0437\u0430\u0431\u043b\u043e\u043a\u0438\u0440\u043e\u0432\u0430\u043d\u043e!",n.edited="\u041e\u0431\u043e\u0440\u0443\u0434\u043e\u0432\u0430\u043d\u0438\u0435 \u043e\u0442\u0440\u0435\u0434\u0430\u043a\u0442\u0438\u0440\u043e\u0432\u0430\u043d\u043e",n}(Y||{});const an={[p.vk.Archivate]:{tooltip:"",disabled:!1},[p.vk.Edit]:{tooltip:"",disabled:!1},[p.vk.Block]:{tooltip:"",disabled:!1},[p.vk.Orders]:{tooltip:"",disabled:!1}};var X=s(7626),tt=s(543);let sn=(()=>{class n{createDictionary(e,i){e.forEach(o=>i[o.id]=o.translation||o.name)}getDictionaryValue(e,i){return e[i]||void 0}static#t=this.\u0275fac=function(i){return new(i||n)};static#e=this.\u0275prov=t.Yz7({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();var B=s(186);let et=class ut{get equipmentData$(){return this.equipmentDataSubj$.asObservable()}constructor(u,e,i,o,a,r){this.dialog=u,this.api=e,this.notificationService=i,this.mainHeaderService=o,this.dictionaryService=a,this.store=r,this.equipmentDataSubj$=new G.X([]),this.inventoryNumbers=[],this.categoryDictionary={},this.statusDictionary={},this.statusIdsDictionary={...ue}}manageEvent(u){switch(u.action){case k.v.Block:this.blockEquipment(u);break;case k.v.Edit:this.manageEquipment(u.row);break;case k.v.Archivate:this.archivateEquipment(u)}}fetchEquipments(){return this.api.getAllEquipment().pipe((0,Z.b)(u=>this.inventoryNumbers=u.items.map(e=>e.inventoryNumber)),(0,_.U)(u=>this.createRows(u.items)),(0,Z.b)(u=>this.equipmentDataSubj$.next(u)))}createRows(u){return u.map(e=>{let i=an;const o=this.dictionaryService.getDictionaryValue(this.categoryDictionary,e.category),a=this.dictionaryService.getDictionaryValue(this.statusDictionary,e.status);return o&&(e.categoryName=o),a&&(e.statusName=a),e.status===this.statusIdsDictionary.archived&&(i={...i,[k.v.Archivate]:{tooltip:"",disabled:!0},[k.v.Edit]:{tooltip:"",disabled:!0},[k.v.Block]:{tooltip:"",disabled:!0}}),{...e,actions:i}})}blockEquipment(u){const e=u.row;let i,o;this.api.getUnavailablePeriodsById(e.id).pipe((0,_.U)(a=>(i=a.items?a.items:[],a.items)),(0,c.w)(a=>this.openBlockEquipmentModal(e,a)),(0,f.h)(Boolean),(0,_.U)(a=>(o=a,this.isPeriodsIntersect(a,i))),(0,c.w)(a=>a?this.openOrderNotificationModal(u.action):(0,F.of)(!0)),(0,f.h)(Boolean),(0,c.w)(()=>this.api.blockEquipment(e.id,o)),(0,h.t)(this)).subscribe(a=>{this.notificationService.openSuccess(`${e.title} ${Y.blocked}`)})}isPeriodsIntersect(u,e){for(const i of e)if(this.isDateInPeriod(u.startDate,i)||this.isDateInPeriod(u.endDate,i))return!0;return!1}isDateInPeriod(u,e){const i=new Date(e.start_date),o=new Date(e.end_date);return u.getTime(),u>=i&&u<=o}archivateEquipment(u){const e=u.row;this.openArchiveEquipmentModal(e).pipe((0,f.h)(Boolean),(0,c.w)(()=>this.api.getEquipmentUnavailabilityPeriods(e.id)),(0,c.w)(i=>i.items&&i.items.length?this.openOrderNotificationModal(u.action):(0,F.of)(!0)),(0,f.h)(Boolean),(0,c.w)(()=>this.api.archiveEquipment(e.id)),(0,c.w)(()=>this.fetchEquipments()),(0,h.t)(this)).subscribe(()=>{this.notificationService.openSuccess(`${e.title} ${Y.archived}}`)})}openOrderNotificationModal(u){return this.dialog.open(oe,{...M,data:u}).afterClosed()}openArchiveEquipmentModal(u){return this.dialog.open(Kt,{...M,data:u}).afterClosed()}openBlockEquipmentModal(u,e){return this.dialog.open(ct,{...M,data:{equipment:u,unavailablePeriods:e||[]}}).afterClosed()}createCategoryDictionary(u){this.dictionaryService.createDictionary(u,this.categoryDictionary)}createStatusDictionary(u){this.dictionaryService.createDictionary(u,this.statusDictionary)}createEquipmentStatusIds(u){u.forEach(e=>{this.statusIdsDictionary[e.name]=e.id})}manageEquipment(u){this.openEquipmentModal(u).pipe((0,f.h)(Boolean),(0,c.w)(e=>(0,Xt.D)({photo:e.file?this.api.uploadPhoto(e.file):(0,F.of)(null),equipment:(0,F.of)(e.equipment)})),(0,c.w)(e=>(e.photo&&(e.equipment.photoID=e.photo.data.id),u?this.api.editEquipment(e.equipment,u.id):this.api.registerEquipment(e.equipment))),(0,c.w)(()=>this.fetchEquipments()),(0,h.t)(this)).subscribe(e=>{this.notificationService.openSuccess(u?Y.edited:Y.added)})}addNewEquipment(){this.manageEquipment()}openEquipmentModal(u){const e=this.store.snapshot().application_data;return this.dialog.open(_e,{autoFocus:!1,data:{inventoryNumbers:this.inventoryNumbers||[],equipment:u?this.prepareEquipmentForModal(u):void 0,petKinds:e?.petKinds||[],petSizes:e?.petSizes||[],categories:e?.equipmentCategories||[]}}).afterClosed()}prepareEquipmentForModal(u){const e=this.store.snapshot().application_data.petKinds,i={...u};return i.receiptDate=+`${i.receiptDate}000`,i.petKinds=u.petKinds.map(o=>{if("number"==typeof o)return o;const a=e.find(r=>r.name===o.name);return a?a.id:0}),i}setPageHeader(){this.mainHeaderService.setPageTitle("\u041e\u0431\u043e\u0440\u0443\u0434\u043e\u0432\u0430\u043d\u0438\u0435")}static#t=this.\u0275fac=function(e){return new(e||ut)(t.LFG(d.uw),t.LFG(T),t.LFG(X.T),t.LFG(tt.I),t.LFG(sn),t.LFG(B.yh))};static#e=this.\u0275prov=t.Yz7({token:ut,factory:ut.\u0275fac})};function ln(n,u){if(1&n&&(t.TgZ(0,"p"),t._uU(1),t.qZA()),2&n){const e=t.oxw();t.xp6(1),t.Oqu(e.body)}}function rn(n,u){1&n&&t.GkF(0)}function cn(n,u){if(1&n&&(t.TgZ(0,"button",8),t._uU(1),t.qZA()),2&n){const e=t.oxw();t.Q6J("mat-dialog-close",!1),t.xp6(1),t.hij(" ",e.cancelButtonText," ")}}function pn(n,u){if(1&n&&(t.TgZ(0,"button",9),t._uU(1),t.qZA()),2&n){const e=t.oxw();t.Q6J("mat-dialog-close",!0),t.xp6(1),t.hij(" ",e.applyButtonText," ")}}et=(0,O.gn)([h.c],et),s(3103),s(3104);const mn=function(n){return{data:n}};let gt=(()=>{class n{constructor(e){this.confirmationModalData=e,this.title="",this.contentComponent=null}ngOnInit(){this.title=this.confirmationModalData.title,this.body=this.confirmationModalData.body,this.contentComponent=this.confirmationModalData.contentComponent||null,this.contentComponentData=this.confirmationModalData.contentComponentData,this.applyButtonText=this.confirmationModalData.applyButtonText,this.cancelButtonText=this.confirmationModalData.cancelButtonText}static#t=this.\u0275fac=function(i){return new(i||n)(t.Y36(d.WI))};static#e=this.\u0275cmp=t.Xpm({type:n,selectors:[["lc-confirmation-modal"]],decls:8,vars:8,consts:[[3,"headerTitle"],["body",""],[4,"ngIf"],[4,"ngComponentOutlet","ngComponentOutletInputs"],["footer",""],[1,"buttons"],["mat-button","","class","cancel",3,"mat-dialog-close",4,"ngIf"],["mat-raised-button","","color","primary",3,"mat-dialog-close",4,"ngIf"],["mat-button","",1,"cancel",3,"mat-dialog-close"],["mat-raised-button","","color","primary",3,"mat-dialog-close"]],template:function(i,o){1&i&&(t.TgZ(0,"lc-modal-layout",0),t.ynx(1,1),t.YNc(2,ln,2,1,"p",2),t.YNc(3,rn,1,0,"ng-container",3),t.BQk(),t.ynx(4,4),t.TgZ(5,"div",5),t.YNc(6,cn,2,2,"button",6),t.YNc(7,pn,2,2,"button",7),t.qZA(),t.BQk(),t.qZA()),2&i&&(t.Q6J("headerTitle",o.title),t.xp6(2),t.Q6J("ngIf",o.body),t.xp6(1),t.Q6J("ngComponentOutlet",o.contentComponent)("ngComponentOutletInputs",t.VKq(6,mn,o.contentComponentData)),t.xp6(3),t.Q6J("ngIf",o.cancelButtonText),t.xp6(1),t.Q6J("ngIf",o.applyButtonText))},dependencies:[m.$G,m.O5,x.lW,d.ZT,w.m],styles:[".buttons[_ngcontent-%COMP%]{display:flex;justify-content:flex-end;align-items:center}.buttons[_ngcontent-%COMP%]   .cancel[_ngcontent-%COMP%]{font-style:normal;font-weight:500;color:#00677f}.buttons[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{font-style:normal;font-weight:400;margin-right:24px;line-height:20px;text-transform:uppercase;height:56px;border-radius:10px}.buttons[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]:last-child{margin-right:0}"],changeDetection:0})}return n})();var Qt=s(9079);s(6341),s(4274),s(2389),s(155);const dn={[p.Vw.Profile]:{tooltip:"",disabled:!1},[p.Vw.Block]:{tooltip:"",disabled:!1},[p.Vw.Delete]:{tooltip:"",disabled:!0}};let nt=class at{constructor(u,e,i,o){this.api=u,this.notificationService=e,this.dialog=i,this.mainPageHeaderService=o,this.usersSubject$=new G.X([])}get users$(){return this.usersSubject$.asObservable()}setPageTitle(u){this.mainPageHeaderService.setPageTitle(u)}fetchUsers(){return this.api.getAllUsers().pipe((0,Z.b)(u=>this.usersSubject$.next(this.createRows(u.items))))}editUser(u){switch(u.action){case p.Vw.Profile:break;case p.Vw.Block:this.updateUserBlockingStatus(u);break;case p.Vw.Delete:this.deleteUser(u)}}updateUserBlockingStatus(u){const e=u.row;this.openBlockUserModal(e).pipe((0,f.h)(Boolean),(0,c.w)(()=>this.api.updateUserReadonlyAccess(e.id,!e.is_readonly)),(0,c.w)(()=>this.fetchUsers()),(0,h.t)(this)).subscribe(()=>{this.notificationService.openSuccess(e.is_readonly?j.Unblocked:j.Blocked)})}openBlockUserModal(u){return this.dialog.open(gt,{...M,data:{title:u.is_readonly?v.UnblockTitle:v.BlockTitle,contentComponentData:u,contentComponent:Ce,applyButtonText:u.is_readonly?v.UnblockButtonText:v.BlockButtonText,cancelButtonText:v.CancelButtonText}}).afterClosed()}deleteUser(u){const e=u.row;this.openDeleteUserModal(e).pipe((0,f.h)(Boolean),(0,c.w)(()=>this.api.deleteUser(e.id)),(0,c.w)(()=>this.fetchUsers()),(0,h.t)(this)).subscribe(()=>{this.notificationService.openSuccess(j.Deleted)})}openDeleteUserModal(u){return this.dialog.open(gt,{...M,data:{title:v.DeleteTitle,contentComponentData:u,contentComponent:be,applyButtonText:v.DeleteButtonText,cancelButtonText:v.CancelButtonText}}).afterClosed()}createRows(u){return u.map(e=>{let i=dn;return e.is_readonly?(e.status=mt.Blocked,i={...i,[p.Vw.Delete]:{tooltip:J.Delete,disabled:!1}}):e.status=mt.Active,{...e,actions:i}})}static#t=this.\u0275fac=function(e){return new(e||at)(t.LFG(T),t.LFG(X.T),t.LFG(d.uw),t.LFG(tt.I))};static#e=this.\u0275prov=t.Yz7({token:at,factory:at.\u0275fac})};nt=(0,O.gn)([h.c],nt);var Jt=function(n){return n.Delete="delete",n}(Jt||{}),_t=function(n){return n.Deleted="\u0420\u043e\u043b\u044c \u0443\u0434\u0430\u043b\u0435\u043d\u0430",n.Assigned="\u0420\u043e\u043b\u044c \u043d\u0430\u0437\u043d\u0430\u0447\u0435\u043d\u0430",n}(_t||{}),I=s(6150);let it=class st{constructor(u,e,i,o,a){this.api=u,this.notificationService=e,this.dialog=i,this.mainPageHeaderService=o,this.store=a,this.rolesSubject$=new G.X([]),this.roles=this.store.selectSnapshot(I.in).roles,this.users=[]}get roles$(){return this.rolesSubject$.asObservable()}setPageTitle(){this.mainPageHeaderService.setPageTitle("\u0420\u043e\u043b\u0438")}fetchRoles(){return this.api.getAllUsers().pipe((0,Z.b)(u=>{this.users=u.items,this.rolesSubject$.next(this.createRows(u.items))}))}manageEvent(u){u.action===Jt.Delete&&this.deleteRole(u)}assignRole(){this.openAssignRoleModal().pipe((0,f.h)(Boolean),(0,c.w)(u=>this.api.assignRoleToUser(u.userId,u.roleId)),(0,c.w)(()=>this.fetchRoles()),(0,h.t)(this)).subscribe(()=>{this.notificationService.openSuccess(_t.Assigned)})}openAssignRoleModal(){return this.dialog.open(ft,{...M,data:{roles:this.roles,users:this.users}}).afterClosed()}deleteRole(u){const e=u.row;this.openDeleteRoleModal(e).pipe((0,f.h)(Boolean),(0,c.w)(()=>this.api.assignRoleToUser(e.id,this.userRoleId)),(0,c.w)(()=>this.fetchRoles()),(0,h.t)(this)).subscribe(()=>{this.notificationService.openSuccess(_t.Deleted)})}openDeleteRoleModal(u){return this.dialog.open(gt,{...M,data:{title:L.DeleteTitle,contentComponentData:u,contentComponent:xe,applyButtonText:L.DeleteButtonText,cancelButtonText:v.CancelButtonText}}).afterClosed()}createRows(u){return u.reduce((e,i)=>{if(i.role.id!==this.userRoleId){const o={...i,roleName:i.role.name};e.push(o)}return e},[])}get userRoleId(){return this.roles.find(u=>"user"===u.slug).id}static#t=this.\u0275fac=function(e){return new(e||st)(t.LFG(T),t.LFG(X.T),t.LFG(d.uw),t.LFG(tt.I),t.LFG(B.yh))};static#e=this.\u0275prov=t.Yz7({token:st,factory:st.\u0275fac})};it=(0,O.gn)([h.c],it);let Lt=(()=>{class n{constructor(e,i){this.api=e,this.store=i}getRoles(){return this.api.getAllRoles().pipe((0,c.w)(e=>this.store.dispatch(new I.Dr(e))),(0,_.U)(e=>e.application_data?.roles))}static#t=this.\u0275fac=function(i){return new(i||n)(t.LFG(T),t.LFG(B.yh))};static#e=this.\u0275prov=t.Yz7({token:n,factory:n.\u0275fac})}return n})();var vt=function(n){return n["in review"]="\u041e\u0436\u0438\u0434\u0430\u0435\u0442",n.approved="\u041e\u0434\u043e\u0431\u0440\u0435\u043d\u043e",n["in progress"]="\u0418\u0441\u043f\u043e\u043b\u044c\u0437\u0443\u0435\u0442\u0441\u044f",n.rejected="\u041e\u0442\u043a\u043b\u043e\u043d\u0435\u043d\u043e",n.closed="\u0417\u0430\u043a\u0440\u044b\u0442\u043e",n.prepared="\u0413\u043e\u0442\u043e\u0432\u043e \u043a \u0432\u044b\u0434\u0430\u0447\u0435",n.overdue="\u041f\u0440\u043e\u0441\u0440\u043e\u0447\u0435\u043d\u043e",n.blocked="\u0417\u0430\u0431\u043b\u043e\u043a\u0438\u0440\u043e\u0432\u0430\u043d\u043e",n}(vt||{});let Yt=(()=>{class n{constructor(e,i){this.api=e,this.store=i}getApplicationStatusNames(){return this.api.getApplicationStatuses().pipe((0,_.U)(e=>this.translateStatuses(e)),(0,c.w)(e=>this.store.dispatch(new I.IQ(e))),(0,_.U)(e=>e.application_data?.applicationStatuses))}translateStatuses(e){return e.map(i=>({...i,translation:vt[i.name]||""}))}static#t=this.\u0275fac=function(i){return new(i||n)(t.LFG(T),t.LFG(B.yh))};static#e=this.\u0275prov=t.Yz7({token:n,factory:n.\u0275fac})}return n})();var Ct=s(3566),Vt=s(1476),b=s(9538),hn=s(2596);let fn=(()=>{class n{transform(e,i){return i.actions&&i.actions[e.columnDef].disabled||!1}static#t=this.\u0275fac=function(i){return new(i||n)};static#e=this.\u0275pipe=t.Yjl({name:"tableDisableAction",type:n,pure:!0})}return n})(),gn=(()=>{class n{transform(e,i){return i.actions&&i.actions[e.columnDef]?.tooltip||e.tooltip||""}static#t=this.\u0275fac=function(i){return new(i||n)};static#e=this.\u0275pipe=t.Yjl({name:"tableActionTooltip",type:n,pure:!0})}return n})();function _n(n,u){if(1&n&&(t.TgZ(0,"th",10),t._uU(1),t.qZA()),2&n){const e=t.oxw(2).$implicit;t.xp6(1),t.Oqu(e.header)}}function vn(n,u){1&n&&(t.ynx(0),t.YNc(1,_n,2,1,"th",9),t.BQk())}function Cn(n,u){if(1&n&&(t.TgZ(0,"th",12),t._uU(1),t.qZA()),2&n){const e=t.oxw(2).$implicit;t.xp6(1),t.Oqu(e.header)}}function yn(n,u){1&n&&(t.ynx(0),t.YNc(1,Cn,2,1,"th",11),t.BQk())}function bn(n,u){if(1&n&&(t.ynx(0),t._uU(1),t.BQk()),2&n){const e=t.oxw().$implicit,i=t.oxw().$implicit;t.xp6(1),t.hij(" ",e[i.columnDef]," ")}}function En(n,u){if(1&n){const e=t.EpF();t.ynx(0),t.TgZ(1,"button",15),t.NdJ("click",function(){t.CHM(e);const o=t.oxw().$implicit,a=t.oxw().$implicit,r=t.oxw();return t.KtG(r.editRow({row:o,action:a.action}))}),t.ALo(2,"tableDisableAction"),t.TgZ(3,"mat-icon",16),t._uU(4),t.qZA()(),t.BQk()}if(2&n){const e=t.oxw().$implicit,i=t.oxw().$implicit;t.xp6(1),t.Q6J("disabled",t.xi3(2,2,i,e)),t.xp6(3),t.Oqu(i.action)}}function xn(n,u){if(1&n&&(t.TgZ(0,"td",13)(1,"span",14),t.ALo(2,"tableActionTooltip"),t.YNc(3,bn,2,1,"ng-container",7),t.YNc(4,En,5,5,"ng-container",7),t.qZA()()),2&n){const e=u.$implicit,i=t.oxw().$implicit;t.Q6J("ngStyle",i.style),t.xp6(1),t.Q6J("matTooltip",t.xi3(2,4,i,e)),t.xp6(2),t.Q6J("ngIf",!i.action),t.xp6(1),t.Q6J("ngIf",i.action)}}function Dn(n,u){if(1&n&&(t.ynx(0,6),t.YNc(1,vn,2,0,"ng-container",7),t.YNc(2,yn,2,0,"ng-container",7),t.YNc(3,xn,5,7,"td",8),t.BQk()),2&n){const e=u.$implicit;t.Q6J("matColumnDef",e.columnDef),t.xp6(1),t.Q6J("ngIf",e.action),t.xp6(1),t.Q6J("ngIf",!e.action)}}function An(n,u){1&n&&t._UZ(0,"tr",17)}function On(n,u){1&n&&t._UZ(0,"tr",18)}let ot=(()=>{class n{constructor(){this.columns=[],this.data=[],this.limit=10,this.action=new t.vpe,this.total=0}ngOnChanges(e){e.data&&(this.total=this.data.length,this.dataSource=this.getMatTableData(this.data))}get displayedColumns(){return this.columns.map(e=>e.columnDef)}editRow(e){this.action.emit(e)}getMatTableData(e){const i=new b.by(e);return this.sort&&this.dataSource&&(i.sort=this.sort),this.paginator&&(i.paginator=this.paginator),i}static#t=this.\u0275fac=function(i){return new(i||n)};static#e=this.\u0275cmp=t.Xpm({type:n,selectors:[["lc-table"]],viewQuery:function(i,o){if(1&i&&(t.Gf(Vt.NW,5),t.Gf(Ct.YE,5)),2&i){let a;t.iGM(a=t.CRH())&&(o.paginator=a.first),t.iGM(a=t.CRH())&&(o.sort=a.first)}},inputs:{columns:"columns",data:"data",limit:"limit"},outputs:{action:"action"},features:[t.TTD],decls:6,vars:6,consts:[["mat-table","","matSort","",3,"dataSource"],[3,"matColumnDef",4,"ngFor","ngForOf"],["mat-header-row","",4,"matHeaderRowDef"],["mat-row","",4,"matRowDef","matRowDefColumns"],["hidePageSize","",1,"paginator",3,"length","pageSize"],["paginator",""],[3,"matColumnDef"],[4,"ngIf"],["mat-cell","",3,"ngStyle",4,"matCellDef"],["mat-header-cell","",4,"matHeaderCellDef"],["mat-header-cell",""],["mat-header-cell","","mat-sort-header","",4,"matHeaderCellDef"],["mat-header-cell","","mat-sort-header",""],["mat-cell","",3,"ngStyle"],[3,"matTooltip"],["mat-icon-button","",3,"disabled","click"],["fontSet","material-icons-outlined"],["mat-header-row",""],["mat-row",""]],template:function(i,o){1&i&&(t.TgZ(0,"table",0),t.YNc(1,Dn,4,3,"ng-container",1),t.YNc(2,An,1,0,"tr",2),t.YNc(3,On,1,0,"tr",3),t.qZA(),t._UZ(4,"mat-paginator",4,5)),2&i&&(t.Q6J("dataSource",o.dataSource),t.xp6(1),t.Q6J("ngForOf",o.columns),t.xp6(1),t.Q6J("matHeaderRowDef",o.displayedColumns),t.xp6(1),t.Q6J("matRowDefColumns",o.displayedColumns),t.xp6(1),t.Q6J("length",o.total)("pageSize",o.limit))},dependencies:[m.sg,m.O5,m.PC,x.RK,pt.Hw,Vt.NW,b.BZ,b.fO,b.as,b.w1,b.Dz,b.nj,b.ge,b.ev,b.XQ,b.Gk,hn.gM,Ct.YE,Ct.nU,fn,gn],styles:["[_nghost-%COMP%]{display:block}[_nghost-%COMP%]   table[_ngcontent-%COMP%]{width:100%}[_nghost-%COMP%]   .mat-header-cell[_ngcontent-%COMP%], [_nghost-%COMP%]   .mat-cell[_ngcontent-%COMP%]{padding:0 8px}[_nghost-%COMP%]   .mat-header-cell[_ngcontent-%COMP%]:first-child, [_nghost-%COMP%]   .mat-cell[_ngcontent-%COMP%]:first-child{padding-left:16px}[_nghost-%COMP%]   .mat-header-cell[_ngcontent-%COMP%]:last-child, [_nghost-%COMP%]   .mat-cell[_ngcontent-%COMP%]:last-child{padding-right:16px}[_nghost-%COMP%]   .mat-cell[_ngcontent-%COMP%]{text-overflow:ellipsis;white-space:nowrap;overflow:hidden}"],changeDetection:0})}return n})();const Tn=function(){return[]};let V=class Dt{constructor(u){this.controller=u,this.columns=le,this.data$=this.controller.equipmentData$}ngOnInit(){this.controller.setPageHeader(),this.controller.fetchEquipments().subscribe(),this.equipmentCategories.pipe((0,h.t)(this)).subscribe(u=>this.controller.createCategoryDictionary(u)),this.equipmentStatuses.pipe((0,h.t)(this)).subscribe(u=>{this.controller.createStatusDictionary(u),this.controller.createEquipmentStatusIds(u)})}editEquipment(u){this.controller.manageEvent(u)}addNewEquipment(){this.controller.addNewEquipment()}static#t=this.\u0275fac=function(e){return new(e||Dt)(t.Y36(et))};static#e=this.\u0275cmp=t.Xpm({type:Dt,selectors:[["lc-equipments"]],features:[t._Bn([et])],decls:7,vars:6,consts:[[3,"columns","limit","data","action"],["mat-raised-button","","color","primary",1,"add-equipment",3,"click"],[1,"content"]],template:function(e,i){1&e&&(t.TgZ(0,"lc-table",0),t.NdJ("action",function(a){return i.editEquipment(a)}),t.ALo(1,"async"),t.qZA(),t.TgZ(2,"button",1),t.NdJ("click",function(){return i.addNewEquipment()}),t.TgZ(3,"div",2)(4,"span"),t._uU(5,"+"),t.qZA(),t._uU(6,"\u0414\u043e\u0431\u0430\u0432\u0438\u0442\u044c \u043e\u0431\u043e\u0440\u0443\u0434\u043e\u0432\u0430\u043d\u0438\u0435"),t.qZA()()),2&e&&t.Q6J("columns",i.columns)("limit",20)("data",t.lcZ(1,3,i.data$)||t.DdM(5,Tn))},dependencies:[ot,x.lW,m.Ov],styles:["lc-table[_ngcontent-%COMP%]{margin-bottom:30px}.add-equipment[_ngcontent-%COMP%]{position:fixed;bottom:24px;right:24px;height:56px;border-radius:28px;padding:20px}.add-equipment[_ngcontent-%COMP%]   .content[_ngcontent-%COMP%]{display:flex;align-items:center;color:#fff;font-size:14px;font-family:Roboto,serif;font-weight:400;text-transform:uppercase;line-height:24px;letter-spacing:1.25px;word-wrap:break-word}.add-equipment[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{font-size:24px;font-weight:100;margin-right:8px}"],changeDetection:0})};(0,O.gn)([(0,B.Ph)(I.in.equipmentCategories)],V.prototype,"equipmentCategories",void 0),(0,O.gn)([(0,B.Ph)(I.in.equipmentStatuses)],V.prototype,"equipmentStatuses",void 0),V=(0,O.gn)([h.c],V);var $=s(4614),Mn=s(1607);let yt=(()=>{class n{constructor(e,i){this.api=e,this.store=i}getEquipmentStatuses(){return this.api.getEquipmentStatuses().pipe((0,_.U)(e=>this.fillInStatusesTranslations(e)),(0,c.w)(e=>this.store.dispatch(new I.xs(e))),(0,_.U)(e=>e.application_data?.equipmentStatuses))}fillInStatusesTranslations(e){return e.map(i=>{const o=re[i.name];return o&&(i.translation=o),i})}getEquipmentCategories(){return this.api.getEquipmentCategories().pipe((0,c.w)(e=>this.store.dispatch(new I.FI(e.items))),(0,_.U)(e=>e.application_data?.equipmentCategories))}static#t=this.\u0275fac=function(i){return new(i||n)(t.LFG(T),t.LFG(B.yh))};static#e=this.\u0275prov=t.Yz7({token:n,factory:n.\u0275fac})}return n})(),$t=(()=>{class n{constructor(e){this.equipmentResolverService=e}resolve(){return this.equipmentResolverService.getEquipmentStatuses()}static#t=this.\u0275fac=function(i){return new(i||n)(t.LFG(yt))};static#e=this.\u0275prov=t.Yz7({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})(),Gt=(()=>{class n{constructor(e){this.equipmentResolverService=e}resolve(){return this.equipmentResolverService.getEquipmentCategories()}static#t=this.\u0275fac=function(i){return new(i||n)(t.LFG(yt))};static#e=this.\u0275prov=t.Yz7({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();const Bn=function(){return[]};let Sn=(()=>{class n{constructor(e){this.controller=e,this.columns=ce,this.users$=this.controller.users$}ngOnInit(){this.controller.fetchUsers().subscribe(),this.controller.setPageTitle(St.Users)}editUser(e){this.controller.editUser(e)}static#t=this.\u0275fac=function(i){return new(i||n)(t.Y36(nt))};static#e=this.\u0275cmp=t.Xpm({type:n,selectors:[["lc-users"]],features:[t._Bn([nt])],decls:2,vars:5,consts:[[3,"columns","data","action"]],template:function(i,o){1&i&&(t.TgZ(0,"lc-table",0),t.NdJ("action",function(r){return o.editUser(r)}),t.ALo(1,"async"),t.qZA()),2&i&&t.Q6J("columns",o.columns)("data",t.lcZ(1,2,o.users$)||t.DdM(4,Bn))},dependencies:[ot,m.Ov],changeDetection:0})}return n})();const wn=[{header:"\u042d\u043b\u0435\u043a\u0442\u0440\u043e\u043d\u043d\u0430\u044f \u043f\u043e\u0447\u0442\u0430",columnDef:"email",style:{"minWidth.px":200}},{header:"\u0424\u0430\u043c\u0438\u043b\u0438\u044f",columnDef:"surname",style:{"minWidth.px":200}},{header:"\u0418\u043c\u044f",columnDef:"name",style:{"minWidth.px":200}},{header:"\u0420\u043e\u043b\u044c",columnDef:"roleName",style:{"width.px":150}},{header:"",columnDef:p.Vw.Delete,action:p.Vw.Delete,tooltip:"\u0423\u0434\u0430\u043b\u0435\u043d\u0438\u0435",style:{"width.px":32,"padding.px":0}}],Pn=function(){return[]};let kn=(()=>{class n{constructor(e){this.controller=e,this.columns=wn,this.data$=this.controller.roles$}ngOnInit(){this.controller.setPageTitle(),this.controller.fetchRoles().subscribe()}editRole(e){this.controller.manageEvent(e)}assignRole(){this.controller.assignRole()}static#t=this.\u0275fac=function(i){return new(i||n)(t.Y36(it))};static#e=this.\u0275cmp=t.Xpm({type:n,selectors:[["lc-roles"]],features:[t._Bn([it])],decls:7,vars:6,consts:[[3,"columns","limit","data","action"],["mat-raised-button","","color","primary",1,"add-role",3,"click"],[1,"content"]],template:function(i,o){1&i&&(t.TgZ(0,"lc-table",0),t.NdJ("action",function(r){return o.editRole(r)}),t.ALo(1,"async"),t.qZA(),t.TgZ(2,"button",1),t.NdJ("click",function(){return o.assignRole()}),t.TgZ(3,"div",2)(4,"span"),t._uU(5,"+"),t.qZA(),t._uU(6,"\u041d\u0430\u0437\u043d\u0430\u0447\u0438\u0442\u044c \u0440\u043e\u043b\u044c"),t.qZA()()),2&i&&t.Q6J("columns",o.columns)("limit",20)("data",t.lcZ(1,3,o.data$)||t.DdM(5,Pn))},dependencies:[ot,x.lW,m.Ov],styles:[".add-role[_ngcontent-%COMP%]{position:fixed;bottom:24px;right:24px;height:56px;border-radius:28px;padding:20px}.add-role[_ngcontent-%COMP%]   .content[_ngcontent-%COMP%]{display:flex;align-items:center;color:#fff;font-size:14px;font-family:Roboto,serif;font-weight:400;text-transform:uppercase;line-height:24px;letter-spacing:1.25px;word-wrap:break-word}.add-role[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{font-size:24px;font-weight:100;margin-right:8px}"],changeDetection:0})}return n})();var S=function(n){return n.edit="edit",n.more="more_horiz",n}(S||{});const In=[{header:"\u0421\u0442\u0430\u0442\u0443\u0441",columnDef:"status",style:{"width.px":150}},{header:"\u0418\u043d\u0432\u0435\u043d\u0442\u0430\u0440\u043d\u044b\u0439 \u043d\u043e\u043c\u0435\u0440",columnDef:"equipmentInventoryNumber",style:null},{header:"\u041f\u0435\u0440\u0438\u043e\u0434 \u0431\u0440\u043e\u043d\u0438\u0440\u043e\u0432\u0430\u043d\u0438\u044f",columnDef:"rentPeriod",style:null},{header:"\u041d\u0430\u0437\u0432\u0430\u043d\u0438\u0435",columnDef:"equipmentName",style:null},{header:"\u041d\u0430\u0438\u043c\u0435\u043d\u043e\u0432\u0430\u043d\u0438\u0435",columnDef:"equipmentTitle",style:null},{header:"\u0424\u0430\u043c\u0438\u043b\u0438\u044f",columnDef:"userSurname",style:null},{header:"\u0418\u043c\u044f",columnDef:"userName",style:null},{header:"\u0422\u0435\u043b\u0435\u0444\u043e\u043d",columnDef:"userPhoneNumber",style:null},{header:"",columnDef:S.edit,action:S.edit,tooltip:"\u0420\u0435\u0434\u0430\u043a\u0442\u0438\u0440\u043e\u0432\u0430\u043d\u0438\u0435",style:{"width.px":32,"padding.px":0}},{header:"",columnDef:S.more,action:S.more,tooltip:"???",style:{"width.px":32,"padding.px":0}}];let Ht=(()=>{class n{get applicationsData$(){return this.applicationsSub.asObservable()}constructor(e,i,o,a,r){this.api=e,this.dialog=i,this.store=o,this.notificationsService=a,this.mainPageHeaderService=r,this.applicationsSub=new G.X([])}get applicationStatuses(){return this.store.snapshot().application_data?.applicationStatuses||[]}setPageTitle(){this.mainPageHeaderService.setPageTitle("\u0417\u0430\u044f\u0432\u043a\u0438")}fetchApplications(){return this.api.getAllOrders().pipe((0,_.U)(e=>this.createRows(e.items)),(0,Z.b)(e=>this.applicationsSub.next(e)))}createRows(e){return e.map(i=>({entity:i,...i,...this.getUserInfo(i.user),...this.getEquipmentInfo(i.equipments),rentPeriod:this.getRentPeriodValue(i),status:this.getApplicationStatusName(i.last_status),actions:this.getRowActions(i)}))}getRowActions(e){const i=e.last_status.status;return{[S.more]:{tooltip:"",disabled:!1},[S.edit]:{tooltip:"",disabled:i===Q.closed||i===Q.rejected}}}getApplicationStatusName(e){return vt[e.status]||""}getRentPeriodValue(e){const i=new Date(e.rent_start),o=new Date(e.rent_end);return`${i.getDate()}.${i.getMonth()+1}-${o.getDate()}.${o.getMonth()+1}`}getUserInfo(e){return{userName:e.name||"",userSurname:e.surname||"",userPhoneNumber:e.phone_number||""}}getEquipmentInfo(e){const i=e[0]||void 0;return{equipmentName:i?.name||"",equipmentTitle:i?.title||"",equipmentInventoryNumber:i?.inventoryNumber||""}}editApplication(e){e.action===S.edit&&this.editApplicationStatus(e.row)}editApplicationStatus(e){let i;this.openEditApplicationStatusModal(e).pipe((0,f.h)(Boolean),(0,c.w)(o=>(i=o,this.checkNonChangeableStatuses(o))),(0,f.h)(Boolean),(0,c.w)(()=>{const o=this.getChangeStatusBody(e,i);return this.api.editApplicationStatus(o)}),(0,c.w)(()=>this.fetchApplications())).subscribe(()=>this.notificationsService.openSuccess("\u0421\u0442\u0430\u0442\u0443\u0441 \u0437\u0430\u044f\u0432\u043a\u0438 \u0438\u0437\u043c\u0435\u043d\u0435\u043d"))}checkNonChangeableStatuses(e){switch(e){case Q.rejected:return this.openNotificationRejectedStatus();case Q.closed:return this.openNotificationAboutClosedStatus();default:return(0,F.of)(!0)}}openNotificationAboutClosedStatus(){return this.dialog.open(Qt.S,{width:"472px",data:{headerText:'\u0421\u0442\u0430\u0442\u0443\u0441 "\u0417\u0430\u043a\u0440\u044b\u0442\u043e"',infoMessage:'\u0415\u0441\u043b\u0438 \u0412\u044b \u0441\u043e\u0445\u0440\u0430\u043d\u0438\u0442\u0435 \u0437\u0430\u044f\u0432\u043a\u0443 \u0432 \u0441\u0442\u0430\u0442\u0443\u0441\u0435 "\u0417\u0430\u043a\u0440\u044b\u0442\u043e", \u0442\u043e \u0438\u0437\u043c\u0435\u043d\u0438\u0442\u044c \u0441\u0442\u0430\u0442\u0443\u0441 \u044d\u0442\u043e\u0439 \u0437\u0430\u044f\u0432\u043a\u0438 \u0432 \u0431\u0443\u0434\u0443\u0449\u0435\u043c \u0431\u0443\u0434\u0435\u0442 \u043d\u0435\u0432\u043e\u0437\u043c\u043e\u0436\u043d\u043e.',buttonOkText:"\u0421\u043e\u0445\u0440\u0430\u043d\u0438\u0442\u044c",buttonCancelText:"\u041e\u0442\u043c\u0435\u043d\u0438\u0442\u044c"}}).afterClosed()}openNotificationRejectedStatus(){return this.dialog.open(Qt.S,{width:"472px",data:{headerText:'\u0421\u0442\u0430\u0442\u0443\u0441 "\u041e\u0442\u043a\u043b\u043e\u043d\u0435\u043d\u043e"',infoMessage:'\u0415\u0441\u043b\u0438 \u0412\u044b \u0441\u043e\u0445\u0440\u0430\u043d\u0438\u0442\u0435 \u0437\u0430\u044f\u0432\u043a\u0443 \u0432 \u0441\u0442\u0430\u0442\u0443\u0441\u0435 "\u041e\u0442\u043a\u043b\u043e\u043d\u0435\u043d\u043e", \u0442\u043e \u0438\u0437\u043c\u0435\u043d\u0438\u0442\u044c \u0441\u0442\u0430\u0442\u0443\u0441 \u044d\u0442\u043e\u0439 \u0437\u0430\u044f\u0432\u043a\u0438 \u0432 \u0431\u0443\u0434\u0443\u0449\u0435\u043c \u0431\u0443\u0434\u0435\u0442 \u043d\u0435\u0432\u043e\u0437\u043c\u043e\u0436\u043d\u043e.',buttonOkText:"\u0421\u043e\u0445\u0440\u0430\u043d\u0438\u0442\u044c",buttonCancelText:"\u041e\u0442\u043c\u0435\u043d\u0438\u0442\u044c"}}).afterClosed()}getChangeStatusBody(e,i){return{comment:"comment",created_at:new Date,order_id:e.id,status:i}}openEditApplicationStatusModal(e){return this.dialog.open(un,{...M,data:{application:e,statuses:this.applicationStatuses,statusTranslation:this.getApplicationStatusName(e.last_status),rentPeriod:this.getRentPeriodValue(e)}}).afterClosed()}static#t=this.\u0275fac=function(i){return new(i||n)(t.LFG(T),t.LFG(d.uw),t.LFG(B.yh),t.LFG(X.T),t.LFG(tt.I))};static#e=this.\u0275prov=t.Yz7({token:n,factory:n.\u0275fac})}return n})();const Zn=function(){return[]},Un=[{path:"",redirectTo:$.$.Equipments,pathMatch:"full"},{path:$.$.Equipments,resolve:{equipmentsStatuses:$t,equipmentCategories:Gt},pathMatch:"full",component:V},{path:$.$.Users,pathMatch:"full",component:Sn},{path:$.$.Roles,resolve:{roles:(n,u,e=(0,t.f3M)(Lt))=>e.getRoles()},pathMatch:"full",component:kn},{path:$.$.Applications,pathMatch:"full",resolve:{applicationStatuses:(n,u,e=(0,t.f3M)(Yt))=>e.getApplicationStatusNames()},component:(()=>{class n{get applications$(){return this.controller.applicationsData$}constructor(e){this.controller=e,this.columns=In}ngOnInit(){this.controller.fetchApplications().subscribe(),this.controller.setPageTitle()}editApplication(e){this.controller.editApplication(e)}static#t=this.\u0275fac=function(i){return new(i||n)(t.Y36(Ht))};static#e=this.\u0275cmp=t.Xpm({type:n,selectors:[["lc-applications"]],features:[t._Bn([Ht])],decls:2,vars:6,consts:[[3,"columns","limit","data","action"]],template:function(i,o){1&i&&(t.TgZ(0,"lc-table",0),t.NdJ("action",function(r){return o.editApplication(r)}),t.ALo(1,"async"),t.qZA()),2&i&&t.Q6J("columns",o.columns)("limit",20)("data",t.lcZ(1,3,o.applications$)||t.DdM(5,Zn))},dependencies:[ot,m.Ov],changeDetection:0})}return n})()}];let Rn=(()=>{class n{static#t=this.\u0275fac=function(i){return new(i||n)};static#e=this.\u0275mod=t.oAB({type:n});static#n=this.\u0275inj=t.cJS({providers:[Mn.u],imports:[Ot.Bz.forChild(Un),Ot.Bz]})}return n})();var Qn=s(325),Jn=s(2615);let Ln=(()=>{class n{static#t=this.\u0275fac=function(i){return new(i||n)};static#e=this.\u0275mod=t.oAB({type:n});static#n=this.\u0275inj=t.cJS({providers:[T,yt,$t,Gt,Lt,Yt],imports:[m.ez,Rn,Qn.m,l.UX,Jn.x,Ke]})}return n})()}}]);