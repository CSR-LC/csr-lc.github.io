"use strict";(self.webpackChunklc_fe=self.webpackChunklc_fe||[]).push([[148],{1148:(K,f,s)=>{s.r(f),s.d(f,{ManagementModule:()=>$});var p=s(6814),o=s(6223),c=s(9316),Z=s(4664),C=s(7398),t=s(5879),b=s(9862);let E=(()=>{var u;class i{constructor(e){this.httpClient=e}getEquipmentCategories(){return this.httpClient.get("equipment/categories")}getEquipmentSubCategoryById(e){return this.httpClient.get(`equipment/categories/${e}/subcategories`)}registerEquipment(e){return this.httpClient.post("equipment",e)}getPetKinds(){return this.httpClient.get("pet_kind")}getPetSizes(){return this.httpClient.get("pet_size")}uploadPhoto(e){return this.httpClient.post("equipment/photos",e)}getEquipmentStatuses(){return this.httpClient.get("equipment/statuses")}getAllEquipment(){return this.httpClient.get("equipment?limit=9999")}}return(u=i).\u0275fac=function(e){return new(e||u)(t.LFG(b.eN))},u.\u0275prov=t.Yz7({token:u,factory:u.\u0275fac}),i})();var y=s(9118),D=s(2805);let v=(()=>{var u;class i{constructor(e,n,a,l){this.api=e,this.router=n,this.validationService=a,this.blockUiService=l}getEquipmentCategories(){return this.api.getEquipmentCategories()}getEquipmentSubCategoryById(e){return this.api.getEquipmentSubCategoryById(e)}getPetKinds(){return this.api.getPetKinds()}getPetSizes(){return this.api.getPetSizes()}cancel(){this.router.navigate(["/catalog"])}registerEquipment(e){return this.api.registerEquipment(e)}uploadPhoto(e){const n=new FormData;return n.append("file",e,e.name),this.api.uploadPhoto(n)}getEquipmentStatuses(){return this.api.getEquipmentStatuses()}validateForm(e){this.validationService.validateForm(e)}manageBlockUi(e){if(e)return this.blockUiService.block();this.blockUiService.unBlock()}getAllEquipment(){return this.api.getAllEquipment()}}return(u=i).\u0275fac=function(e){return new(e||u)(t.LFG(E),t.LFG(c.F0),t.LFG(y.R),t.LFG(D.A))},u.\u0275prov=t.Yz7({token:u,factory:u.\u0275fac}),i})();var m=function(u){return u.is="\u0435\u0441\u0442\u044c",u.not="\u043d\u0435\u0442",u}(m||{});class A{constructor(i){this.category=i.category,this.compensationCost=i.compensationCost,this.description=i.description,this.inventoryNumber=i.inventoryNumber,this.location=i.location,this.maximumAmount=i.maximumAmount,this.maximumDays=i.maximumDays,this.name=i.name,this.petKinds=i.petKinds,this.petSize=i.petSize,this.photoID=i.photoID,this.receiptDate=this.getDate(i.receiptDate),this.status=i.status,this.supplier=i.supplier,this.technicalIssues=i.technicalIssues===m.is,this.termsOfUse=i.termsOfUse,this.title=i.title,i.subCategory&&(this.subCategory=i.subCategory),i.condition&&(this.condition=i.condition),i.nameSubstring&&(this.nameSubstring=i.nameSubstring)}getDate(i){return`${this.addZero(i.getDate())}.${this.addZero(i.getMonth()+1)}.${i.getFullYear()}`}addZero(i){return i<10?`0${i}`:`${i}`}}var g=function(u){return u.EquipmentFormInvalid="\u0420\u0435\u0433\u0438\u0441\u0442\u0440\u0430\u0446\u0438\u044f \u043d\u043e\u0432\u043e\u0433\u043e \u043e\u0431\u043e\u0440\u0443\u0434\u043e\u0432\u0430\u043d\u0438\u044f \u043d\u0435\u0432\u043e\u0437\u043c\u043e\u0436\u043d\u0430. \u041d\u0435\u043e\u0431\u0445\u043e\u0434\u0438\u043c\u043e \u0437\u0430\u043f\u043e\u043b\u043d\u0438\u0442\u044c \u0432\u0441\u0435 \u043e\u0431\u044f\u0437\u0430\u0442\u0435\u043b\u044c\u043d\u044b\u0435 \u043f\u043e\u043b\u044f.",u.InventoryNumberExistst="\u041e\u0431\u043e\u0440\u0443\u0434\u043e\u0432\u0430\u043d\u0438\u0435 \u0441 \u0442\u0430\u043a\u0438\u043c \u0438\u043d\u0432\u0435\u043d\u0442\u0430\u0440\u043d\u044b\u043c \u043d\u043e\u043c\u0435\u0440\u043e\u043c \u0443\u0436\u0435 \u0441\u0443\u0449\u0435\u0441\u0442\u0432\u0443\u0435\u0442. \u0414\u043b\u044f \u043f\u0440\u043e\u0434\u043e\u043b\u0436\u0435\u043d\u0438\u044f \u0440\u0435\u0433\u0438\u0441\u0442\u0440\u0430\u0446\u0438\u0438 \u043d\u0435\u043e\u0431\u0445\u043e\u0434\u0438\u043c\u043e \u0432\u0432\u0435\u0441\u0442\u0438 \u0434\u0440\u0443\u0433\u043e\u0439 \u0438\u043d\u0432\u0435\u043d\u0442\u0430\u0440\u043d\u044b\u0439 \u043d\u043e\u043c\u0435\u0440.",u}(g||{}),q=function(u){return u.EquipmentAdded="\u041e\u0431\u043e\u0440\u0443\u0434\u043e\u0432\u0430\u043d\u0438\u0435 \u0437\u0430\u0440\u0435\u0433\u0438\u0441\u0442\u0440\u0438\u0440\u043e\u0432\u0430\u043d\u043e \u0443\u0441\u043f\u0435\u0448\u043d\u043e",u}(q||{}),I=s(7626),F=s(5659),S=s(2296),d=s(8034),N=s(2032),h=s(4170),x=s(8525),U=s(3680);const _=["photoInput"];function k(u,i){if(1&u&&(t.TgZ(0,"mat-option",34),t._uU(1),t.qZA()),2&u){const r=i.$implicit;t.Q6J("value",r.id),t.xp6(1),t.Oqu(r.name)}}function T(u,i){if(1&u&&(t.TgZ(0,"mat-option",34),t._uU(1),t.qZA()),2&u){const r=i.$implicit;t.Q6J("value",r.id),t.xp6(1),t.Oqu(r.name)}}function O(u,i){if(1&u&&(t.TgZ(0,"mat-option",34),t._uU(1),t.qZA()),2&u){const r=i.$implicit;t.Q6J("value",r),t.xp6(1),t.Oqu(r)}}function P(u,i){if(1&u&&(t.TgZ(0,"mat-option",34),t._uU(1),t.qZA()),2&u){const r=i.$implicit;t.Q6J("value",r.id),t.xp6(1),t.hij(" ",r.name," ")}}function R(u,i){if(1&u&&(t.TgZ(0,"mat-option",34),t._uU(1),t.qZA()),2&u){const r=i.$implicit;t.Q6J("value",r.id),t.xp6(1),t.Oqu(r.name)}}const M=function(u){return{"registration-form-submitted":u}};let B=(()=>{var u;class i{constructor(e,n,a,l){this.cdr=e,this.formBuilder=n,this.controller=a,this.notificationsService=l,this.equipmentCategories$=this.getEquipmentCategories(),this.petKinds$=this.getPetKinds(),this.petSize$=this.getPetSize(),this.subcategoryOptions=[],this.technicalIssuesOptions=[m.is,m.not],this.maxInventoryNumberValue=1e50,this.maxCompensationCost=9999999999,this.inventoryNumbers=[],this.isFormSubmitted=!1,this.equipmentRegistrationForm=this.formBuilder.group({category:[null,o.kI.required],subCategory:[{value:null,disabled:!0},o.kI.min(0)],compensationCost:[null,[o.kI.required,o.kI.max(this.maxCompensationCost)]],condition:[{value:null,disabled:!0},o.kI.maxLength(1e3)],description:["",o.kI.required],inventoryNumber:[null,[o.kI.required,o.kI.max(this.maxInventoryNumberValue)]],location:[1,o.kI.required],maximumAmount:[null,[o.kI.required,o.kI.min(1)]],maximumDays:[null,[o.kI.required,o.kI.min(1)]],name:["",o.kI.required],nameSubstring:[""],petKinds:[[null],o.kI.required],petSize:[null,o.kI.required],photoID:[null,o.kI.required],receiptDate:["",o.kI.required],status:[1,o.kI.required],supplier:["",[o.kI.required,o.kI.maxLength(50)]],technicalIssues:[null,[o.kI.required]],termsOfUse:["",[o.kI.required,o.kI.maxLength(249)]],title:["",[o.kI.required,o.kI.maxLength(49)]]})}ngOnInit(){this.subCategoryControl=this.equipmentRegistrationForm.get("subCategory"),this.conditionControl=this.equipmentRegistrationForm.get("condition"),this.photoIdControl=this.equipmentRegistrationForm.get("photoID"),this.inventoryNumberControl=this.equipmentRegistrationForm.get("inventoryNumber"),this.getEquipmentInventoryNumbers()}ngOnDestroy(){this.equipmentRegistrationForm.reset()}disableKeyboardInput(e,n){if("Backspace"===e.key)return;const a=this.equipmentRegistrationForm.get(n);return!(a?.errors&&(a.errors.maxlength||a.errors.max))}setSubcategoryDisabledState(e){this.controller.getEquipmentSubCategoryById(e).subscribe(n=>{this.setControlState(!!n.length,this.subCategoryControl),this.subcategoryOptions=n})}setConditionState(e){this.setControlState(e===m.is,this.conditionControl)}onCancel(){this.controller.cancel()}onSubmit(){if(this.controller.validateForm(this.equipmentRegistrationForm),!this.file||this.equipmentRegistrationForm.invalid)return void this.notificationsService.openError(g.EquipmentFormInvalid);const e=this.equipmentRegistrationForm.value.inventoryNumber;if(this.inventoryNumbers.includes(e))return this.inventoryNumberControl?.setErrors({incorrectInventoryNumber:!0}),void this.notificationsService.openError(g.InventoryNumberExistst);this.controller.manageBlockUi(!0),this.controller.uploadPhoto(this.file).pipe((0,Z.w)(n=>{const a=new A(this.equipmentRegistrationForm.value);return a.photoID=n.data.id,this.controller.registerEquipment(a)})).subscribe(()=>{this.controller.manageBlockUi(!1),this.notificationsService.openSuccess(q.EquipmentAdded),this.inventoryNumbers.push(e)})}choosePhoto(){this.photoInput?.nativeElement.click()}addPhoto(e){let n=e.target;this.file=n?.files?.length?n.files[0]:void 0,this.file&&this.photoIdControl?.setValue(this.file.name)}preventDefault(e){e.preventDefault()}setControlState(e,n){e?n?.enable():(n?.disable(),n?.setValue(null)),n?.setValidators(e?o.kI.required:null)}getEquipmentCategories(){return this.controller.getEquipmentCategories().pipe((0,C.U)(e=>e.items))}getPetKinds(){return this.controller.getPetKinds()}getPetSize(){return this.controller.getPetSizes()}getEquipmentInventoryNumbers(){this.controller.getAllEquipment().pipe((0,C.U)(e=>e.items.map(n=>n.inventoryNumber))).subscribe(e=>this.inventoryNumbers=e)}}return(u=i).\u0275fac=function(e){return new(e||u)(t.Y36(t.sBO),t.Y36(o.QS),t.Y36(v),t.Y36(I.T))},u.\u0275cmp=t.Xpm({type:u,selectors:[["lc-equipment"]],viewQuery:function(e,n){if(1&e&&t.Gf(_,5),2&e){let a;t.iGM(a=t.CRH())&&(n.photoInput=a.first)}},features:[t._Bn([v])],decls:107,vars:19,consts:[[1,"registration-form",3,"formGroup","ngClass"],[1,"registration-form-field"],["formControlName","category","lcValidationErrors","",3,"valueChange"],[3,"value",4,"ngFor","ngForOf"],["formControlName","subCategory","lcValidationErrors",""],["appearance","fill","floatLabel","auto"],["matInput","","type","number","formControlName","compensationCost","lcValidationErrors",""],["appearance","fill"],["formControlName","technicalIssues","lcValidationErrors","",3,"valueChange"],["matInput","","formControlName","condition",3,"maxlength"],["matInput","","type","number","formControlName","inventoryNumber","lcValidationErrors","",3,"max"],["matInput","","formControlName","supplier","lcValidationErrors",""],["appearance","fill",1,"registration-form-field-input"],["matInput","","formControlName","receiptDate","lcValidationErrors","",3,"matDatepicker"],["matSuffix","",3,"for"],["picker",""],["matInput","","type","url","formControlName","termsOfUse","lcValidationErrors",""],["matInput","","formControlName","name","lcValidationErrors",""],["matInput","","formControlName","title","lcValidationErrors",""],["appearance","fill",1,"example-full-width"],["matInput","","formControlName","description","lcValidationErrors",""],["formControlName","petKinds","multiple","","lcValidationErrors",""],["formControlName","petSize","lcValidationErrors",""],["matInput","","type","number","formControlName","maximumAmount","lcValidationErrors",""],["matInput","","type","number","formControlName","maximumDays","lcValidationErrors",""],[1,"registration-form-field","photo-field"],["type","button","mat-raised-button","",1,"registration-controls-button",3,"click"],["matInput","","formControlName","photoID","type","text",3,"keydown"],[1,"hidden"],["type","file",1,"registration-form-field-input",3,"change"],["photoInput",""],[1,"registration-actions"],["mat-raised-button","","color","primary",1,"registration-controls-button",3,"click"],["mat-raised-button","","color","accent",1,"registration-controls-button",3,"click"],[3,"value"]],template:function(e,n){if(1&e&&(t.TgZ(0,"form",0)(1,"div",1)(2,"mat-form-field")(3,"mat-label"),t._uU(4,"\u041a\u0430\u0442\u0435\u0433\u043e\u0440\u0438\u044f"),t.qZA(),t.TgZ(5,"mat-select",2),t.NdJ("valueChange",function(l){return n.setSubcategoryDisabledState(l)}),t.YNc(6,k,2,2,"mat-option",3),t.ALo(7,"async"),t.qZA()()(),t.TgZ(8,"div",1)(9,"mat-form-field")(10,"mat-label"),t._uU(11,"\u041f\u043e\u0434\u043a\u0430\u0442\u0435\u0433\u043e\u0440\u0438\u044f"),t.qZA(),t.TgZ(12,"mat-select",4),t.YNc(13,T,2,2,"mat-option",3),t.qZA()()(),t.TgZ(14,"div",1)(15,"mat-form-field",5)(16,"mat-label"),t._uU(17,"\u0421\u0442\u043e\u0438\u043c\u043e\u0441\u0442\u044c \u043a\u043e\u043c\u043f\u0435\u043d\u0441\u0430\u0446\u0438\u0438 \u0432 \u0441\u043b\u0443\u0447\u0430\u0435 \u0443\u0442\u0440\u0430\u0442\u044b/\u043f\u043e\u0440\u0447\u0438, \u0440\u0443\u0431."),t.qZA(),t._UZ(18,"input",6),t.qZA()(),t.TgZ(19,"div",1)(20,"mat-form-field",7)(21,"mat-label"),t._uU(22,"\u0422\u0435\u0445\u043d\u0438\u0447\u0435\u0441\u043a\u0438\u0435 \u041e\u0441\u043e\u0441\u0431\u0435\u043d\u043d\u043e\u0441\u0442\u0438"),t.qZA(),t.TgZ(23,"mat-select",8),t.NdJ("valueChange",function(l){return n.setConditionState(l)}),t.YNc(24,O,2,2,"mat-option",3),t.qZA()()(),t.TgZ(25,"div",1)(26,"mat-form-field",5)(27,"mat-label"),t._uU(28,"\u0421\u043e\u0441\u0442\u043e\u044f\u043d\u0438\u0435 \u0438\u0441\u043f\u0440\u0430\u0432\u043d\u043e\u0441\u0442\u0438"),t.qZA(),t._UZ(29,"textarea",9),t.qZA()(),t.TgZ(30,"div",1)(31,"mat-form-field",5)(32,"mat-label"),t._uU(33,"\u0418\u043d\u0432\u0435\u043d\u0442\u0430\u0440\u043d\u044b\u0439 \u043d\u043e\u043c\u0435\u0440"),t.qZA(),t._UZ(34,"input",10),t.qZA()(),t.TgZ(35,"div",1)(36,"mat-form-field",5)(37,"mat-label"),t._uU(38,"\u041f\u043e\u0441\u0442\u0430\u0432\u0449\u0438\u043a"),t.qZA(),t._UZ(39,"input",11),t.qZA()(),t.TgZ(40,"div",1)(41,"mat-form-field",12)(42,"mat-label"),t._uU(43,"\u0414\u0430\u0442\u0430 \u043f\u043e\u0441\u0442\u0443\u043f\u043b\u0435\u043d\u0438\u044f \u0432 \u0444\u043e\u043d\u0434"),t.qZA(),t._UZ(44,"input",13)(45,"mat-datepicker-toggle",14)(46,"mat-datepicker",null,15),t.qZA()(),t.TgZ(48,"div",1)(49,"mat-form-field",5)(50,"mat-label"),t._uU(51,"\u0421\u0441\u044b\u043b\u043a\u0430 \u043d\u0430 \u043f\u0440\u0430\u0432\u0438\u043b\u0430 \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u043d\u0438\u044f"),t.qZA(),t._UZ(52,"input",16),t.qZA()(),t.TgZ(53,"div",1)(54,"mat-form-field",5)(55,"mat-label"),t._uU(56,"\u041d\u0430\u0437\u0432\u0430\u043d\u0438\u0435"),t.qZA(),t._UZ(57,"input",17),t.qZA()(),t.TgZ(58,"div",1)(59,"mat-form-field",5)(60,"mat-label"),t._uU(61,"\u041d\u0430\u0438\u043c\u0435\u043d\u043e\u0432\u0430\u043d\u0438\u0435"),t.qZA(),t._UZ(62,"input",18),t.qZA()(),t.TgZ(63,"div",1)(64,"mat-form-field",19)(65,"mat-label"),t._uU(66,"\u041e\u043f\u0438\u0441\u0430\u043d\u0438\u0435"),t.qZA(),t._UZ(67,"textarea",20),t.qZA()(),t.TgZ(68,"div",1)(69,"mat-form-field",5)(70,"mat-label"),t._uU(71,"\u0416\u0438\u0432\u043e\u0442\u043d\u043e\u0435"),t.qZA(),t.TgZ(72,"mat-select",21),t.YNc(73,P,2,2,"mat-option",3),t.ALo(74,"async"),t.qZA()()(),t.TgZ(75,"div",1)(76,"mat-form-field",7)(77,"mat-label"),t._uU(78,"\u0420a\u0437\u043c\u0435\u0440 \u0436\u0438\u0432\u043e\u0442\u043d\u043e\u0433\u043e"),t.qZA(),t.TgZ(79,"mat-select",22),t.YNc(80,R,2,2,"mat-option",3),t.ALo(81,"async"),t.qZA()()(),t.TgZ(82,"div",1)(83,"mat-form-field")(84,"mat-label"),t._uU(85,"\u0412 \u0440\u0443\u043a\u0438, \u0434\u043e (\u0448\u0442\u0443\u043a)"),t.qZA(),t._UZ(86,"input",23),t.qZA()(),t.TgZ(87,"div",1)(88,"mat-form-field")(89,"mat-label"),t._uU(90,"\u0421\u0440\u043e\u043a, \u0434\u043e (\u0441\u0443\u0442\u043e\u043a)"),t.qZA(),t._UZ(91,"input",24),t.qZA()(),t.TgZ(92,"div",25)(93,"button",26),t.NdJ("click",function(){return n.choosePhoto()}),t._uU(94,"\u043f\u0440\u0438\u043a\u0440\u0435\u043f\u0438\u0442\u044c \u0444\u043e\u0442\u043e"),t.qZA(),t.TgZ(95,"mat-form-field")(96,"mat-label"),t._uU(97,"\u0424\u043e\u0442\u043e \u043e\u0431\u043e\u0440\u0443\u0434\u043e\u0432\u0430\u043d\u0438\u044f"),t.qZA(),t.TgZ(98,"input",27),t.NdJ("keydown",function(l){return n.preventDefault(l)}),t.qZA()()(),t.TgZ(99,"div",28)(100,"input",29,30),t.NdJ("change",function(l){return n.addPhoto(l)}),t.qZA()(),t.TgZ(102,"div",31)(103,"button",32),t.NdJ("click",function(){return n.onSubmit()}),t._uU(104,"\u0417\u0430\u0440\u0435\u0433\u0438\u0441\u0442\u0440\u0438\u0440\u043e\u0432\u0430\u0442\u044c"),t.qZA(),t.TgZ(105,"button",33),t.NdJ("click",function(){return n.onCancel()}),t._uU(106,"\u041e\u0442\u043c\u0435\u043d\u0430"),t.qZA()()()),2&e){const a=t.MAs(47);t.Q6J("formGroup",n.equipmentRegistrationForm)("ngClass",t.VKq(17,M,n.isFormSubmitted)),t.xp6(6),t.Q6J("ngForOf",t.lcZ(7,11,n.equipmentCategories$)),t.xp6(7),t.Q6J("ngForOf",n.subcategoryOptions),t.xp6(11),t.Q6J("ngForOf",n.technicalIssuesOptions),t.xp6(5),t.Q6J("maxlength",1e3),t.xp6(5),t.Q6J("max",n.maxInventoryNumberValue),t.xp6(10),t.Q6J("matDatepicker",a),t.xp6(1),t.Q6J("for",a),t.xp6(28),t.Q6J("ngForOf",t.lcZ(74,13,n.petKinds$)),t.xp6(7),t.Q6J("ngForOf",t.lcZ(81,15,n.petSize$))}},dependencies:[p.mk,p.sg,o._Y,o.Fj,o.wV,o.JJ,o.JL,o.nD,o.Fd,o.sg,o.u,F.D,S.lW,d.Mq,d.hl,d.nW,N.Nt,h.KE,h.hX,h.R9,x.gD,U.ey,p.Ov],styles:["[_nghost-%COMP%]{display:block}.registration-form[_ngcontent-%COMP%]{display:flex;flex-direction:column;max-width:844px;margin:auto;padding-right:25px;padding-left:25px}.registration-form-field[_ngcontent-%COMP%]{margin-top:16px}.registration-form-field[_ngcontent-%COMP%]   mat-form-field[_ngcontent-%COMP%]{width:100%}.registration-form[_ngcontent-%COMP%]   .photo-field[_ngcontent-%COMP%]{display:flex;align-items:center;flex-direction:row}.registration-form[_ngcontent-%COMP%]   .photo-field[_ngcontent-%COMP%]   .registration-controls-button[_ngcontent-%COMP%]{width:200px;height:40px;margin-right:20px}.registration-actions[_ngcontent-%COMP%]{display:flex;padding-top:24px;padding-bottom:24px}.registration-actions[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{flex-basis:calc(50% - 8px)}.registration-actions[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]:first-of-type{margin-right:16px}.hidden[_ngcontent-%COMP%]{display:none}"],changeDetection:0}),i})();const V=[{path:s(4614).$.EquipmentRegistration,component:B}];let z=(()=>{var u;class i{}return(u=i).\u0275fac=function(e){return new(e||u)},u.\u0275mod=t.oAB({type:u}),u.\u0275inj=t.cJS({imports:[c.Bz.forChild(V),c.Bz]}),i})();var Q=s(325);let $=(()=>{var u;class i{}return(u=i).\u0275fac=function(e){return new(e||u)},u.\u0275mod=t.oAB({type:u}),u.\u0275inj=t.cJS({providers:[E],imports:[p.ez,z,o.UX,Q.m]}),i})()}}]);