import{$ as ve,A as lt,Ab as Ie,Ac as Re,B as ut,Bb as Tt,Bc as Ue,Cb as it,Cc as wt,Db as Nt,Dc as Fe,Ec as je,Fc as Le,Gb as Dt,Gc as $e,Hc as Ge,Ib as Jt,J as o,Ja as L,Jb as nt,Jc as yt,K as g,Kb as G,Lb as B,Lc as Vt,Mb as ot,Mc as Zt,N as E,O as l,Ob as Bt,Pa as kt,Pb as bt,Pc as _t,Q as r,Qc as He,R as s,Rb as Ae,Rc as ze,S as b,T as v,Ta as ht,U as C,Ua as w,V as At,W as k,Wb as ke,X as x,Xb as Te,Y as Yt,Ya as D,Yb as xt,Za as K,_ as ge,a as N,aa as Ce,b as H,ba as P,ca as u,d as pt,da as h,e as de,ea as y,f as F,fa as S,fb as W,g as dt,gb as V,hb as J,i as z,ib as $,j as fe,jb as gt,jc as Ne,k as O,kb as c,kc as Be,lb as X,ma as Ee,mb as Z,mc as qe,na as be,nb as vt,nc as q,o as he,ob as De,oc as Oe,p as f,pb as tt,q as j,qb as et,qc as qt,rb as Se,rc as Pe,t as I,ta as ft,tb as Ct,tc as T,ua as A,ub as Me,uc as Ot,va as xe,vc as Xt,w as d,wa as ye,wc as Pt,y as _,ya as Wt,yb as R,yc as we,za as _e,zb as Et,zc as Ve}from"./chunk-LUI5EWE7.js";var U=(()=>{class n{static{this.USERS_BASE_URL="v1/users"}static{this.ROLES_BASE_URL="v1/roles"}static{this.MANAGEMENT_BASE_URL="v1/management"}constructor(t){this.http=t}getAllEquipment(){let t=new Wt().set("limit",0);return this.http.get("equipment",{params:t})}getUnavailablePeriodsById(t){return this.http.get(`/equipment/unavailability_periods/${t}`)}archiveEquipment(t){return this.http.post(`/equipment/achive/${t}/`,{equipmentId:t})}blockEquipment(t,i){let a={end_date:i.endDate,start_date:i.startDate};return this.http.post(`/equipment/${t}/blocking`,a)}unblockEquipment(t){return this.http.post(`/equipment/${t}/unblocking`,{})}uploadPhoto(t){let i=new FormData;return i.append("file",t,t.name),this.http.post("equipment/photos",i)}registerEquipment(t){return this.http.post("equipment",t)}editEquipment(t,i){return this.http.put(`equipment/${i}`,t)}getEquipmentStatuses(){return this.http.get("/equipment/status_names")}getEquipmentCategories(){return this.http.get("/equipment/categories")}getEquipmentUnavailabilityPeriods(t){return this.http.get(`/equipment/unavailability_periods/${t}`)}getAllUsers(){return this.http.get(n.USERS_BASE_URL)}updateUserReadonlyAccess(t,i){let a={is_readonly:i};return this.http.put(`${n.USERS_BASE_URL}/${t}/readonly-access`,a)}deleteUser(t){return this.http.delete(`${n.USERS_BASE_URL}/${t}`)}getAllRoles(){return this.http.get(n.ROLES_BASE_URL)}assignRoleToUser(t,i){let a={roleId:i};return this.http.post(`${n.MANAGEMENT_BASE_URL}/users/${t}/role`,a)}getAllOrders(t){let i=new Wt().set("limit",0).set(Pt.equipmentId,t||"");return this.http.get("/management/orders",{params:i})}getApplicationStatuses(){return this.http.get("v1/status_names")}editApplicationStatus(t){return this.http.post("v1/order_statuses/",t)}static{this.\u0275fac=function(i){return new(i||n)(d(_e))}}static{this.\u0275prov=I({token:n,factory:n.\u0275fac,providedIn:"root"})}}return n})();var ui=(()=>{class n{constructor(t,i){this.api=t,this.store=i}getRoles(){return this.api.getAllRoles().pipe(f(t=>this.store.dispatch(new ke(t))),z(()=>this.store.selectSnapshot(xt.roles)||[]))}static{this.\u0275fac=function(i){return new(i||n)(d(U),d(L))}}static{this.\u0275prov=I({token:n,factory:n.\u0275fac})}}return n})();function ci(n,e){if(n&1&&b(0,"lc-fake-input",1),n&2){let t=x();l("label",t.LabelEnum.Name)("text",t.equipment.name)}}function pi(n,e){if(n&1&&b(0,"lc-fake-input",1),n&2){let t=x();l("label",t.LabelEnum.NameSubstring)("text",t.equipment.title)}}function di(n,e){if(n&1&&b(0,"lc-fake-input",1),n&2){let t=x();l("label",t.LabelEnum.InventoryNumber)("text",t.equipment.inventoryNumber)}}var Ut=(()=>{class n{constructor(){this.LabelEnum=qt}static{this.\u0275fac=function(i){return new(i||n)}}static{this.\u0275cmp=_({type:n,selectors:[["lc-equipment-info"]],inputs:{equipment:"equipment"},decls:3,vars:3,consts:[[3,"label","text",4,"ngIf"],[3,"label","text"]],template:function(i,a){i&1&&E(0,ci,1,2,"lc-fake-input",0)(1,pi,1,2,"lc-fake-input",0)(2,di,1,2,"lc-fake-input",0),i&2&&(l("ngIf",a.equipment&&a.equipment.name),o(),l("ngIf",a.equipment&&a.equipment.title),o(),l("ngIf",a.equipment&&a.equipment.inventoryNumber))},dependencies:[A,Vt],styles:["lc-fake-input[_ngcontent-%COMP%]{margin-bottom:24px}lc-fake-input[_ngcontent-%COMP%]:last-child{margin-bottom:0}"],changeDetection:0})}}return n})();var Qe=(()=>{class n{constructor(t){this.equipment=t,this.ModalEnum=q,this.inventoryNumber=String(this.equipment.inventoryNumber)}static{this.\u0275fac=function(i){return new(i||n)(g(V))}}static{this.\u0275cmp=_({type:n,selectors:[["lc-archive-equipment-modal"]],decls:12,vars:4,consts:[["headerTitle","\u0410\u0440\u0445\u0438\u0432\u0438\u0440\u043E\u0432\u0430\u043D\u0438\u0435 \u043E\u0431\u043E\u0440\u0443\u0434\u043E\u0432\u0430\u043D\u0438\u044F"],["body",""],[1,"content"],[3,"equipment"],["footer",""],[1,"buttons"],["mat-button","",1,"cancel",3,"mat-dialog-close"],["mat-raised-button","","color","primary",3,"mat-dialog-close"]],template:function(i,a){i&1&&(r(0,"lc-modal-layout",0),v(1,1),r(2,"div",2)(3,"p"),u(4," \u0421\u0442\u0430\u0442\u0443\u0441 \u043E\u0431\u043E\u0440\u0443\u0434\u043E\u0432\u0430\u043D\u0438\u0435 \u0438\u0437\u043C\u0435\u043D\u0438\u0442\u044C\u0441\u044F \u043D\u0430 \u201C\u0412 \u0430\u0440\u0445\u0438\u0432\u0435\u201D \u0438 \u0441\u043A\u0440\u043E\u0435\u0442\u0441\u044F \u0438\u0437 \u043E\u0431\u0449\u0435\u0433\u043E \u0441\u043F\u0438\u0441\u043A\u0430 \u043E\u0431\u043E\u0440\u0443\u0434\u043E\u0432\u0430\u043D\u0438\u044F. \u041F\u0440\u043E\u0432\u0435\u0440\u044C\u0442\u0435 \u0434\u0430\u043D\u043D\u044B\u0435. "),s(),b(5,"lc-equipment-info",3),s(),C(),v(6,4),r(7,"div",5)(8,"button",6),u(9," \u041E\u0442\u043C\u0435\u043D\u0438\u0442\u044C "),s(),r(10,"button",7),u(11),s()(),C(),s()),i&2&&(o(5),l("equipment",a.equipment),o(3),l("mat-dialog-close",!1),o(2),l("mat-dialog-close",!0),o(),y(" ",a.ModalEnum.ArchiveApplyButtonText," "))},dependencies:[R,w,$,Ut],styles:[".content[_ngcontent-%COMP%]{font-style:normal;font-weight:400;font-size:14px;line-height:24px;letter-spacing:.1px;color:#000}.content[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin-bottom:24px}.buttons[_ngcontent-%COMP%]{display:flex;justify-content:flex-end;align-items:center}.buttons[_ngcontent-%COMP%]   .cancel[_ngcontent-%COMP%]{margin-right:24px;font-style:normal;font-weight:500;color:#00677f}.buttons[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{height:56px;border-radius:10px;font-style:normal;font-weight:400;line-height:20px;padding:16px;text-transform:uppercase}"],changeDetection:0})}}return n})();function hi(n,e){if(n&1&&(r(0,"button",13),u(1),s()),n&2){let t=x();l("mat-dialog-close","unblock equipment"),o(),y(" ",t.ModalEnum.BlockCancelButtonText," ")}}var Ft=class te{constructor(e,t,i,a,p){this.dialogData=e,this.dialogRef=t,this.fb=i,this.validationService=a,this.dateRangeService=p,this.formName="block_equipment_modal",this.unavailablePeriods=[],this.ModalEnum=q,this.LabelEnum=qt,this.minDate=null,this.form=this.fb.group({startDate:[null,[c.required,this.validationService.getControlChangedValidator()]],endDate:[null,[c.required,this.validationService.getControlChangedValidator()]]})}ngOnInit(){this.equipment=this.dialogData.equipment,this.unavailablePeriods=this.dialogData.unavailablePeriods,this.minDate=new Date,this.setInitialFormValue(this.equipment)}setInitialFormValue(e){if(!e?.blockingPeriods?.length)return;let t=e.blockingPeriods[0];this.form.setValue({startDate:new Date(t.start_date),endDate:new Date(t.end_date)})}blockEquipment(){this.validationService.emitSubmit(this.formName),this.form.valid&&this.dialogRef.close(this.form.getRawValue())}openDatePicker(){this.dateRangeService.openDateRangeModal(this.dateRangeConfig).pipe(B(this)).subscribe(e=>{e&&this.setFormValue({startDate:new Date(e.start_date),endDate:new Date(e.end_date)})})}setFormValue(e){this.form.markAllAsTouched(),this.form.markAsDirty();for(let t in this.form.controls){let i=this.form.controls[t];i?.markAllAsTouched(),i?.markAsDirty()}this.form.setValue(e)}get dateRangeConfig(){return{headerText:"\u0412\u044B\u0431\u0435\u0440\u0438\u0442\u0435 \u043F\u0435\u0440\u0438\u043E\u0434 \u0431\u043B\u043E\u043A\u0438\u0440\u043E\u0432\u043A\u0438",buttonText:"\u0412\u044B\u0431\u0440\u0430\u0442\u044C",maxRentalPeriod:14,unavailableDates:this.unavailablePeriods,purpose:we.block,selectedPeriod:this.blockPeriodForModal}}get blockPeriodForModal(){let e=this.form.value;if(!(!e.endDate||!e.startDate))return new Ve(new Date(e.startDate),new Date(e.endDate))}static{this.\u0275fac=function(t){return new(t||te)(g(V),g(W),g(Me),g(nt),g($e))}}static{this.\u0275cmp=_({type:te,selectors:[["lc-block-equipment-modal"]],decls:17,vars:8,consts:[[3,"headerTitle"],["body",""],[3,"equipment"],[3,"formGroup"],[3,"min"],["matStartDate","","formControlName","startDate","placeholder","\u041D\u0430\u0447\u0430\u043B\u043E",3,"lcValidationErrors"],["matEndDate","","formControlName","endDate","placeholder","\u041A\u043E\u043D\u0435\u0446",3,"lcValidationErrors"],["matIconSuffix","",3,"click"],["footer",""],[1,"buttons-wrapper"],[1,"buttons"],["mat-button","","class","cancel",3,"mat-dialog-close",4,"ngIf"],["mat-raised-button","","color","primary",3,"click"],["mat-button","",1,"cancel",3,"mat-dialog-close"]],template:function(t,i){t&1&&(r(0,"lc-modal-layout",0),v(1,1),b(2,"lc-equipment-info",2),r(3,"form",3)(4,"mat-form-field")(5,"mat-label"),u(6,"\u041F\u0435\u0440\u0438\u043E\u0434 \u0431\u043B\u043E\u043A\u0438\u0440\u043E\u0432\u043A\u0438"),s(),r(7,"mat-date-range-input",4),b(8,"input",5)(9,"input",6),s(),r(10,"mat-datepicker-toggle",7),k("click",function(){return i.openDatePicker()}),s()()(),C(),v(11,8),r(12,"div",9)(13,"div",10),E(14,hi,2,2,"button",11),r(15,"button",12),k("click",function(){return i.blockEquipment()}),u(16),s()()(),C(),s()),t&2&&(l("headerTitle",i.ModalEnum.BlockTitle),o(2),l("equipment",i.equipment),o(),l("formGroup",i.form),o(4),l("min",i.minDate),o(),l("lcValidationErrors",i.formName),o(),l("lcValidationErrors",i.formName),o(5),l("ngIf",i.equipment==null?null:i.equipment.blockingPeriods),o(2),y(" ",i.equipment!=null&&i.equipment.blockingPeriods?i.ModalEnum.EditEquipmentModalButtonText:i.ModalEnum.BlockApplyButtonText," "))},dependencies:[A,R,ot,w,wt,Le,Fe,je,$,it,Et,Tt,vt,gt,X,Z,tt,et,Ut],styles:["[_nghost-%COMP%]{display:block}form[_ngcontent-%COMP%]{margin-top:24px}form[_ngcontent-%COMP%]   mat-form-field[_ngcontent-%COMP%]{width:100%}form[_ngcontent-%COMP%]   .date[_ngcontent-%COMP%]{max-width:200px}.buttons[_ngcontent-%COMP%]{display:flex;justify-content:flex-end;align-items:center}.buttons[_ngcontent-%COMP%]   .cancel[_ngcontent-%COMP%]{font-style:normal;font-weight:500;color:#00677f}.buttons[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{font-style:normal;font-weight:400;margin-right:24px;line-height:20px;text-transform:uppercase;height:56px;border-radius:10px}.buttons[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]:last-child{margin-right:0}"],changeDetection:0})}};Ft=F([G],Ft);function vi(n,e){n&1&&(v(0),u(1," \u0412 \u044D\u0442\u0438 \u0434\u0430\u0442\u044B \u043E\u0431\u043E\u0440\u0443\u0434\u043E\u0432\u0430\u043D\u0438\u0435 \u0437\u0430\u0431\u0440\u043E\u043D\u0438\u0440\u043E\u0432\u0430\u043D\u043E. \u0411\u043B\u043E\u043A\u0438\u0440\u043E\u0432\u043A\u0430 \u0441\u0431\u0440\u043E\u0441\u0438\u0442 \u0434\u0430\u043D\u043D\u043E\u0435 \u0431\u0440\u043E\u043D\u0438\u0440\u043E\u0432\u0430\u043D\u0438\u0435. "),C())}function Ci(n,e){n&1&&(v(0),u(1," \u0410\u0440\u0445\u0438\u0432\u0438\u0440\u043E\u0432\u0430\u043D\u0438\u0435 \u0441\u0431\u0440\u043E\u0441\u0438\u0442 \u0432\u0441\u0435 \u0431\u0440\u043E\u043D\u0438\u0440\u043E\u0432\u0430\u043D\u0438\u044F \u0434\u0430\u043D\u043D\u043E\u0433\u043E \u043E\u0431\u043E\u0440\u0443\u0434\u043E\u0432\u0430\u043D\u0438\u044F. "),C())}var Ye=(()=>{class n{constructor(t){this.action=t,this.actions=D,this.header="",this.actionText=""}ngOnInit(){switch(this.action){case this.actions.Block:this.header=q.BlockTitle,this.actionText=q.BlockApplyButtonText;break;case this.actions.Archivate:this.header=q.ArchiveTitle,this.actionText=q.ArchiveApplyButtonText;break}}static{this.\u0275fac=function(i){return new(i||n)(g(V))}}static{this.\u0275cmp=_({type:n,selectors:[["lc-order-notification-modal"]],decls:17,vars:6,consts:[[3,"headerTitle"],["body",""],[1,"content"],[4,"ngIf"],["fontSet","material-icons-outlined"],["footer",""],[1,"buttons"],["mat-button","",1,"cancel",3,"mat-dialog-close"],["mat-raised-button","","color","primary",3,"mat-dialog-close"]],template:function(i,a){i&1&&(r(0,"lc-modal-layout",0),v(1,1),r(2,"div",2)(3,"p"),E(4,vi,2,0,"ng-container",3)(5,Ci,2,0,"ng-container",3),s(),r(6,"p"),u(7," \u0414\u043B\u044F \u043F\u0440\u043E\u0441\u043C\u043E\u0442\u0440\u0430 \u0441\u043F\u0438\u0441\u043A\u0430 \u0437\u0430\u044F\u0432\u043E\u043A \u043D\u0430 \u0434\u0430\u043D\u043D\u043E\u0435 \u043E\u0431\u043E\u0440\u0443\u0434\u043E\u0432\u0430\u043D\u0438\u0435, \u0432\u043E\u0441\u043F\u043E\u043B\u044C\u0437\u0443\u0439\u0442\u0435\u0441\u044C \u043A\u043D\u043E\u043F\u043A\u043E\u0439 "),r(8,"mat-icon",4),u(9,"list_alt"),s(),u(10," \u0432 \u0442\u0430\u0431\u043B\u0438\u0446\u0435 \u043E\u0431\u043E\u0440\u0443\u0434\u043E\u0432\u0430\u043D\u0438\u044F. "),s()(),C(),v(11,5),r(12,"div",6)(13,"button",7),u(14," \u041E\u0442\u043C\u0435\u043D\u0438\u0442\u044C "),s(),r(15,"button",8),u(16),s()(),C(),s()),i&2&&(l("headerTitle",a.header),o(4),l("ngIf",a.action===a.actions.Block),o(),l("ngIf",a.action===a.actions.Archivate),o(8),l("mat-dialog-close",!1),o(2),l("mat-dialog-close",!0),o(),y(" ",a.actionText," "))},dependencies:[A,R,w,$,Bt],styles:["p[_ngcontent-%COMP%]{margin-bottom:0;color:#000000de;font-size:14px;font-weight:400;line-height:22px;letter-spacing:.1px;word-wrap:break-word}mat-icon[_ngcontent-%COMP%]{position:relative;top:8px}.buttons[_ngcontent-%COMP%]{display:flex;justify-content:flex-end;align-items:center}.buttons[_ngcontent-%COMP%]   .cancel[_ngcontent-%COMP%]{margin-right:24px;font-style:normal;font-weight:500;color:#00677f}.buttons[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{height:56px;border-radius:10px;font-style:normal;font-weight:400;line-height:20px;padding:16px;text-transform:uppercase}"],changeDetection:0})}}return n})();var We={available:null,booked:null,"in use":null,"not available":null,archived:null};var Y=function(n){return n.is="\u0435\u0441\u0442\u044C",n.not="\u043D\u0435\u0442",n}(Y||{});var jt=class{constructor(e){this.category=e.category,this.compensationCost=e.compensationCost,this.description=e.description,this.inventoryNumber=e.inventoryNumber,this.location=e.location,this.maximumDays=e.maximumDays,this.name=e.name,this.petKinds=e.petKinds,this.petSize=e.petSize,this.photoID=e.photoID,this.receiptDate=this.getDate(e.receiptDate),this.status=e.status,this.supplier=e.supplier,this.technicalIssues=e.technicalIssues===Y.is,this.termsOfUse=e.termsOfUse,this.title=e.title,this.subCategory=e.subCategory,this.nameSubstring="str",e.condition&&(this.condition=e.condition),e.nameSubstring&&(this.nameSubstring=e.nameSubstring)}getDate(e){return Number(`${e.getTime()}`.slice(0,-3))}};var xi=["photoInput"];function yi(n,e){if(n&1&&(r(0,"mat-option",49),u(1),s()),n&2){let t=e.$implicit;l("value",t.id),o(),h(t.name)}}function _i(n,e){if(n&1&&(r(0,"mat-option",49),u(1),s()),n&2){let t=e.$implicit;l("value",t),o(),h(t)}}function Di(n,e){if(n&1&&(r(0,"mat-option",49),u(1),s()),n&2){let t=e.$implicit;l("value",t.id),o(),y(" ",t.name," ")}}function Si(n,e){if(n&1&&(r(0,"mat-option",49),u(1),s()),n&2){let t=e.$implicit;l("value",t.id),o(),h(t.name)}}function Mi(n,e){if(n&1){let t=At();r(0,"form",17)(1,"div",18)(2,"div",19)(3,"mat-form-field",20)(4,"mat-label"),u(5),s(),b(6,"input",21,0),r(8,"mat-hint",22),u(9),s()(),r(10,"mat-form-field",20)(11,"mat-label"),u(12),s(),b(13,"input",23,1),r(15,"mat-hint",22),u(16),s()()(),r(17,"mat-form-field",24)(18,"mat-label"),u(19),s(),b(20,"textarea",25,2),r(22,"mat-hint",22),u(23),s()()(),r(24,"div",18)(25,"div",19)(26,"mat-form-field",26)(27,"mat-label"),u(28),s(),r(29,"mat-select",27),E(30,yi,2,2,"mat-option",28),s()(),r(31,"mat-form-field",29)(32,"mat-label"),u(33),s(),r(34,"mat-select",30),k("valueChange",function(a){lt(t);let p=x();return ut(p.setConditionState(a))}),E(35,_i,2,2,"mat-option",28),s()()(),r(36,"mat-form-field",31)(37,"mat-label"),u(38),s(),b(39,"textarea",32,3),r(41,"mat-hint",22),u(42),s()()(),r(43,"div",18)(44,"mat-form-field",20)(45,"mat-label"),u(46),s(),b(47,"input",33,4),r(49,"mat-hint",22),u(50),s()(),r(51,"mat-form-field",20)(52,"mat-label"),u(53),s(),b(54,"input",34,5),r(56,"mat-hint",22),u(57),s()()(),r(58,"div",18)(59,"mat-form-field",20)(60,"mat-label"),u(61),s(),b(62,"input",35,6),r(64,"mat-hint",22),u(65),s()(),r(66,"mat-form-field",20)(67,"mat-label"),u(68),s(),b(69,"input",36,7),r(71,"mat-hint",22),u(72),s()()(),r(73,"div",18)(74,"mat-form-field",20)(75,"mat-label"),u(76),s(),r(77,"mat-select",37),E(78,Di,2,2,"mat-option",28),s()(),r(79,"mat-form-field",29)(80,"mat-label"),u(81),s(),r(82,"mat-select",38),E(83,Si,2,2,"mat-option",28),s()()(),r(84,"div",18)(85,"mat-form-field",26)(86,"mat-label"),u(87),s(),b(88,"input",39),s(),r(89,"mat-form-field",40)(90,"mat-label"),u(91),s(),b(92,"input",41)(93,"mat-datepicker-toggle",42)(94,"mat-datepicker",null,8),s()(),r(96,"div",18)(97,"div",43)(98,"button",44),k("click",function(){lt(t);let a=x();return ut(a.choosePhoto())}),r(99,"mat-icon",45),u(100,"photo_camera"),s(),u(101),s(),r(102,"mat-form-field")(103,"input",46),k("keydown",function(a){lt(t);let p=x();return ut(p.preventDefault(a))}),s()(),r(104,"div",47)(105,"input",48,9),k("change",function(a){lt(t);let p=x();return ut(p.addPhoto(a))}),s()()()()()}if(n&2){let t=P(7),i=P(14),a=P(21),p=P(40),st=P(48),ct=P(55),Qt=P(63),si=P(70),pe=P(95),m=x();l("formGroup",m.form),o(5),h(m.labels.name),o(),l("lcValidationErrors",m.formName),o(3),S("",t.value.length," / ",m.maxValue.name,""),o(3),h(m.labels.title),o(),l("lcValidationErrors",m.formName),o(3),S("",i.value.length," / ",m.maxValue.title,""),o(3),h(m.labels.description),o(),l("lcValidationErrors",m.formName),o(3),S("",a.value.length," / ",m.maxValue.description,""),o(5),h(m.labels.category),o(),l("lcValidationErrors",m.formName),o(),l("ngForOf",m.equipmentCategories),o(3),h(m.labels.technicalIssues),o(),l("lcValidationErrors",m.formName),o(),l("ngForOf",m.technicalIssuesOptions),o(3),h(m.labels.condition),o(),l("lcValidationErrors",m.formName),o(3),S("",p.value.length," / ",m.maxValue.condition,""),o(4),h(m.labels.inventoryNumber),o(),l("max",m.maxInventoryNumber)("lcValidationErrors",m.formName),o(3),S("",st.value.length," / ",m.maxValue.inventoryNumberLength,""),o(3),h(m.labels.compensationCost),o(),l("max",m.maxCompensationCost)("lcValidationErrors",m.formName),o(3),S("",ct.value.length," / ",m.maxValue.compensationCostLength,""),o(4),h(m.labels.supplier),o(),l("lcValidationErrors",m.formName),o(3),S("",Qt.value.length," / ",m.maxValue.supplier,""),o(3),h(m.labels.termsOfUse),o(),l("lcValidationErrors",m.formName),o(3),S("",si.value.length," / ",m.maxValue.termsOfUse,""),o(4),h(m.labels.petKinds),o(),l("lcValidationErrors",m.formName),o(),l("ngForOf",m.petKinds),o(3),h(m.labels.petSize),o(),l("lcValidationErrors",m.formName),o(),l("ngForOf",m.petSizes),o(4),h(m.labels.maximumDays),o(),l("lcValidationErrors",m.formName),o(3),h(m.labels.receiptDate),o(),l("matDatepicker",pe)("lcValidationErrors",m.formName),o(),l("for",pe),o(8),y(" ",m.labels.photoID," "),o(2),l("lcValidationErrors",m.formName)}}var Ze=(()=>{class n{constructor(t,i,a,p,st){this.data=t,this.dialog=i,this.formBuilder=a,this.dialogRef=p,this.validationService=st,this.maxInventoryNumber=1e50,this.labels=qe,this.maxCompensationCost=9999999999,this.formName="equipment_form",this.inventoryNumberErrorOptions={message:"\u0418\u043D\u0432\u0435\u043D\u0442\u0430\u0440\u043D\u044B\u0439 \u043D\u043E\u043C\u0435\u0440 \u0443\u0436\u0435 \u0441\u0443\u0449\u0435\u0441\u0442\u0432\u0443\u0435\u0442"},this.maxValue={condition:1e3,compensationCost:9999999999,compensationCostLength:String(9999999999).length,description:500,inventoryNumber:1e50,inventoryNumberLength:50,maximumDays:14,supplier:50,termsOfUse:250,title:150,name:150},this.minValue={maximumDays:1},this.conditionValidators=[c.required,c.maxLength(this.maxValue.condition)],this.technicalIssuesOptions=[Y.is,Y.not],this.equipmentCategories=[],this.petKinds=[],this.petSizes=[],this.modalHeader="",this.actionButtonText="",this.inventoryNumbersValidator=ct=>this.equipment&&this.equipment.inventoryNumber===ct||!this.inventoryNumbers?!0:!this.inventoryNumbers.includes(ct)}ngOnInit(){this.setValues(),this.setTexts(),this.createForm(this.equipment),this.getControls()}createForm(t){this.form=this.formBuilder.group({category:[t?.category||null,c.required],compensationCost:[this.equipment?.compensationCost||null,[c.required,c.max(this.maxValue.compensationCost)]],condition:[{value:t?.condition||null,disabled:t?this.getConditionDisableState(t):!0}],description:[t?.description||"",[c.required,c.maxLength(this.maxValue.description)]],inventoryNumber:[t?.inventoryNumber||null,[c.required,c.max(1e50),this.validationService.getCustomValidator(this.inventoryNumberErrorOptions,this.inventoryNumbersValidator)]],location:[1,c.required],maximumDays:[t?.maximumDays||null,[c.required,c.min(this.minValue.maximumDays),c.max(this.maxValue.maximumDays)]],name:[t?.name||"",[c.required,c.maxLength(this.maxValue.name)]],nameSubstring:[""],petKinds:[t?.petKinds||null,c.required],petSize:[t?.petSize?t.petSize:null,c.required],photoID:[t?.photoID||null,c.required],receiptDate:[t?.receiptDate?new Date(t.receiptDate):"",c.required],status:[1,c.required],subCategory:[1],supplier:[t?.supplier||"",[c.required,c.maxLength(this.maxValue.supplier)]],technicalIssues:[t?this.getTechnicalIssuesValue(t):null,[c.required]],termsOfUse:[t?.termsOfUse||"",[c.required,c.maxLength(this.maxValue.termsOfUse)]],title:[t?.title||"",[c.required,c.maxLength(this.maxValue.title)]]})}getControls(){this.conditionControl=this.form?.get("condition"),this.photoIdControl=this.form?.get("photoID")}setValues(){this.data.equipment&&(this.equipment=N({},this.data.equipment)),this.inventoryNumbers=this.data.inventoryNumbers,this.petSizes=this.data.petSizes||[],this.petKinds=this.data.petKinds||[],this.equipmentCategories=this.data.categories||[]}setTexts(){this.modalHeader=this.equipment?q.EditEquipmentHeader:q.AddEquipmentHeader,this.actionButtonText=this.equipment?q.Save:q.AddEquipmentModalButtonText}getTechnicalIssuesValue(t){return t.technicalIssues?Y.is:Y.not}getConditionDisableState(t){return!t.technicalIssues}setConditionState(t){this.setControlState(t===Y.is,this.conditionControl)}setControlState(t,i){t?i?.enable():(i?.disable(),i?.setValue(null)),i?.setValidators(t?this.conditionValidators:null)}choosePhoto(){this.photoInput?.nativeElement.click()}preventDefault(t){t.preventDefault()}addPhoto(t){let i=t.target;this.file=i?.files?.length?i.files[0]:void 0,this.file&&this.photoIdControl?.setValue(this.file.name)}returnEquipment(){this.validationService.emitSubmit(this.formName),this.form?.valid&&this.dialogRef.close({file:this.file,equipment:new jt(this.form.value)})}close(){if(this.form?.pristine)return this.dialogRef.close(!1);this.dialog.open(Ge,{data:{headerText:this.closeNotificationHeader,infoMessage:this.closeNotificationMessage,buttonOkText:"\u0423\u0434\u0430\u043B\u0438\u0442\u044C",buttonCancelText:"\u0412\u0435\u0440\u043D\u0443\u0442\u044C\u0441\u044F"}}).afterClosed().subscribe(t=>{t&&this.dialogRef.close(!1)})}get closeNotificationMessage(){return this.equipment?"\u0415\u0441\u043B\u0438 \u043E\u0442\u043C\u0435\u043D\u0438\u0442\u044C \u0440\u0435\u0434\u0430\u043A\u0442\u0438\u0440\u043E\u0432\u0430\u043D\u0438\u0435, \u0442\u043E \u0432\u0441\u0435 \u0438\u0437\u043C\u0435\u043D\u0435\u043D\u0438\u044F \u0431\u0443\u0434\u0443\u0442 \u0443\u0434\u0430\u043B\u0435\u043D\u044B.":"\u0415\u0441\u043B\u0438 \u043E\u0442\u043C\u0435\u043D\u0438\u0442\u044C \u0440\u0435\u0433\u0438\u0441\u0442\u0440\u0430\u0446\u0438\u044E, \u0442\u043E \u0432\u0441\u0435 \u0432\u043D\u0435\u0441\u0435\u043D\u043D\u044B\u0435 \u0434\u0430\u043D\u043D\u044B\u0435 \u0431\u0443\u0434\u0443\u0442 \u0443\u0434\u0430\u043B\u0435\u043D\u044B"}get closeNotificationHeader(){return this.equipment?"\u0418\u0437\u043C\u0435\u043D\u0435\u043D\u0438\u044F \u0431\u0443\u0434\u0443\u0442 \u0443\u0434\u0430\u043B\u0435\u043D\u044B.":"\u0414\u0430\u043D\u043D\u044B\u0435 \u0431\u0443\u0434\u0443\u0442 \u0443\u0434\u0430\u043B\u0435\u043D\u044B."}static{this.\u0275fac=function(i){return new(i||n)(g(V),g(J),g(Ct),g(W),g(nt))}}static{this.\u0275cmp=_({type:n,selectors:[["lc-equipment"]],viewQuery:function(i,a){if(i&1&&ge(xi,5),i&2){let p;ve(p=Ce())&&(a.photoInput=p.first)}},decls:9,vars:5,consts:[["name",""],["title",""],["description",""],["condition",""],["inventoryNumber",""],["compensationCost",""],["supplier",""],["termsOfUse",""],["picker",""],["photoInput",""],[3,"closed","handleCloseByMainLayout","headerTitle"],["body",""],[3,"formGroup",4,"ngIf"],["footer",""],[1,"buttons"],["mat-button","",1,"cancel",3,"click"],["mat-raised-button","","color","primary",3,"click"],[3,"formGroup"],[1,"row"],[1,"column"],["appearance","fill","floatLabel","auto"],["matInput","","formControlName","name",3,"lcValidationErrors"],["align","end"],["matInput","","formControlName","title",3,"lcValidationErrors"],["width","370px","appearance","fill"],["rows","4","matInput","","formControlName","description",3,"lcValidationErrors"],["floatLabel","auto"],["formControlName","category",3,"lcValidationErrors"],[3,"value",4,"ngFor","ngForOf"],["floatLabel","auto","appearance","fill"],["formControlName","technicalIssues",3,"valueChange","lcValidationErrors"],["appearance","fill"],["matInput","","rows","4","formControlName","condition",3,"lcValidationErrors"],["matInput","","type","number","formControlName","inventoryNumber",3,"max","lcValidationErrors"],["matInput","","type","number","formControlName","compensationCost",3,"max","lcValidationErrors"],["matInput","","formControlName","supplier",3,"lcValidationErrors"],["matInput","","type","url","formControlName","termsOfUse",3,"lcValidationErrors"],["formControlName","petKinds","multiple","",3,"lcValidationErrors"],["formControlName","petSize",3,"lcValidationErrors"],["matInput","","type","number","formControlName","maximumDays",3,"lcValidationErrors"],["floatLabel","auto","appearance","fill",1,"registration-form-field-input"],["matInput","","formControlName","receiptDate",3,"matDatepicker","lcValidationErrors"],["matSuffix","",3,"for"],[1,"photo-field"],["mat-flat-button","","type","button",1,"registration-controls-button",3,"click"],["color","primary"],["matInput","","formControlName","photoID","type","text",3,"keydown","lcValidationErrors"],[1,"hidden"],["type","file",1,"registration-form-field-input",3,"change"],[3,"value"]],template:function(i,a){i&1&&(r(0,"lc-modal-layout",10),k("closed",function(){return a.close()}),v(1,11),E(2,Mi,107,55,"form",12),C(),v(3,13),r(4,"div",14)(5,"button",15),k("click",function(){return a.close()}),u(6),s(),r(7,"button",16),k("click",function(){return a.returnEquipment()}),u(8),s()(),C(),s()),i&2&&(l("handleCloseByMainLayout",!0)("headerTitle",a.modalHeader),o(2),l("ngIf",a.form),o(4),y(" ",a.labels.cancel," "),o(2),y(" ",a.actionButtonText," "))},dependencies:[ft,A,R,ot,w,Re,Ue,wt,Bt,Nt,it,Et,Ie,Tt,_t,ht,vt,gt,De,X,Z,Se,tt,et],styles:["form[_ngcontent-%COMP%]{width:789px}form[_ngcontent-%COMP%]   .row[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:flex-start;margin-bottom:16px}form[_ngcontent-%COMP%]   .column[_ngcontent-%COMP%]{width:370px}form[_ngcontent-%COMP%]   .column[_ngcontent-%COMP%]   mat-form-field[_ngcontent-%COMP%]{margin-bottom:16px}form[_ngcontent-%COMP%]   .column[_ngcontent-%COMP%]   mat-form-field[_ngcontent-%COMP%]:last-child{margin-bottom:0}form[_ngcontent-%COMP%]   .condition[_ngcontent-%COMP%]{height:56px}form[_ngcontent-%COMP%]   mat-form-field[_ngcontent-%COMP%]{width:370px}textarea[_ngcontent-%COMP%]{resize:none;height:157px}.photo-field[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{height:54px;margin-right:5px}.photo-field[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{font-size:24px;width:24px;height:24px}.photo-field[_ngcontent-%COMP%]   mat-form-field[_ngcontent-%COMP%]{width:188px}.buttons[_ngcontent-%COMP%]{display:flex;justify-content:flex-end;align-items:center}.buttons[_ngcontent-%COMP%]   .cancel[_ngcontent-%COMP%]{margin-right:24px;font-style:normal;font-weight:500;color:#00677f}.buttons[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{height:56px;border-radius:10px;font-style:normal;font-weight:400;line-height:20px;padding:16px;text-transform:uppercase}.hidden[_ngcontent-%COMP%]{display:none}"],changeDetection:0})}}return n})();function Ii(n,e){if(n&1&&(v(0),r(1,"p"),u(2),r(3,"strong"),u(4),s(),u(5,"?"),s(),r(6,"p"),u(7),s(),C()),n&2){let t=x();o(2),y("",t.isUserBlocked?t.ModalEnum.UnblockConfirmationText:t.ModalEnum.BlockConfirmationText," "),o(2),S("",t.user.name,"",t.user.surname?" "+t.user.surname:"",""),o(3),h(t.isUserBlocked?t.ModalEnum.UnblockDescriptionText:t.ModalEnum.BlockDescriptionText)}}var ti=(()=>{class n{constructor(){this.ModalEnum=T,this.isUserBlocked=!1}ngOnInit(){this.data&&(this.user=this.data,this.isUserBlocked=this.user.is_readonly)}static{this.\u0275fac=function(i){return new(i||n)}}static{this.\u0275cmp=_({type:n,selectors:[["lc-block-user-modal-content"]],inputs:{data:"data"},decls:1,vars:1,consts:[[4,"ngIf"]],template:function(i,a){i&1&&E(0,Ii,8,4,"ng-container",0),i&2&&l("ngIf",a.user)},dependencies:[A],changeDetection:0})}}return n})();function Ai(n,e){if(n&1&&(v(0),r(1,"p"),u(2),r(3,"strong"),u(4),s(),u(5,"?"),s(),C()),n&2){let t=x();o(2),y("",t.ModalEnum.DeleteConfirmationText," "),o(2),S("",t.user.name,"",t.user.surname?" "+t.user.surname:"","")}}var ei=(()=>{class n{constructor(){this.ModalEnum=T}ngOnInit(){this.data&&(this.user=this.data)}static{this.\u0275fac=function(i){return new(i||n)}}static{this.\u0275cmp=_({type:n,selectors:[["lc-delete-user-modal-content"]],inputs:{data:"data"},decls:1,vars:1,consts:[[4,"ngIf"]],template:function(i,a){i&1&&E(0,Ai,6,3,"ng-container",0),i&2&&l("ngIf",a.user)},dependencies:[A],encapsulation:2,changeDetection:0})}}return n})();var rt=function(n){return n.AssignTitle="\u041D\u0430\u0437\u043D\u0430\u0447\u0438\u0442\u044C \u0440\u043E\u043B\u044C",n.AssignButtonText="\u041D\u0430\u0437\u043D\u0430\u0447\u0438\u0442\u044C",n.DeleteTitle="\u0423\u0434\u0430\u043B\u0438\u0442\u044C \u0440\u043E\u043B\u044C",n.DeleteButtonText="\u0423\u0434\u0430\u043B\u0438\u0442\u044C",n.DeleteConfirmationText="\u0412\u044B \u0443\u0432\u0435\u0440\u0435\u043D\u044B, \u0447\u0442\u043E \u0445\u043E\u0442\u0438\u0442\u0435 \u0443\u0434\u0430\u043B\u0438\u0442\u044C \u0440\u043E\u043B\u044C",n.CancelButtonText="\u041E\u0442\u043C\u0435\u043D\u0438\u0442\u044C",n.User="\u041F\u043E\u043B\u044C\u0437\u043E\u0432\u0430\u0442\u0435\u043B\u044C",n.Role="\u0420\u043E\u043B\u044C",n}(rt||{});function ki(n,e){if(n&1&&(v(0),r(1,"p"),u(2),r(3,"strong"),u(4),s(),u(5," \u043F\u043E\u043B\u044C\u0437\u043E\u0432\u0430\u0442\u0435\u043B\u044F "),r(6,"strong"),u(7),s(),u(8,"?"),s(),C()),n&2){let t=x();o(2),y("",t.ModalEnum.DeleteConfirmationText," "),o(2),h(t.user.role.name),o(3),S("",t.user.name,"",t.user.surname?" "+t.user.surname:"","")}}var ii=(()=>{class n{constructor(){this.ModalEnum=rt}ngOnInit(){this.data&&(this.user=this.data)}static{this.\u0275fac=function(i){return new(i||n)}}static{this.\u0275cmp=_({type:n,selectors:[["lc-delete-role-modal-content"]],inputs:{data:"data"},decls:1,vars:1,consts:[[4,"ngIf"]],template:function(i,a){i&1&&E(0,ki,9,4,"ng-container",0),i&2&&l("ngIf",a.user)},dependencies:[A],changeDetection:0})}}return n})();function Ti(n,e){if(n&1&&(r(0,"mat-option",13)(1,"div",14)(2,"p",15),u(3),s(),r(4,"p",16),u(5),s()()()),n&2){let t=e.$implicit;l("value",t),o(3),S("",t.name," ",t.surname,""),o(2),h(t.email)}}function Ni(n,e){if(n&1&&(r(0,"mat-option",13),u(1),s()),n&2){let t=e.$implicit;l("value",t.id),o(),h(t.name)}}var Lt=class se{constructor(e,t,i,a){this.data=e,this.formBuilder=t,this.validationService=i,this.dialogRef=a,this.formName="role_assignment_form",this.labels=rt,this.roles=[],this.form=this.formBuilder.group({user:[null,c.required],role:[null,c.required]})}ngOnInit(){this.roles=this.data.roles,this.filteredUserOptions$=this.form.get("user")?.valueChanges.pipe(he(""),z(e=>{let t=typeof e=="string"?e:e&&e?.name;return t?this.filterUsersByName(t):this.data.users.slice()}),B(this))}getUserName(e){return e&&e.name?`${e.name} ${e.surname}`:""}filterUsersByName(e){let t=e.toLowerCase();return this.data.users.filter(i=>i.name.toLowerCase().includes(t)||i.surname.toLowerCase().includes(t)||i.email.toLowerCase().includes(t))}assignRole(){let{role:e,user:t}=this.form.value;this.validationService.emitSubmit(this.formName),this.form?.valid&&this.dialogRef.close({roleId:e&&e,userId:t&&t.id})}static{this.\u0275fac=function(t){return new(t||se)(g(V),g(Ct),g(nt),g(W))}}static{this.\u0275cmp=_({type:se,selectors:[["lc-assign-role-modal"]],decls:18,vars:15,consts:[["auto","matAutocomplete"],[3,"headerTitle"],["body",""],[1,"form",3,"formGroup"],["appearance","fill",1,"field"],["type","text","matInput","","formControlName","user",3,"placeholder","matAutocomplete","lcValidationErrors"],[3,"displayWith"],[3,"value",4,"ngFor","ngForOf"],["formControlName","role",3,"placeholder","lcValidationErrors"],["footer",""],[1,"buttons"],["mat-button","",1,"cancel",3,"mat-dialog-close"],["mat-raised-button","","color","primary",3,"click"],[3,"value"],[1,"option"],[1,"option-title"],[1,"option-subtitle"]],template:function(t,i){if(t&1){let a=At();r(0,"lc-modal-layout",1),v(1,2),r(2,"form",3)(3,"mat-form-field",4),b(4,"input",5),r(5,"mat-autocomplete",6,0),E(7,Ti,6,4,"mat-option",7),Ee(8,"async"),s()(),r(9,"mat-form-field",4)(10,"mat-select",8),E(11,Ni,2,2,"mat-option",7),s()()(),C(),v(12,9),r(13,"div",10)(14,"button",11),u(15),s(),r(16,"button",12),k("click",function(){return lt(a),ut(i.assignRole())}),u(17),s()(),C(),s()}if(t&2){let a=P(6);l("headerTitle",i.labels.AssignTitle),o(2),l("formGroup",i.form),o(2),Yt("placeholder",i.labels.User),l("matAutocomplete",a)("lcValidationErrors",i.formName),o(),l("displayWith",i.getUserName),o(2),l("ngForOf",be(8,13,i.filteredUserOptions$)),o(3),Yt("placeholder",i.labels.Role),l("lcValidationErrors",i.formName),o(),l("ngForOf",i.roles),o(3),l("mat-dialog-close",!1),o(),y(" ",i.labels.CancelButtonText," "),o(2),y(" ",i.labels.AssignButtonText," ")}},dependencies:[ft,R,ot,w,$,Nt,it,_t,ht,He,ze,vt,gt,X,Z,tt,et,xe],styles:[".form[_ngcontent-%COMP%]{display:flex;flex-direction:column}.option[_ngcontent-%COMP%]{display:flex;flex-direction:column;line-height:.8;padding:10px 0}.option-subtitle[_ngcontent-%COMP%]{font-size:14px;color:#656565}.buttons[_ngcontent-%COMP%]{display:flex;justify-content:flex-end;align-items:center}.buttons[_ngcontent-%COMP%]   .cancel[_ngcontent-%COMP%]{margin-right:24px;font-style:normal;font-weight:500;color:#00677f}.buttons[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{height:56px;border-radius:10px;font-style:normal;font-weight:400;line-height:20px;padding:16px;text-transform:uppercase}.field[_ngcontent-%COMP%]{margin-bottom:22px}"],changeDetection:0})}};Lt=F([G],Lt);function Bi(n,e){if(n&1&&(r(0,"mat-option",18),u(1),s()),n&2){let t=e.$implicit;l("value",t.name),o(),h(t.translation)}}function qi(n,e){if(n&1&&(r(0,"mat-form-field",15)(1,"mat-label"),u(2,"\u041D\u043E\u0432\u044B\u0439 \u0441\u0442\u0430\u0442\u0443\u0441"),s(),r(3,"mat-select",16),E(4,Bi,2,2,"mat-option",17),s()()),n&2){let t=x(2);o(3),l("lcValidationErrors",t.formName),o(),l("ngForOf",t.statuses)}}function Oi(n,e){if(n&1&&(r(0,"div",7),b(1,"lc-fake-input",8)(2,"lc-fake-input",9)(3,"lc-fake-input",10)(4,"lc-fake-input",11),r(5,"div",12),b(6,"lc-fake-input",13),E(7,qi,5,2,"mat-form-field",14),s()()),n&2){let t=x();o(),l("text",t.equipment.title),o(),l("text",t.equipment.name),o(),l("text",t.equipment.inventoryNumber),o(),l("text",t.rentPeriod),o(),l("formGroup",t.form),o(),l("text",t.statusName),o(),l("ngIf",t.statuses)}}var jn=(()=>{class n{constructor(t,i,a,p){this.data=t,this.dialogRef=i,this.validationService=a,this.fb=p,this.formName="application status form",this.statuses=[],this.rentPeriod="",this.statusName="",this.form=this.fb.group({newStatusId:[null,c.required]})}ngOnInit(){let t=this.data;this.equipment=t.application.equipments[0],this.rentPeriod=t.rentPeriod,this.statusName=t.statusTranslation,this.statuses=this.getStatuses(t.statuses,t.application.last_status.status)}getStatuses(t,i){return t.filter(a=>{let p=a.name;return p!==i&&p!==Ne.inProgress})}saveStatus(){this.validationService.emitSubmit(this.formName),this.form.valid&&this.dialogRef.close(this.form.value.newStatusId)}static{this.\u0275fac=function(i){return new(i||n)(g(V),g(W),g(nt),g(Ct))}}static{this.\u0275cmp=_({type:n,selectors:[["lc-edit-application-status"]],decls:9,vars:2,consts:[["headerTitle","\u0418\u0437\u043C\u0435\u043D\u0438\u0442\u044C \u0441\u0442\u0430\u0442\u0443\u0441 \u0437\u0430\u044F\u0432\u043A\u0438"],["body",""],["class","content",4,"ngIf"],["footer",""],[1,"buttons"],["mat-button","",1,"cancel",3,"mat-dialog-close"],["mat-raised-button","","color","primary",3,"click"],[1,"content"],["label","\u041D\u0430\u0437\u0432\u0430\u043D\u0438\u0435",3,"text"],["label","\u041D\u0430\u0438\u043C\u0435\u043D\u043E\u0432\u0430\u043D\u0438\u0435",3,"text"],["label","\u0418\u043D\u0432\u0435\u043D\u0442\u0430\u0440\u043D\u044B\u0439 \u043D\u043E\u043C\u0435\u0440",3,"text"],["label","\u041F\u0435\u0440\u0438\u043E\u0434 \u0431\u0440\u043E\u043D\u0438\u0440\u043E\u0432\u0430\u043D\u0438\u044F",3,"text"],[1,"status",3,"formGroup"],["label","\u0410\u043A\u0442\u0443\u0430\u043B\u044C\u043D\u044B\u0439 \u0441\u0442\u0430\u0442\u0443\u0441",3,"text"],["floatLabel","auto",4,"ngIf"],["floatLabel","auto"],["formControlName","newStatusId",3,"lcValidationErrors"],[3,"value",4,"ngFor","ngForOf"],[3,"value"]],template:function(i,a){i&1&&(r(0,"lc-modal-layout",0),v(1,1),E(2,Oi,8,7,"div",2),C(),v(3,3),r(4,"div",4)(5,"button",5),u(6," \u041E\u0442\u043C\u0435\u043D\u0438\u0442\u044C "),s(),r(7,"button",6),k("click",function(){return a.saveStatus()}),u(8," \u0421\u043E\u0445\u0440\u0430\u043D\u0438\u0442\u044C "),s()(),C(),s()),i&2&&(o(2),l("ngIf",a.equipment),o(3),l("mat-dialog-close",!1))},dependencies:[ft,A,Vt,R,ot,w,$,it,Et,_t,ht,X,Z,tt,et],styles:[".content[_ngcontent-%COMP%]   lc-fake-input[_ngcontent-%COMP%]{margin-bottom:20px}.content[_ngcontent-%COMP%]   .status[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:flex-end}.content[_ngcontent-%COMP%]   .status[_ngcontent-%COMP%]   lc-fake-input[_ngcontent-%COMP%]{width:200px;margin-bottom:0}.buttons[_ngcontent-%COMP%]{display:flex;justify-content:flex-end;align-items:center}.buttons[_ngcontent-%COMP%]   .cancel[_ngcontent-%COMP%]{margin-right:24px;font-style:normal;font-weight:500;color:#00677f}.buttons[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{height:56px;border-radius:10px;font-style:normal;font-weight:400;line-height:20px;padding:16px;text-transform:uppercase}"],changeDetection:0})}}return n})();var mt=function(n){return n.added="\u041E\u0431\u043E\u0440\u0443\u0434\u043E\u0432\u0430\u043D\u0438\u0435 \u0434\u043E\u0431\u0430\u0432\u043B\u0435\u043D\u043E",n.archived="\u0431\u044B\u043B\u043E \u0437\u0430\u0430\u0440\u0445\u0438\u0432\u0438\u0440\u043E\u0432\u0430\u043D\u043E!",n.blocked="\u0431\u044B\u043B\u043E \u0437\u0430\u0431\u043B\u043E\u043A\u0438\u0440\u043E\u0432\u0430\u043D\u043E!",n.edited="\u041E\u0431\u043E\u0440\u0443\u0434\u043E\u0432\u0430\u043D\u0438\u0435 \u043E\u0442\u0440\u0435\u0434\u0430\u043A\u0442\u0438\u0440\u043E\u0432\u0430\u043D\u043E",n.unblocked="\u041E\u0431\u043E\u0440\u0443\u0434\u043E\u0432\u0430\u043D\u0438\u0435 \u0440\u0430\u0437\u0431\u043B\u043E\u043A\u0438\u0440\u043E\u0432\u0430\u043D\u043E",n}(mt||{});var It={[D.Archivate]:{tooltip:"",disabled:!1},[D.Edit]:{tooltip:"",disabled:!1},[D.Block]:{tooltip:"",disabled:!1},[D.Orders]:{tooltip:"",disabled:!1}};var ni=(()=>{class n{createDictionary(t,i){t.forEach(a=>i[a.id]=a.translation||a.name)}getDictionaryValue(t,i){let a=t[i];return a||void 0}static{this.\u0275fac=function(i){return new(i||n)}}static{this.\u0275prov=I({token:n,factory:n.\u0275fac,providedIn:"root"})}}return n})();var le=class $t{get equipmentData$(){return this.equipmentDataSubj$.asObservable()}constructor(e,t,i,a,p,st,ct,Qt){this.dialog=e,this.api=t,this.notificationService=i,this.mainHeaderService=a,this.dictionaryService=p,this.store=st,this.datePipe=ct,this.router=Qt,this.equipmentDataSubj$=new pt([]),this.inventoryNumbers=[],this.categoryDictionary={},this.statusDictionary={},this.statusIdsDictionary=N({},We),this.tableRows={active:[],archived:[]},this.isArchiveShown=!1}manageEvent(e){switch(e.action){case D.Block:this.manageBlock(e);break;case D.Edit:this.manageEquipment(e.row.entity);break;case D.Archivate:this.archivateEquipment(e);break;case D.Orders:this.goToOrders(e.row.entity);break}}fetchEquipments(){return this.api.getAllEquipment().pipe(j(e=>this.inventoryNumbers=e.items.map(t=>t.inventoryNumber)),j(e=>this.createTableRows(e.items)),j(()=>this.displayTable()))}createTableRows(e){let t=e.reduce((i,a)=>((a.status===Oe.archived?i.archived:i.active).push(a),i),{active:[],archived:[]});this.tableRows={active:this.createRows(t.active),archived:this.createRows(t.archived)}}createRows(e){return e.map(t=>({entity:t,name:t.name,title:t.title,inventoryNumber:t.inventoryNumber,categoryName:this.getCategoryName(t),statusName:this.getStatusName(t),actions:this.getActions(t)}))}displayTable(){let e=this.isArchiveShown?this.tableRows.archived:this.tableRows.active;this.equipmentDataSubj$.next(e)}getStatusName(e){return this.dictionaryService.getDictionaryValue(this.statusDictionary,e.status)||""}getCategoryName(e){return this.dictionaryService.getDictionaryValue(this.categoryDictionary,e.category)||""}getActions(e){return e.status===this.statusIdsDictionary.archived?this.getArchivedEquipmentActions():H(N({},It),{[D.Block]:this.getBlockEquipmentAction(e)})}getBlockEquipmentAction(e){return e.blockingPeriods?H(N({},It[D.Block]),{tooltip:this.getBlockedEquipmentActionTooltip(e.blockingPeriods[0])}):It[D.Block]}getBlockedEquipmentActionTooltip(e){return`\u0417\u0430\u0431\u043B\u043E\u043A\u0438\u0440\u043E\u0432\u0430\u043D\u043E ${this.getDate(e.start_date)} - ${this.getDate(e.end_date)}`}getDate(e){return this.datePipe.transform(e,"dd.MM.YYYY")||""}getArchivedEquipmentActions(){return H(N({},It),{[D.Archivate]:{tooltip:"",disabled:!0},[D.Edit]:{tooltip:"",disabled:!0},[D.Block]:{tooltip:"",disabled:!0}})}manageBlock(e){let t=e.row.entity,i;this.api.getUnavailablePeriodsById(t.id).pipe(z(a=>(i=t.blockingPeriods&&t.blockingPeriods[0]?this.removeBlockPeriod(a.items||[],t.blockingPeriods[0]):a.items||[],i)),f(a=>this.openBlockEquipmentModal(t,a)),O(Boolean),f(a=>a==="unblock equipment"?this.unblockEquipment(t):this.blockEquipment(t,a,i,e.action)),f(()=>this.fetchEquipments()),B(this)).subscribe()}removeBlockPeriod(e,t){return e.filter(i=>!(i.start_date===t.start_date&&i.end_date===t.end_date))}blockEquipment(e,t,i,a){return dt(this.isPeriodsIntersect(t,i)).pipe(f(p=>p?this.openOrderNotificationModal(a):dt(!0)),O(Boolean),f(()=>this.api.blockEquipment(e.id,t)),j(()=>this.notificationService.openSuccess(`${e.title} ${mt.blocked}`)))}unblockEquipment(e){return this.api.unblockEquipment(e.id).pipe(j(()=>{this.notificationService.openSuccess(`${e.title} ${mt.unblocked}`)}))}isPeriodsIntersect(e,t){for(let i of t)if(this.isDateInPeriod(e.startDate,i)||this.isDateInPeriod(e.endDate,i))return!0;return!1}isDateInPeriod(e,t){let i=new Date(t.start_date),a=new Date(t.end_date),p=e.getTime();return e>=i&&e<=a}goToOrders(e){let{id:t}=e;this.router.navigate([Jt.Admin,Jt.Applications],{queryParams:{[Pt.equipmentId]:t}})}archivateEquipment(e){let t=e.row.entity;this.openArchiveEquipmentModal(t).pipe(O(Boolean),f(()=>this.api.getEquipmentUnavailabilityPeriods(t.id)),f(i=>i.items&&i.items.length?this.openOrderNotificationModal(e.action):dt(!0)),O(Boolean),f(()=>this.api.archiveEquipment(t.id)),f(()=>this.fetchEquipments()),B(this)).subscribe(()=>{this.notificationService.openSuccess(`${t.title} ${mt.archived}}`)})}openOrderNotificationModal(e){return this.dialog.open(Ye,{data:e}).afterClosed()}openArchiveEquipmentModal(e){return this.dialog.open(Qe,{data:e}).afterClosed()}openBlockEquipmentModal(e,t){return this.dialog.open(Ft,{data:{equipment:e,unavailablePeriods:t||[]}}).afterClosed()}createCategoryDictionary(e){this.dictionaryService.createDictionary(e,this.categoryDictionary)}createStatusDictionary(e){this.dictionaryService.createDictionary(e,this.statusDictionary)}createEquipmentStatusIds(e){e.forEach(t=>{this.statusIdsDictionary[t.name]=t.id})}manageEquipment(e){this.openEquipmentModal(e).pipe(O(Boolean),f(t=>fe({photo:t.file?this.api.uploadPhoto(t.file):dt(null),equipment:dt(t.equipment)})),f(t=>(t.photo&&(t.equipment.photoID=t.photo.data.id),e?this.api.editEquipment(t.equipment,e.id):this.api.registerEquipment(t.equipment))),f(()=>this.fetchEquipments()),B(this)).subscribe(t=>{this.notificationService.openSuccess(e?mt.edited:mt.added)})}addNewEquipment(){this.manageEquipment()}openEquipmentModal(e){let t=this.store.snapshot().application_data;return this.dialog.open(Ze,{maxWidth:"",autoFocus:!1,disableClose:!0,data:{inventoryNumbers:this.inventoryNumbers||[],equipment:e?this.prepareEquipmentForModal(e):void 0,petKinds:t?.petKinds||[],petSizes:t?.petSizes||[],categories:t?.equipmentCategories||[]}}).afterClosed()}prepareEquipmentForModal(e){let t=this.store.snapshot().application_data.petKinds,i=N({},e);return i.receiptDate=+`${i.receiptDate}000`,i.petKinds=e.petKinds.map(a=>{if(typeof a=="number")return a;let p=t.find(st=>st.name===a.name);return p?p.id:0}),i}setPageHeader(){this.mainHeaderService.setPageTitle("\u041E\u0431\u043E\u0440\u0443\u0434\u043E\u0432\u0430\u043D\u0438\u0435")}setIsArchiveShown(e){this.isArchiveShown=e,this.displayTable()}static{this.\u0275fac=function(t){return new(t||$t)(d(J),d(U),d(bt),d(yt),d(ni),d(L),d(ye),d(kt))}}static{this.\u0275prov=I({token:$t,factory:$t.\u0275fac})}};le=F([G],le);var ue={[K.Profile]:{tooltip:"",disabled:!1},[K.Block]:{tooltip:"",disabled:!1},[K.Delete]:{tooltip:"",disabled:!0}};var ri=class Ht{constructor(e,t,i,a){this.api=e,this.notificationService=t,this.dialog=i,this.mainPageHeaderService=a,this.usersSubject$=new pt([])}get users$(){return this.usersSubject$.asObservable()}setPageTitle(e){this.mainPageHeaderService.setPageTitle(e)}fetchUsers(){return this.api.getAllUsers().pipe(j(e=>this.usersSubject$.next(this.createRows(e.items))))}editUser(e){switch(e.action){case K.Profile:break;case K.Block:this.updateUserBlockingStatus(e);break;case K.Delete:this.deleteUser(e);break}}updateUserBlockingStatus(e){let t=e.row.entity;this.openBlockUserModal(t).pipe(O(Boolean),f(()=>this.api.updateUserReadonlyAccess(t.id,!t.is_readonly)),f(()=>this.fetchUsers()),B(this)).subscribe(()=>{this.notificationService.openSuccess(t.is_readonly?Ot.Unblocked:Ot.Blocked)})}openBlockUserModal(e){return this.dialog.open(Dt,{data:{title:e.is_readonly?T.UnblockTitle:T.BlockTitle,contentComponentData:e,contentComponent:ti,applyButtonText:e.is_readonly?T.UnblockButtonText:T.BlockButtonText,cancelButtonText:T.CancelButtonText}}).afterClosed()}deleteUser(e){let t=e.row.entity;this.openDeleteUserModal(t).pipe(O(Boolean),f(()=>this.api.deleteUser(t.id)),f(()=>this.fetchUsers()),B(this)).subscribe(()=>{this.notificationService.openSuccess(Ot.Deleted)})}openDeleteUserModal(e){return this.dialog.open(Dt,{data:{title:T.DeleteTitle,contentComponentData:e,contentComponent:ei,applyButtonText:T.DeleteButtonText,cancelButtonText:T.CancelButtonText}}).afterClosed()}createRows(e){return e.map(t=>H(N({},t),{entity:t,email:t.email,name:t.name,surname:t.surname,phone_number:t.phone_number,statusName:this.getUserStatus(t),actions:this.getActions(t)}))}getUserStatus(e){return e.is_readonly?Xt.Blocked:Xt.Active}getActions(e){return e.is_readonly?H(N({},ue),{[K.Delete]:{tooltip:Pe.Delete,disabled:!1}}):N({},ue)}static{this.\u0275fac=function(t){return new(t||Ht)(d(U),d(bt),d(J),d(yt))}}static{this.\u0275prov=I({token:Ht,factory:Ht.\u0275fac})}};ri=F([G],ri);var me=function(n){return n.Delete="delete",n}(me||{});var zt=function(n){return n.Deleted="\u0420\u043E\u043B\u044C \u0443\u0434\u0430\u043B\u0435\u043D\u0430",n.Assigned="\u0420\u043E\u043B\u044C \u043D\u0430\u0437\u043D\u0430\u0447\u0435\u043D\u0430",n}(zt||{});var ce=class Kt{constructor(e,t,i,a,p){this.api=e,this.notificationService=t,this.dialog=i,this.mainPageHeaderService=a,this.store=p,this.rolesSubject$=new pt([]),this.roles=this.store.selectSnapshot(xt.roles),this.users=[]}get roles$(){return this.rolesSubject$.asObservable()}setPageTitle(){this.mainPageHeaderService.setPageTitle("\u0420\u043E\u043B\u0438")}fetchRoles(){return this.api.getAllUsers().pipe(j(e=>{this.users=e.items,this.rolesSubject$.next(this.createRows(e.items))}))}manageEvent(e){switch(e.action){case me.Delete:this.deleteRole(e);break}}assignRole(){this.openAssignRoleModal().pipe(O(Boolean),f(e=>this.api.assignRoleToUser(e.userId,e.roleId)),f(()=>this.fetchRoles()),B(this)).subscribe(()=>{this.notificationService.openSuccess(zt.Assigned)})}openAssignRoleModal(){return this.dialog.open(Lt,{data:{roles:this.roles,users:this.users}}).afterClosed()}deleteRole(e){let t=e.row.entity;this.openDeleteRoleModal(t).pipe(O(Boolean),f(()=>this.userRoleId?this.api.assignRoleToUser(t.id,this.userRoleId):de),f(()=>this.fetchRoles()),B(this)).subscribe(()=>{this.notificationService.openSuccess(zt.Deleted)})}openDeleteRoleModal(e){return this.dialog.open(Dt,{data:{title:rt.DeleteTitle,contentComponentData:e,contentComponent:ii,applyButtonText:rt.DeleteButtonText,cancelButtonText:T.CancelButtonText}}).afterClosed()}createRows(e){return e.reduce((t,i)=>(i.role.id!==this.userRoleId&&t.push(this.createTableRow(i)),t),[])}createTableRow(e){return{entity:e,email:e.email,surname:e.surname,name:e.name,roleName:e.role.name}}get userRoleId(){return this.userRoleIdSaved!==void 0?this.userRoleIdSaved:(this.userRoleIdSaved=this.roles&&this.roles.find(e=>e.slug==="user")?.id||void 0,this.userRoleIdSaved)}static{this.\u0275fac=function(t){return new(t||Kt)(d(U),d(bt),d(J),d(yt),d(L))}}static{this.\u0275prov=I({token:Kt,factory:Kt.\u0275fac})}};ce=F([G],ce);var Jo=(()=>{class n{constructor(t,i){this.api=t,this.store=i}getApplicationStatusNames(){return this.api.getApplicationStatuses().pipe(z(t=>this.translateStatuses(t)),f(t=>this.store.dispatch(new Te(t))),z(()=>this.store.selectSnapshot(xt.applicationStatuses)||[]))}translateStatuses(t){return t.map(i=>H(N({},i),{translation:Be[i.name]||""}))}static{this.\u0275fac=function(i){return new(i||n)(d(U),d(L))}}static{this.\u0275prov=I({token:n,factory:n.\u0275fac,providedIn:"root"})}}return n})();var la=(()=>{class n{constructor(t,i){this.store=t,this.router=i}canActivate(){let i=this.store.selectSnapshot(Ae.user)?.role?.name;return i===Zt.admin||i===Zt.manager?!0:this.router.parseUrl("/forbidden")}static{this.\u0275fac=function(i){return new(i||n)(d(L),d(kt))}}static{this.\u0275prov=I({token:n,factory:n.\u0275fac})}}return n})();export{la as a,U as b,jn as c,le as d,ri as e,ce as f,ui as g,Jo as h};
