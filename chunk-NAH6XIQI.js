import{$b as ft,$c as _t,A as k,B as j,D as z,Ga as rt,Ib as mt,J as l,Jc as ht,K as G,La as at,M as A,N as f,O as a,Ob as dt,Q as r,Qa as pt,R as p,Ra as N,S as h,T as J,U as K,Ua as lt,Uc as E,V as T,Va as st,W as R,X as _,Yb as ut,Zc as yt,ac as gt,ba as Q,ca as c,da as L,ea as X,f as V,fa as Y,g as W,ha as Z,i as H,ka as tt,ma as y,na as I,oa as B,pa as it,q as U,ra as F,t as d,ta as et,u as v,ua as D,va as w,w as q,wa as nt,x as g,xa as P,xb as ct,y as u,z as x,za as ot}from"./chunk-LUI5EWE7.js";var M=(()=>{class t{static{this.ORDERS_BASE_URL="v1/orders"}constructor(i){this.http=i}getOrders(i="all",e=10,n=0){return this.http.get(`${t.ORDERS_BASE_URL}?status=${i}&limit=${e}&offset=${n}`)}static{this.\u0275fac=function(e){return new(e||t)(q(ot))}}static{this.\u0275prov=d({token:t,factory:t.\u0275fac})}}return t})();var Mt=[{id:1,name:"all",translation:"\u0412\u0441\u0435"},{id:2,name:"active",translation:"\u0410\u043A\u0442\u0438\u0432\u043D\u044B\u0435"},{id:3,name:"finished",translation:"\u0417\u0430\u0432\u0435\u0440\u0448\u0435\u043D\u043D\u044B\u0435"}];var $=(()=>{class t{getFilter(){return W(this.createFilter(this.createOptions()))}getId(){return"my-applications-filter"}createOptions(){return Mt.map(i=>({label:i.translation||i.name,value:i.name}))}createFilter(i){return{id:this.getId(),label:"\u041F\u043E\u043A\u0430\u0437\u0430\u0442\u044C",options:i}}static{this.\u0275fac=function(e){return new(e||t)}}static{this.\u0275prov=d({token:t,factory:t.\u0275fac})}}return t})();var O=(()=>{class t{constructor(){this.itemsSignal=A([]),this.loadingSignal=A(!1),this.hasMoreSignal=A(!0),this.items$=F(()=>this.itemsSignal()),this.loading$=F(()=>this.loadingSignal()),this.hasMore$=F(()=>this.hasMoreSignal())}get loading(){return this.loadingSignal()}get hasMore(){return this.hasMoreSignal()}get items(){return this.itemsSignal()}setLoading(i){this.loadingSignal.set(i)}setHasMore(i){this.hasMoreSignal.set(i)}addItems(i){let e=this.itemsSignal();this.itemsSignal.set([...e,...i])}reset(){this.itemsSignal.set([]),this.hasMoreSignal.set(!0)}static{this.\u0275fac=function(e){return new(e||t)}}static{this.\u0275prov=d({token:t,factory:t.\u0275fac})}}return t})();var S=(()=>{class t{constructor(){this.destroyRef=g(z),this.api=g(M),this.headerService=g(ht),this.infiniteScrollService=g(O),this.filterProvider=g($),this.applications$=this.infiniteScrollService.items$,this.hasMore$=this.infiniteScrollService.hasMore$,this.loading$=this.infiniteScrollService.loading$}getApplications(i="all",e=10,n=0){return this.api.getOrders(i,e,n).pipe(H(s=>s.items))}loadMoreApplications(i="all",e=10){if(this.infiniteScrollService.loading||!this.infiniteScrollService.hasMore)return;let n=this.infiniteScrollService.items.length;this.infiniteScrollService.setLoading(!0),this.getApplications(i,e,n).pipe(U(s=>{this.infiniteScrollService.addItems(s),this.infiniteScrollService.setLoading(!1),this.infiniteScrollService.setHasMore(s.length>0)}),rt(this.destroyRef)).subscribe({error:()=>{this.infiniteScrollService.setLoading(!1)}})}resetApplications(){this.infiniteScrollService.reset()}getFilter(){return this.filterProvider.getFilter()}setPageTitle(){this.headerService.setPageTitle("\u041C\u043E\u0438 \u0437\u0430\u044F\u0432\u043A\u0438")}static{this.\u0275fac=function(e){return new(e||t)}}static{this.\u0275prov=d({token:t,factory:t.\u0275fac})}}return t})();var b=(()=>{class t{constructor(){this.diameter=100,this.strokeWidth=10}static{this.\u0275fac=function(e){return new(e||t)}}static{this.\u0275cmp=u({type:t,selectors:[["lc-loader"]],inputs:{diameter:"diameter",strokeWidth:"strokeWidth"},standalone:!0,features:[Z],decls:1,vars:2,consts:[[3,"diameter","strokeWidth"]],template:function(e,n){e&1&&h(0,"mat-spinner",0),e&2&&a("diameter",n.diameter)("strokeWidth",n.strokeWidth)},dependencies:[P,gt,ft],styles:["[_nghost-%COMP%]{display:flex;justify-content:center;align-items:center;flex-direction:column;width:100%;height:100%}"],changeDetection:0})}}return t})();var Ft=(t,o)=>[t,o];function Dt(t,o){if(t&1&&(r(0,"article",1)(1,"a",2)(2,"div",3)(3,"button",4),c(4),p(),r(5,"span",5),c(6),y(7,"date"),y(8,"date"),p()(),r(9,"div",6)(10,"div",7)(11,"p",8),c(12),p(),r(13,"p",9),c(14),p()(),r(15,"button",10)(16,"mat-icon",11),c(17,"keyboard_arrow_right"),p()()()()()),t&2){let i=o.ngIf,e=_();l(),a("routerLink",tt(12,Ft,e.route,e.application.id)),l(3),X(" ",e.getStatus(i,e.application.last_status.status)," "),l(2),Y("\u043D\u0430 \u043F\u0435\u0440\u0438\u043E\u0434 ",B(7,6,e.application.rent_start,"dd.MM.yy")," \u2014 ",B(8,9,e.application.rent_end,"dd.MM.yy"),""),l(6),L(e.application.equipments[0].name),l(2),L(e.application.equipments[0].title)}}var C=class t{constructor(){this.route=`/${mt.MyApplications}`}getStatus(o,i){return o.find(e=>e.name===i)?.translation??""}static{this.\u0275fac=function(i){return new(i||t)}}static{this.\u0275cmp=u({type:t,selectors:[["lc-my-application"]],inputs:{application:"application"},decls:2,vars:3,consts:[["class","my-application",4,"ngIf"],[1,"my-application"],[1,"my-application__link",3,"routerLink"],[1,"my-application__header"],["mat-button","","color","primary",1,"my-application__status"],[1,"my-application__period"],[1,"my-application__body"],[1,"my-application__text"],[1,"my-application__title"],[1,"my-application__description"],["mat-icon-button",""],[1,"my-application__icon"]],template:function(i,e){i&1&&(f(0,Dt,18,15,"article",0),y(1,"async")),i&2&&a("ngIf",I(1,1,e.application&&e.applicationStatuses$))},dependencies:[D,pt,lt,st,dt,w,nt],styles:[".my-application__header[_ngcontent-%COMP%]{display:flex;align-items:center;gap:6px}.my-application__body[_ngcontent-%COMP%]{display:flex;justify-content:space-between}.my-application__text[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:8px}.my-application__text[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin:0}.my-application__icon[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center;color:#005f75;font-size:32px}.my-application__period[_ngcontent-%COMP%], .my-application__description[_ngcontent-%COMP%]{color:#656565}.my-application__title[_ngcontent-%COMP%]{font-weight:700;color:#005f75}.my-application__status[_ngcontent-%COMP%]{background-color:#fff;border:2px solid #CFDBE5;border-radius:16px;padding:6px 12px}.my-application__link[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:8px;text-decoration:none}"],changeDetection:0})}};V([at(ut.applicationStatuses)],C.prototype,"applicationStatuses$",void 0);var St=(()=>{class t{static{this.\u0275fac=function(e){return new(e||t)}}static{this.\u0275cmp=u({type:t,selectors:[["lc-my-application-details"]],decls:2,vars:0,template:function(e,n){e&1&&(r(0,"p"),c(1,"my-application-details works!"),p())},changeDetection:0})}}return t})();function Pt(t,o){if(t&1){let i=T();r(0,"lc-dropdown-filter",6),R("selectionChange",function(n){k(i);let s=_();return j(s.applyFilter(n))}),p()}if(t&2){let i=o.ngIf;a("label","\u041F\u043E\u043A\u0430\u0437\u0430\u0442\u044C")("options",i.options)}}function Et(t,o){t&1&&h(0,"mat-divider")}function $t(t,o){if(t&1&&(r(0,"div",7),h(1,"lc-my-application",8),f(2,Et,1,0,"mat-divider",9),p()),t&2){let i=o.$implicit,e=o.last;l(),a("application",i),l(),a("ngIf",!e)}}function Ot(t,o){t&1&&(J(0),h(1,"lc-loader"),K())}function bt(t,o){t&1&&(r(0,"p",11),c(1,"\u0418\u0437\u0432\u0438\u043D\u0438\u0442\u0435, \u043F\u043E \u0432\u0430\u0448\u0435\u043C\u0443 \u0437\u0430\u043F\u0440\u043E\u0441\u0443 \u043D\u0438\u0447\u0435\u0433\u043E \u043D\u0435 \u043D\u0430\u0439\u0434\u0435\u043D\u043E. \u041F\u043E\u043F\u0440\u043E\u0431\u0443\u0439\u0442\u0435 \u0438\u0437\u043C\u0435\u043D\u0438\u0442\u044C \u043A\u0440\u0438\u0442\u0435\u0440\u0438\u0438 \u0437\u0430\u043F\u0440\u043E\u0441\u0430."),p())}function kt(t,o){if(t&1&&f(0,bt,2,0,"p",10),t&2){let i=_();a("ngIf",i.applications$().length===0)}}var Ct=(()=>{class t{constructor(i){this.controller=i,this.applications$=this.controller.applications$,this.loading$=this.controller.loading$,this.hasMore$=this.controller.hasMore$,this.filter$=this.controller.getFilter(),this.currentFilter=""}ngOnInit(){this.controller.loadMoreApplications(),this.controller.setPageTitle()}applyFilter(i){this.currentFilter=i,this.controller.resetApplications(),this.controller.loadMoreApplications(this.currentFilter)}trackMyApplication(i,e){return e.id}loadMore(){this.controller.loadMoreApplications(this.currentFilter)}ngOnDestroy(){this.controller.resetApplications()}static{this.\u0275fac=function(e){return new(e||t)(G(S))}}static{this.\u0275cmp=u({type:t,selectors:[["lc-my-applications"]],decls:8,vars:7,consts:[["noApplicationsMessage",""],["lcInfiniteScroll","",1,"my-applications-container",3,"scrolled"],[3,"label","options","selectionChange",4,"ngIf"],[1,"my-applications-list"],["class","my-application-container",4,"ngFor","ngForOf","ngForTrackBy"],[4,"ngIf","ngIfElse"],[3,"selectionChange","label","options"],[1,"my-application-container"],[3,"application"],[4,"ngIf"],["class","no-applications-message",4,"ngIf"],[1,"no-applications-message"]],template:function(e,n){if(e&1){let s=T();r(0,"div",1),R("scrolled",function(){return k(s),j(n.loadMore())}),f(1,Pt,1,2,"lc-dropdown-filter",2),y(2,"async"),r(3,"section",3),f(4,$t,3,2,"div",4)(5,Ot,2,0,"ng-container",5),p()(),f(6,kt,1,1,"ng-template",null,0,it)}if(e&2){let s=Q(7);l(),a("ngIf",I(2,5,n.filter$)),l(3),a("ngForOf",n.applications$())("ngForTrackBy",n.trackMyApplication),l(),a("ngIf",n.loading$())("ngIfElse",s)}},dependencies:[et,D,yt,ct,E,b,C,w],styles:[".my-applications-container[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:40px;padding:24px;height:100%;overflow:auto}.my-applications-list[_ngcontent-%COMP%], .my-application-container[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:16px}.no-applications-message[_ngcontent-%COMP%]{text-align:center;color:#656565}"],changeDetection:0})}}return t})();var jt=[{path:"",component:Ct},{path:":id",component:St}],vt=(()=>{class t{static{this.\u0275fac=function(e){return new(e||t)}}static{this.\u0275mod=x({type:t})}static{this.\u0275inj=v({imports:[N.forChild(jt),N]})}}return t})();var Ni=(()=>{class t{static{this.\u0275fac=function(e){return new(e||t)}}static{this.\u0275mod=x({type:t})}static{this.\u0275inj=v({providers:[M,S,$,O],imports:[P,vt,_t,E,b]})}}return t})();export{Ni as MyApplicationsModule};
