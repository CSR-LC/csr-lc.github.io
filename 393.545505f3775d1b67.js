"use strict";(self.webpackChunklc_fe=self.webpackChunklc_fe||[]).push([[393],{8393:(Ue,dt,s)=>{s.r(dt),s.d(dt,{AdminModule:()=>Pe});var m=s(6814),ht=s(9316),D=s(7582),X=s(9862),t=s(5879);let y=(()=>{class u{static#t=this.USERS_BASE_URL="v1/users";static#e=this.ROLES_BASE_URL="v1/roles";static#u=this.MANAGEMENT_BASE_URL="v1/management";constructor(e){this.http=e}getAllEquipment(){const e=(new X.LE).set("limit",1e3).set("has_equipments","true");return this.http.get("equipment",{params:e})}getUnavailablePeriodsById(e){return this.http.get(`/equipment/unavailability_periods/${e}`)}archiveEquipment(e){return this.http.post(`/equipment/achive/${e}/`,{equipmentId:e})}blockEquipment(e,n){return this.http.post(`/equipment/${e}/blocking`,{end_date:n.endDate,start_date:n.startDate})}unblockEquipment(e){return this.http.post(`/equipment/${e}/unblocking`,{})}uploadPhoto(e){const n=new FormData;return n.append("file",e,e.name),this.http.post("equipment/photos",n)}registerEquipment(e){return this.http.post("equipment",e)}editEquipment(e,n){return this.http.put(`equipment/${n}`,e)}getEquipmentStatuses(){return this.http.get("/equipment/status_names")}getEquipmentCategories(){return this.http.get("/equipment/categories")}getEquipmentUnavailabilityPeriods(e){return this.http.get(`/equipment/unavailability_periods/${e}`)}getAllUsers(){return this.http.get(u.USERS_BASE_URL)}updateUserReadonlyAccess(e,n){return this.http.put(`${u.USERS_BASE_URL}/${e}/readonly-access`,{is_readonly:n})}deleteUser(e){return this.http.delete(`${u.USERS_BASE_URL}/${e}`)}getAllRoles(){return this.http.get(u.ROLES_BASE_URL)}assignRoleToUser(e,n){return this.http.post(`${u.MANAGEMENT_BASE_URL}/users/${e}/role`,{roleId:n})}getAllOrders(){const e=(new X.LE).set("limit",1e3).set("has_equipments","true");return this.http.get("/management/orders",{params:e})}getApplicationStatuses(){return this.http.get("/v1/status_names")}editApplicationStatus(e){return this.http.post("/v1/order_statuses/",e)}static#n=this.\u0275fac=function(n){return new(n||u)(t.LFG(X.eN))};static#o=this.\u0275prov=t.Yz7({token:u,factory:u.\u0275fac})}return u})();var p=s(7700),g=function(u){return u.ArchiveTitle="\u0410\u0440\u0445\u0438\u0432\u0438\u0440\u043e\u0432\u0430\u043d\u0438\u0435 \u043e\u0431\u043e\u0440\u0443\u0434\u043e\u0432\u0430\u043d\u0438\u044f",u.BlockTitle="\u0411\u043b\u043e\u043a\u0438\u0440\u043e\u0432\u043a\u0430 \u043e\u0431\u043e\u0440\u0443\u0434\u043e\u0432\u0430\u043d\u0438\u044f",u.ArchiveReason="\u0410\u0440\u0445\u0438\u0432\u0438\u0440\u043e\u0432\u0430\u043d\u0438\u0435",u.ArchiveApplyButtonText="\u0410\u0440\u0445\u0438\u0432\u0438\u0440\u043e\u0432\u0430\u0442\u044c",u.BlockReason="\u0411\u043b\u043e\u043a\u0438\u0440\u043e\u0432\u043a\u0430",u.BlockApplyButtonText="\u0411\u043b\u043e\u043a\u0438\u0440\u043e\u0432\u0430\u0442\u044c",u.BlockCancelButtonText="\u0420\u0430\u0437\u0431\u043b\u043e\u043a\u0438\u0440\u043e\u0432\u0430\u0442\u044c",u.AddEquipmentHeader="\u0420\u0435\u0433\u0438\u0441\u0442\u0440\u0430\u0446\u0438\u044f \u043d\u043e\u0432\u043e\u0433\u043e \u043e\u0431\u043e\u0440\u0443\u0434\u043e\u0432\u0430\u043d\u0438\u044f",u.EditEquipmentHeader="\u0420\u0435\u0434\u0430\u043a\u0442\u0438\u0440\u043e\u0432\u0430\u043d\u0438\u0435 \u043e\u0431\u043e\u0440\u0443\u0434\u043e\u0432\u0430\u043d\u0438\u044f",u.EditEquipmentModalButtonText="\u0420\u0435\u0434\u0430\u043a\u0442\u0438\u0440\u043e\u0432\u0430\u0442\u044c",u.AddEquipmentModalButtonText="\u0417\u0430\u0440\u0435\u0433\u0438\u0441\u0442\u0440\u0438\u0440\u043e\u0432\u0430\u0442\u044c",u}(g||{}),A=s(554),x=s(2296),H=function(u){return u.Name="\u041d\u0430\u0437\u0432\u0430\u043d\u0438\u0435",u.NameSubstring="\u041d\u0430\u0438\u043c\u0435\u043d\u043e\u0432\u0430\u043d\u0438\u0435",u.InventoryNumber="\u0418\u043d\u0432\u0435\u043d\u0442\u0430\u0440\u043d\u044b\u0439 \u043d\u043e\u043c\u0435\u0440",u}(H||{});let ft=(()=>{class u{static#t=this.\u0275fac=function(n){return new(n||u)};static#e=this.\u0275cmp=t.Xpm({type:u,selectors:[["lc-fake-input"]],inputs:{label:"label",text:"text"},decls:5,vars:2,consts:[[1,"label"],[1,"text"],[1,"separator"]],template:function(n,i){1&n&&(t.TgZ(0,"span",0),t._uU(1),t.qZA(),t.TgZ(2,"span",1),t._uU(3),t.qZA(),t._UZ(4,"div",2)),2&n&&(t.xp6(1),t.Oqu(i.label),t.xp6(2),t.Oqu(i.text))},styles:["[_nghost-%COMP%]{display:flex;flex-direction:column}[_nghost-%COMP%]   span[_ngcontent-%COMP%]{display:inline-block;margin-left:16px}[_nghost-%COMP%]   .label[_ngcontent-%COMP%]{font-size:12px;font-weight:400;line-height:16px;color:#5f5f5f}[_nghost-%COMP%]   .text[_ngcontent-%COMP%]{font-size:16px;color:#000}[_nghost-%COMP%]   .separator[_ngcontent-%COMP%]{border-bottom:1px solid #656565;margin-top:10px}"],changeDetection:0})}return u})();function Zt(u,o){if(1&u&&t._UZ(0,"lc-fake-input",1),2&u){const e=t.oxw();t.Q6J("label",e.LabelEnum.Name)("text",e.equipment.name)}}function kt(u,o){if(1&u&&t._UZ(0,"lc-fake-input",1),2&u){const e=t.oxw();t.Q6J("label",e.LabelEnum.NameSubstring)("text",e.equipment.title)}}function St(u,o){if(1&u&&t._UZ(0,"lc-fake-input",1),2&u){const e=t.oxw();t.Q6J("label",e.LabelEnum.InventoryNumber)("text",e.equipment.inventoryNumber)}}let gt=(()=>{class u{constructor(){this.LabelEnum=H}static#t=this.\u0275fac=function(n){return new(n||u)};static#e=this.\u0275cmp=t.Xpm({type:u,selectors:[["lc-equipment-info"]],inputs:{equipment:"equipment"},decls:3,vars:3,consts:[[3,"label","text",4,"ngIf"],[3,"label","text"]],template:function(n,i){1&n&&(t.YNc(0,Zt,1,2,"lc-fake-input",0),t.YNc(1,kt,1,2,"lc-fake-input",0),t.YNc(2,St,1,2,"lc-fake-input",0)),2&n&&(t.Q6J("ngIf",i.equipment&&i.equipment.name),t.xp6(1),t.Q6J("ngIf",i.equipment&&i.equipment.title),t.xp6(1),t.Q6J("ngIf",i.equipment&&i.equipment.inventoryNumber))},dependencies:[m.O5,ft],styles:["lc-fake-input[_ngcontent-%COMP%]{margin-bottom:24px}lc-fake-input[_ngcontent-%COMP%]:last-child{margin-bottom:0}"],changeDetection:0})}return u})(),It=(()=>{class u{constructor(e){this.equipment=e,this.ModalEnum=g,this.inventoryNumber=String(this.equipment.inventoryNumber)}static#t=this.\u0275fac=function(n){return new(n||u)(t.Y36(p.WI))};static#e=this.\u0275cmp=t.Xpm({type:u,selectors:[["lc-archive-equipment-modal"]],decls:12,vars:4,consts:[["headerTitle","\u0410\u0440\u0445\u0438\u0432\u0438\u0440\u043e\u0432\u0430\u043d\u0438\u0435 \u043e\u0431\u043e\u0440\u0443\u0434\u043e\u0432\u0430\u043d\u0438\u044f"],["body",""],[1,"content"],[3,"equipment"],["footer",""],[1,"buttons"],["mat-button","",1,"cancel",3,"mat-dialog-close"],["mat-raised-button","","color","primary",3,"mat-dialog-close"]],template:function(n,i){1&n&&(t.TgZ(0,"lc-modal-layout",0),t.ynx(1,1),t.TgZ(2,"div",2)(3,"p"),t._uU(4," \u0421\u0442\u0430\u0442\u0443\u0441 \u043e\u0431\u043e\u0440\u0443\u0434\u043e\u0432\u0430\u043d\u0438\u0435 \u0438\u0437\u043c\u0435\u043d\u0438\u0442\u044c\u0441\u044f \u043d\u0430 \u201c\u0412 \u0430\u0440\u0445\u0438\u0432\u0435\u201d \u0438 \u0441\u043a\u0440\u043e\u0435\u0442\u0441\u044f \u0438\u0437 \u043e\u0431\u0449\u0435\u0433\u043e \u0441\u043f\u0438\u0441\u043a\u0430 \u043e\u0431\u043e\u0440\u0443\u0434\u043e\u0432\u0430\u043d\u0438\u044f. \u041f\u0440\u043e\u0432\u0435\u0440\u044c\u0442\u0435 \u0434\u0430\u043d\u043d\u044b\u0435. "),t.qZA(),t._UZ(5,"lc-equipment-info",3),t.qZA(),t.BQk(),t.ynx(6,4),t.TgZ(7,"div",5)(8,"button",6),t._uU(9," \u041e\u0442\u043c\u0435\u043d\u0438\u0442\u044c "),t.qZA(),t.TgZ(10,"button",7),t._uU(11),t.qZA()(),t.BQk(),t.qZA()),2&n&&(t.xp6(5),t.Q6J("equipment",i.equipment),t.xp6(3),t.Q6J("mat-dialog-close",!1),t.xp6(2),t.Q6J("mat-dialog-close",!0),t.xp6(1),t.hij(" ",i.ModalEnum.ArchiveApplyButtonText," "))},dependencies:[A.m,x.lW,p.ZT,gt],styles:[".content[_ngcontent-%COMP%]{font-style:normal;font-weight:400;font-size:14px;line-height:24px;letter-spacing:.1px;color:#000}.content[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin-bottom:24px}.buttons[_ngcontent-%COMP%]{display:flex;justify-content:flex-end;align-items:center}.buttons[_ngcontent-%COMP%]   .cancel[_ngcontent-%COMP%]{margin-right:24px;font-style:normal;font-weight:500;color:#00677f}.buttons[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{height:56px;border-radius:10px;font-style:normal;font-weight:400;line-height:20px;padding:16px;text-transform:uppercase}"],changeDetection:0})}return u})();var F=s(5619),q=s(9397),C=s(7398),l=s(4664),E=s(2181),k=s(2096),wt=s(9315),a=s(6223),Pt=s(4347),d=s(388),v=s(8034),J=s(9118),Ut=s(4315),R=s(5659),b=s(4170);function Nt(u,o){if(1&u&&(t.TgZ(0,"button",13),t._uU(1),t.qZA()),2&u){const e=t.oxw();t.Q6J("mat-dialog-close","unblock equipment"),t.xp6(1),t.hij(" ",e.ModalEnum.BlockCancelButtonText," ")}}let tt=class ct{constructor(o,e,n,i,r){this.dialogData=o,this.dialogRef=e,this.fb=n,this.validationService=i,this.dateRangeService=r,this.formName="block_equipment_modal",this.unavailablePeriods=[],this.ModalEnum=g,this.LabelEnum=H,this.minDate=null,this.form=this.fb.group({startDate:[null,a.kI.required],endDate:[null,a.kI.required]})}ngOnInit(){this.equipment=this.dialogData.equipment,this.unavailablePeriods=this.dialogData.unavailablePeriods,this.minDate=new Date,this.setInitialFormValue(this.equipment)}setInitialFormValue(o){if(!o?.blockingPeriods?.length)return;const e=o.blockingPeriods[0];this.setFormValue({startDate:new Date(e.start_date),endDate:new Date(e.end_date)})}blockEquipment(){this.validationService.emitSubmit(this.formName),this.form.valid?this.dialogRef.close(this.form.getRawValue()):this.form.markAllAsTouched()}openDatePicker(){this.dateRangeService.openDateRangeModal(this.dateRangeConfig).pipe((0,d.t)(this)).subscribe(o=>{o&&this.setFormValue({startDate:new Date(o.start_date),endDate:new Date(o.end_date)})})}setFormValue(o){this.form.setValue(o)}get dateRangeConfig(){return{headerText:"\u0412\u044b\u0431\u0435\u0440\u0438\u0442\u0435 \u043f\u0435\u0440\u0438\u043e\u0434 \u0431\u043b\u043e\u043a\u0438\u0440\u043e\u0432\u043a\u0438",buttonText:"\u0412\u044b\u0431\u0440\u0430\u0442\u044c",maxRentalPeriod:14,unavailableDates:this.unavailablePeriods,purpose:Pt.z.block,selectedPeriod:this.blockPeriodForModal}}get blockPeriodForModal(){const o=this.form.value;if(o.endDate&&o.startDate)return new v.C0(new Date(o.startDate),new Date(o.endDate))}static#t=this.\u0275fac=function(e){return new(e||ct)(t.Y36(p.WI),t.Y36(p.so),t.Y36(a.QS),t.Y36(J.R),t.Y36(Ut.s))};static#e=this.\u0275cmp=t.Xpm({type:ct,selectors:[["lc-block-equipment-modal"]],decls:17,vars:8,consts:[[3,"headerTitle"],["body",""],[3,"equipment"],[3,"formGroup"],[3,"min"],["matStartDate","","formControlName","startDate","placeholder","\u041d\u0430\u0447\u0430\u043b\u043e",3,"lcValidationErrors"],["matEndDate","","formControlName","endDate","placeholder","\u041a\u043e\u043d\u0435\u0446",3,"lcValidationErrors"],["matIconSuffix","",3,"click"],["footer",""],[1,"buttons-wrapper"],[1,"buttons"],["mat-button","","class","cancel",3,"mat-dialog-close",4,"ngIf"],["mat-raised-button","","color","primary",3,"click"],["mat-button","",1,"cancel",3,"mat-dialog-close"]],template:function(e,n){1&e&&(t.TgZ(0,"lc-modal-layout",0),t.ynx(1,1),t._UZ(2,"lc-equipment-info",2),t.TgZ(3,"form",3)(4,"mat-form-field")(5,"mat-label"),t._uU(6,"\u041f\u0435\u0440\u0438\u043e\u0434 \u0431\u043b\u043e\u043a\u0438\u0440\u043e\u0432\u043a\u0438"),t.qZA(),t.TgZ(7,"mat-date-range-input",4),t._UZ(8,"input",5)(9,"input",6),t.qZA(),t.TgZ(10,"mat-datepicker-toggle",7),t.NdJ("click",function(){return n.openDatePicker()}),t.qZA()()(),t.BQk(),t.ynx(11,8),t.TgZ(12,"div",9)(13,"div",10),t.YNc(14,Nt,2,2,"button",11),t.TgZ(15,"button",12),t.NdJ("click",function(){return n.blockEquipment()}),t._uU(16),t.qZA()()(),t.BQk(),t.qZA()),2&e&&(t.Q6J("headerTitle",n.ModalEnum.BlockTitle),t.xp6(2),t.Q6J("equipment",n.equipment),t.xp6(1),t.Q6J("formGroup",n.form),t.xp6(4),t.Q6J("min",n.minDate),t.xp6(1),t.Q6J("lcValidationErrors",n.formName),t.xp6(1),t.Q6J("lcValidationErrors",n.formName),t.xp6(5),t.Q6J("ngIf",null==n.equipment?null:n.equipment.blockingPeriods),t.xp6(2),t.hij(" ",n.ModalEnum.BlockApplyButtonText," "))},dependencies:[m.O5,A.m,R.D,x.lW,v.nW,v.wx,v.zY,v.By,p.ZT,b.KE,b.hX,b.R9,a._Y,a.Fj,a.JJ,a.JL,a.sg,a.u,gt],styles:["[_nghost-%COMP%]{display:block}form[_ngcontent-%COMP%]{margin-top:24px}form[_ngcontent-%COMP%]   mat-form-field[_ngcontent-%COMP%]{width:100%}form[_ngcontent-%COMP%]   .date[_ngcontent-%COMP%]{max-width:200px}.buttons[_ngcontent-%COMP%]{display:flex;justify-content:flex-end;align-items:center}.buttons[_ngcontent-%COMP%]   .cancel[_ngcontent-%COMP%]{font-style:normal;font-weight:500;color:#00677f}.buttons[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{font-style:normal;font-weight:400;margin-right:24px;line-height:20px;text-transform:uppercase;height:56px;border-radius:10px}.buttons[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]:last-child{margin-right:0}"],changeDetection:0})};tt=(0,D.gn)([d.c],tt);var O=s(3612),Et=s(617);function Ft(u,o){1&u&&(t.ynx(0),t._uU(1," \u0412 \u044d\u0442\u0438 \u0434\u0430\u0442\u044b \u043e\u0431\u043e\u0440\u0443\u0434\u043e\u0432\u0430\u043d\u0438\u0435 \u0437\u0430\u0431\u0440\u043e\u043d\u0438\u0440\u043e\u0432\u0430\u043d\u043e. \u0411\u043b\u043e\u043a\u0438\u0440\u043e\u0432\u043a\u0430 \u0441\u0431\u0440\u043e\u0441\u0438\u0442 \u0434\u0430\u043d\u043d\u043e\u0435 \u0431\u0440\u043e\u043d\u0438\u0440\u043e\u0432\u0430\u043d\u0438\u0435. "),t.BQk())}function Jt(u,o){1&u&&(t.ynx(0),t._uU(1," \u0410\u0440\u0445\u0438\u0432\u0438\u0440\u043e\u0432\u0430\u043d\u0438\u0435 \u0441\u0431\u0440\u043e\u0441\u0438\u0442 \u0432\u0441\u0435 \u0431\u0440\u043e\u043d\u0438\u0440\u043e\u0432\u0430\u043d\u0438\u044f \u0434\u0430\u043d\u043d\u043e\u0433\u043e \u043e\u0431\u043e\u0440\u0443\u0434\u043e\u0432\u0430\u043d\u0438\u044f. "),t.BQk())}let Rt=(()=>{class u{constructor(e){this.action=e,this.actions=O.v,this.header="",this.actionText=""}ngOnInit(){switch(this.action){case this.actions.Block:this.header=g.BlockTitle,this.actionText=g.BlockApplyButtonText;break;case this.actions.Archivate:this.header=g.ArchiveTitle,this.actionText=g.ArchiveApplyButtonText}}static#t=this.\u0275fac=function(n){return new(n||u)(t.Y36(p.WI))};static#e=this.\u0275cmp=t.Xpm({type:u,selectors:[["lc-order-notification-modal"]],decls:17,vars:6,consts:[[3,"headerTitle"],["body",""],[1,"content"],[4,"ngIf"],["fontSet","material-icons-outlined"],["footer",""],[1,"buttons"],["mat-button","",1,"cancel",3,"mat-dialog-close"],["mat-raised-button","","color","primary",3,"mat-dialog-close"]],template:function(n,i){1&n&&(t.TgZ(0,"lc-modal-layout",0),t.ynx(1,1),t.TgZ(2,"div",2)(3,"p"),t.YNc(4,Ft,2,0,"ng-container",3),t.YNc(5,Jt,2,0,"ng-container",3),t.qZA(),t.TgZ(6,"p"),t._uU(7," \u0414\u043b\u044f \u043f\u0440\u043e\u0441\u043c\u043e\u0442\u0440\u0430 \u0441\u043f\u0438\u0441\u043a\u0430 \u0437\u0430\u044f\u0432\u043e\u043a \u043d\u0430 \u0434\u0430\u043d\u043d\u043e\u0435 \u043e\u0431\u043e\u0440\u0443\u0434\u043e\u0432\u0430\u043d\u0438\u0435, \u0432\u043e\u0441\u043f\u043e\u043b\u044c\u0437\u0443\u0439\u0442\u0435\u0441\u044c \u043a\u043d\u043e\u043f\u043a\u043e\u0439 "),t.TgZ(8,"mat-icon",4),t._uU(9,"list_alt"),t.qZA(),t._uU(10," \u0432 \u0442\u0430\u0431\u043b\u0438\u0446\u0435 \u043e\u0431\u043e\u0440\u0443\u0434\u043e\u0432\u0430\u043d\u0438\u044f. "),t.qZA()(),t.BQk(),t.ynx(11,5),t.TgZ(12,"div",6)(13,"button",7),t._uU(14," \u041e\u0442\u043c\u0435\u043d\u0438\u0442\u044c "),t.qZA(),t.TgZ(15,"button",8),t._uU(16),t.qZA()(),t.BQk(),t.qZA()),2&n&&(t.Q6J("headerTitle",i.header),t.xp6(4),t.Q6J("ngIf",i.action===i.actions.Block),t.xp6(1),t.Q6J("ngIf",i.action===i.actions.Archivate),t.xp6(8),t.Q6J("mat-dialog-close",!1),t.xp6(2),t.Q6J("mat-dialog-close",!0),t.xp6(1),t.hij(" ",i.actionText," "))},dependencies:[m.O5,A.m,x.lW,p.ZT,Et.Hw],styles:["p[_ngcontent-%COMP%]{margin-bottom:0;color:#000000de;font-size:14px;font-weight:400;line-height:22px;letter-spacing:.1px;word-wrap:break-word}mat-icon[_ngcontent-%COMP%]{position:relative;top:8px}.buttons[_ngcontent-%COMP%]{display:flex;justify-content:flex-end;align-items:center}.buttons[_ngcontent-%COMP%]   .cancel[_ngcontent-%COMP%]{margin-right:24px;font-style:normal;font-weight:500;color:#00677f}.buttons[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{height:56px;border-radius:10px;font-style:normal;font-weight:400;line-height:20px;padding:16px;text-transform:uppercase}"],changeDetection:0})}return u})();const Qt={available:null,booked:null,"in use":null,"not available":null,archived:null};var M=function(u){return u.is="\u0435\u0441\u0442\u044c",u.not="\u043d\u0435\u0442",u}(M||{});class Vt{constructor(o){this.category=o.category,this.compensationCost=o.compensationCost,this.description=o.description,this.inventoryNumber=o.inventoryNumber,this.location=o.location,this.maximumDays=o.maximumDays,this.name=o.name,this.petKinds=o.petKinds,this.petSize=o.petSize,this.photoID=o.photoID,this.receiptDate=this.getDate(o.receiptDate),this.status=o.status,this.supplier=o.supplier,this.technicalIssues=o.technicalIssues===M.is,this.termsOfUse=o.termsOfUse,this.title=o.title,this.subCategory=o.subCategory,this.nameSubstring="str",o.condition&&(this.condition=o.condition),o.nameSubstring&&(this.nameSubstring=o.nameSubstring)}getDate(o){return Number(`${o.getTime()}`.slice(0,-3))}}const Ct=1e50,_={maxWidth:472,minWidth:472,autoFocus:!1};var xt=function(u){return u.Users="\u041f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u0438",u.Equipment="\u041e\u0431\u043e\u0440\u0443\u0434\u043e\u0432\u0430\u043d\u0438\u0435",u}(xt||{}),c=s(2559);const Yt=[{header:"\u0418\u043d\u0432\u0435\u043d\u0442\u0430\u0440\u043d\u044b\u0439 \u043d\u043e\u043c\u0435\u0440",columnDef:"inventoryNumber",style:{"width.px":150}},{header:"\u041d\u0430\u0437\u0432\u0430\u043d\u0438\u0435",columnDef:"name",style:null},{header:"\u041d\u0430\u0438\u043c\u0435\u043d\u043e\u0432\u0430\u043d\u0438\u0435",columnDef:"title",style:null},{header:"\u041a\u0430\u0442\u0435\u0433\u043e\u0440\u0438\u044f",columnDef:"categoryName",style:{"width.px":150}},{header:"\u0421\u0442\u0430\u0442\u0443\u0441",columnDef:"statusName",style:{"width.px":150}},{header:"",columnDef:c.vk.Block,action:c.vk.Block,tooltip:"\u0411\u043b\u043e\u043a\u0438\u0440\u043e\u0432\u043a\u0430",style:{"width.px":32,"padding.px":0}},{header:"",columnDef:c.vk.Edit,action:c.vk.Edit,tooltip:"\u0420\u0435\u0434\u0430\u043a\u0442\u0438\u0440\u043e\u0432\u0430\u043d\u0438\u0435",style:{"width.px":32,"padding.px":0}},{header:"",columnDef:c.vk.Archivate,action:c.vk.Archivate,tooltip:"\u0410\u0440\u0445\u0438\u0432\u0438\u0440\u043e\u0432\u0430\u043d\u0438\u0435",style:{"width.px":32,"padding.px":0}},{header:"",columnDef:c.vk.Orders,action:c.vk.Orders,tooltip:"\u041f\u0435\u0440\u0435\u0439\u0442\u0438 \u043a \u0437\u0430\u044f\u0432\u043a\u0430\u043c",style:{"width.px":32,"padding.px":0}}],Lt={available:"\u0421\u0432\u043e\u0431\u043e\u0434\u043d\u043e ",booked:"\u0417\u0430\u0431\u0440\u043e\u043d\u0438\u0440\u043e\u0432\u0430\u043d\u043e ","in use":"\u0418\u0441\u043f\u043e\u043b\u044c\u0437\u0443\u0435\u0442\u0441\u044f ","not available":"\u0417\u0430\u0431\u043b\u043e\u043a\u0438\u0440\u043e\u0432\u0430\u043d\u043e ",archived:"\u0412 \u0430\u0440\u0445\u0438\u0432\u0435"};var w=function(u){return u.Profile="\u041f\u0440\u043e\u0444\u0438\u043b\u044c",u.Block="\u0411\u043b\u043e\u043a\u0438\u0440\u043e\u0432\u043a\u0430",u.Delete="\u0423\u0434\u0430\u043b\u0435\u043d\u0438\u0435",u.NoDelete="\u0423\u0434\u0430\u043b\u0438\u0442\u044c \u043c\u043e\u0436\u043d\u043e \u0442\u043e\u043b\u044c\u043a\u043e \u0437\u0430\u0431\u043b\u043e\u043a\u0438\u0440\u043e\u0432\u0430\u043d\u043d\u043e\u0433\u043e \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044f",u}(w||{});const Gt=[{header:"\u042d\u043b\u0435\u043a\u0442\u0440\u043e\u043d\u043d\u0430\u044f \u043f\u043e\u0447\u0442\u0430",columnDef:"email",style:{"minWidth.px":200}},{header:"\u0422\u0435\u043b\u0435\u0444\u043e\u043d",columnDef:"phone_umber",style:{"minWidth.px":150}},{header:"\u0424\u0430\u043c\u0438\u043b\u0438\u044f",columnDef:"surname",style:{"minWidth.px":200}},{header:"\u0418\u043c\u044f",columnDef:"name",style:{"minWidth.px":200}},{header:"\u0421\u0442\u0430\u0442\u0443\u0441",columnDef:"statusName",style:{"width.px":150}},{header:"",columnDef:c.Vw.Profile,action:c.Vw.Profile,tooltip:w.Profile,style:{"width.px":32,"padding.px":0}},{header:"",columnDef:c.Vw.Block,action:c.Vw.Block,tooltip:w.Block,style:{"width.px":32,"padding.px":0}},{header:"",columnDef:c.Vw.Delete,action:c.Vw.Delete,tooltip:w.NoDelete,style:{"width.px":32,"padding.px":0}}];var f=function(u){return u.CancelButtonText="\u041e\u0442\u043c\u0435\u043d\u0438\u0442\u044c",u.BlockTitle="\u0411\u043b\u043e\u043a\u0438\u0440\u043e\u0432\u0430\u0442\u044c \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044f",u.BlockButtonText="\u0411\u043b\u043e\u043a\u0438\u0440\u043e\u0432\u0430\u0442\u044c",u.BlockConfirmationText="\u0412\u044b \u0443\u0432\u0435\u0440\u0435\u043d\u044b, \u0447\u0442\u043e \u0445\u043e\u0442\u0438\u0442\u0435 \u0437\u0430\u0431\u043b\u043e\u043a\u0438\u0440\u043e\u0432\u0430\u0442\u044c \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044f",u.BlockDescriptionText="\u0412\u044b\u0431\u0440\u0430\u043d\u043d\u044b\u0439 \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044c \u043d\u0435 \u0431\u0443\u0434\u0435\u0442 \u0438\u043c\u0435\u0442\u044c \u0432\u043e\u0437\u043c\u043e\u0436\u043d\u043e\u0441\u0442\u044c \u0440\u0435\u0434\u0430\u043a\u0442\u0438\u0440\u043e\u0432\u0430\u0442\u044c \u0441\u0432\u043e\u0439 \u043f\u0440\u043e\u0444\u0438\u043b\u044c \u0438 \u043e\u0441\u0442\u0430\u0432\u043b\u044f\u0442\u044c \u0437\u0430\u044f\u0432\u043a\u0438.",u.UnblockTitle="\u0420\u0430\u0437\u0431\u043b\u043e\u043a\u0438\u0440\u043e\u0432\u0430\u0442\u044c \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044f",u.UnblockButtonText="\u0420\u0430\u0437\u0431\u043b\u043e\u043a\u0438\u0440\u043e\u0432\u0430\u0442\u044c",u.UnblockConfirmationText="\u0412\u044b \u0443\u0432\u0435\u0440\u0435\u043d\u044b, \u0447\u0442\u043e \u0445\u043e\u0442\u0438\u0442\u0435 \u0440\u0430\u0437\u0431\u043b\u043e\u043a\u0438\u0440\u043e\u0432\u0430\u0442\u044c \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044f",u.UnblockDescriptionText="\u0412\u044b\u0431\u0440\u0430\u043d\u043d\u044b\u0439 \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044c \u0431\u0443\u0434\u0435\u0442 \u0438\u043c\u0435\u0442\u044c \u0432\u043e\u0437\u043c\u043e\u0436\u043d\u043e\u0441\u0442\u044c \u0440\u0435\u0434\u0430\u043a\u0442\u0438\u0440\u043e\u0432\u0430\u0442\u044c \u0441\u0432\u043e\u0439 \u043f\u0440\u043e\u0444\u0438\u043b\u044c \u0438 \u043e\u0441\u0442\u0430\u0432\u043b\u044f\u0442\u044c \u0437\u0430\u044f\u0432\u043a\u0438.",u.DeleteTitle="\u0423\u0434\u0430\u043b\u0438\u0442\u044c \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044f",u.DeleteButtonText="\u0423\u0434\u0430\u043b\u0438\u0442\u044c",u.DeleteConfirmationText="\u0412\u044b \u0443\u0432\u0435\u0440\u0435\u043d\u044b, \u0447\u0442\u043e \u0445\u043e\u0442\u0438\u0442\u0435 \u0443\u0434\u0430\u043b\u0438\u0442\u044c \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044f",u}(f||{}),Q=function(u){return u.Blocked="\u041f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044c \u0437\u0430\u0431\u043b\u043e\u043a\u0438\u0440\u043e\u0432\u0430\u043d",u.Unblocked="\u041f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044c \u0440\u0430\u0437\u0431\u043b\u043e\u043a\u0438\u0440\u043e\u0432\u0430\u043d",u.Deleted="\u041f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044c \u0443\u0434\u0430\u043b\u0435\u043d",u}(Q||{}),et=function(u){return u.Active="\u0410\u043a\u0442\u0438\u0432\u0435\u043d",u.Blocked="\u0417\u0430\u0431\u043b\u043e\u043a\u0438\u0440\u043e\u0432\u0430\u043d",u}(et||{}),bt=function(u){return u.name="\u041d\u0430\u0437\u0432\u0430\u043d\u0438\u0435",u.title="\u041d\u0430\u0438\u043c\u0435\u043d\u043e\u0432\u0430\u043d\u0438\u0435",u.description="\u041e\u043f\u0438\u0441\u0430\u043d\u0438\u0435",u.category="\u041a\u0430\u0442\u0435\u0433\u043e\u0440\u0438\u044f",u.technicalIssues="\u0422\u0435\u0445\u043d\u0438\u0447\u0435\u0441\u043a\u0438\u0435 \u041e\u0441\u043e\u0431\u0435\u043d\u043d\u043e\u0441\u0442\u0438",u.condition="\u0421\u043e\u0441\u0442\u043e\u044f\u043d\u0438\u0435 \u0438\u0441\u043f\u0440\u0430\u0432\u043d\u043e\u0441\u0442\u0438",u.inventoryNumber="\u0418\u043d\u0432\u0435\u043d\u0442\u0430\u0440\u043d\u044b\u0439 \u043d\u043e\u043c\u0435\u0440",u.compensationCost="\u041f\u043b\u0430\u0442\u0430 \u0437\u0430 \u043f\u043e\u0440\u0447\u0443 \u043e\u0431\u043e\u0440\u0443\u0434\u043e\u0432\u0430\u043d\u0438\u044f, \u0440\u0443\u0431",u.supplier="\u041f\u043e\u0441\u0442\u0430\u0432\u0449\u0438\u043a",u.termsOfUse="\u0421\u0441\u044b\u043b\u043a\u0430 \u043d\u0430 \u043f\u0440\u0430\u0432\u0438\u043b\u0430 \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u043d\u0438\u044f",u.petKinds="\u0416\u0438\u0432\u043e\u0442\u043d\u043e\u0435",u.petSize="\u0420a\u0437\u043c\u0435\u0440 \u0436\u0438\u0432\u043e\u0442\u043d\u043e\u0433\u043e",u.maximumDays="\u041c\u0430\u043a\u0441\u0438\u043c\u0430\u043b\u044c\u043d\u044b\u0439 \u0441\u0440\u043e\u043a \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u043d\u0438\u044f",u.receiptDate="\u0414\u0430\u0442\u0430 \u043f\u043e\u0441\u0442\u0443\u043f\u043b\u0435\u043d\u0438\u044f \u0432 \u0444\u043e\u043d\u0434",u.photoID="\u0437\u0430\u0433\u0440\u0443\u0437\u0438\u0442\u044c \u0444\u043e\u0442\u043e",u.cancel="\u041e\u0442\u043c\u0435\u043d\u0430",u}(bt||{}),Dt=s(2032),ut=s(8525),nt=s(3680);const jt=["photoInput"];function zt(u,o){if(1&u&&(t.TgZ(0,"mat-option",40),t._uU(1),t.qZA()),2&u){const e=o.$implicit;t.Q6J("value",e.id),t.xp6(1),t.Oqu(e.name)}}function Wt(u,o){if(1&u&&(t.TgZ(0,"mat-option",40),t._uU(1),t.qZA()),2&u){const e=o.$implicit;t.Q6J("value",e),t.xp6(1),t.Oqu(e)}}function Kt(u,o){if(1&u&&(t.TgZ(0,"mat-option",40),t._uU(1),t.qZA()),2&u){const e=o.$implicit;t.Q6J("value",e.id),t.xp6(1),t.hij(" ",e.name," ")}}function Xt(u,o){if(1&u&&(t.TgZ(0,"mat-option",40),t._uU(1),t.qZA()),2&u){const e=o.$implicit;t.Q6J("value",e.id),t.xp6(1),t.Oqu(e.name)}}function Ht(u,o){if(1&u){const e=t.EpF();t.TgZ(0,"form",7)(1,"div",8)(2,"div",9)(3,"mat-form-field",10)(4,"mat-label"),t._uU(5),t.qZA(),t._UZ(6,"input",11),t.qZA(),t.TgZ(7,"mat-form-field",10)(8,"mat-label"),t._uU(9),t.qZA(),t._UZ(10,"input",12),t.qZA()(),t.TgZ(11,"mat-form-field",13)(12,"mat-label"),t._uU(13),t.qZA(),t._UZ(14,"textarea",14),t.qZA()(),t.TgZ(15,"div",8)(16,"div",9)(17,"mat-form-field",15)(18,"mat-label"),t._uU(19),t.qZA(),t.TgZ(20,"mat-select",16),t.YNc(21,zt,2,2,"mat-option",17),t.qZA()(),t.TgZ(22,"mat-form-field",18)(23,"mat-label"),t._uU(24),t.qZA(),t.TgZ(25,"mat-select",19),t.NdJ("valueChange",function(i){t.CHM(e);const r=t.oxw();return t.KtG(r.setConditionState(i))}),t.YNc(26,Wt,2,2,"mat-option",17),t.qZA()()(),t.TgZ(27,"mat-form-field",20)(28,"mat-label"),t._uU(29),t.qZA(),t._UZ(30,"textarea",21),t.qZA()(),t.TgZ(31,"div",8)(32,"mat-form-field",10)(33,"mat-label"),t._uU(34),t.qZA(),t._UZ(35,"input",22),t.qZA(),t.TgZ(36,"mat-form-field",10)(37,"mat-label"),t._uU(38),t.qZA(),t._UZ(39,"input",23),t.qZA()(),t.TgZ(40,"div",8)(41,"mat-form-field",10)(42,"mat-label"),t._uU(43),t.qZA(),t._UZ(44,"input",24),t.qZA(),t.TgZ(45,"mat-form-field",10)(46,"mat-label"),t._uU(47),t.qZA(),t._UZ(48,"input",25),t.qZA()(),t.TgZ(49,"div",8)(50,"mat-form-field",10)(51,"mat-label"),t._uU(52),t.qZA(),t.TgZ(53,"mat-select",26),t.YNc(54,Kt,2,2,"mat-option",17),t.qZA()(),t.TgZ(55,"mat-form-field",18)(56,"mat-label"),t._uU(57),t.qZA(),t.TgZ(58,"mat-select",27),t.YNc(59,Xt,2,2,"mat-option",17),t.qZA()()(),t.TgZ(60,"div",8)(61,"mat-form-field",15)(62,"mat-label"),t._uU(63),t.qZA(),t._UZ(64,"input",28),t.qZA(),t.TgZ(65,"mat-form-field",29)(66,"mat-label"),t._uU(67),t.qZA(),t._UZ(68,"input",30)(69,"mat-datepicker-toggle",31)(70,"mat-datepicker",null,32),t.qZA()(),t.TgZ(72,"div",8)(73,"div",33)(74,"button",34),t.NdJ("click",function(){t.CHM(e);const i=t.oxw();return t.KtG(i.choosePhoto())}),t.TgZ(75,"mat-icon",35),t._uU(76,"photo_camera"),t.qZA(),t._uU(77),t.qZA(),t.TgZ(78,"mat-form-field")(79,"input",36),t.NdJ("keydown",function(i){t.CHM(e);const r=t.oxw();return t.KtG(r.preventDefault(i))}),t.qZA()(),t.TgZ(80,"div",37)(81,"input",38,39),t.NdJ("change",function(i){t.CHM(e);const r=t.oxw();return t.KtG(r.addPhoto(i))}),t.qZA()()()()()}if(2&u){const e=t.MAs(71),n=t.oxw();t.Q6J("formGroup",n.form),t.xp6(5),t.Oqu(n.labels.name),t.xp6(1),t.Q6J("lcValidationErrors",n.formName),t.xp6(3),t.Oqu(n.labels.title),t.xp6(1),t.Q6J("lcValidationErrors",n.formName),t.xp6(3),t.Oqu(n.labels.description),t.xp6(1),t.Q6J("lcValidationErrors",n.formName),t.xp6(5),t.Oqu(n.labels.category),t.xp6(1),t.Q6J("lcValidationErrors",n.formName),t.xp6(1),t.Q6J("ngForOf",n.equipmentCategories),t.xp6(3),t.Oqu(n.labels.technicalIssues),t.xp6(1),t.Q6J("lcValidationErrors",n.formName),t.xp6(1),t.Q6J("ngForOf",n.technicalIssuesOptions),t.xp6(3),t.Oqu(n.labels.condition),t.xp6(1),t.Q6J("maxlength",1e3),t.xp6(4),t.Oqu(n.labels.inventoryNumber),t.xp6(1),t.Q6J("max",n.maxInventoryNumber)("lcValidationErrors",n.formName),t.xp6(3),t.Oqu(n.labels.compensationCost),t.xp6(1),t.Q6J("lcValidationErrors",n.formName),t.xp6(4),t.Oqu(n.labels.supplier),t.xp6(1),t.Q6J("lcValidationErrors",n.formName),t.xp6(3),t.Oqu(n.labels.termsOfUse),t.xp6(1),t.Q6J("lcValidationErrors",n.formName),t.xp6(4),t.Oqu(n.labels.petKinds),t.xp6(1),t.Q6J("lcValidationErrors",n.formName),t.xp6(1),t.Q6J("ngForOf",n.petKinds),t.xp6(3),t.Oqu(n.labels.petSize),t.xp6(1),t.Q6J("lcValidationErrors",n.formName),t.xp6(1),t.Q6J("ngForOf",n.petSizes),t.xp6(4),t.Oqu(n.labels.maximumDays),t.xp6(1),t.Q6J("lcValidationErrors",n.formName),t.xp6(3),t.Oqu(n.labels.receiptDate),t.xp6(1),t.Q6J("matDatepicker",e)("lcValidationErrors",n.formName),t.xp6(1),t.Q6J("for",e),t.xp6(8),t.hij(" ",n.labels.photoID," "),t.xp6(2),t.Q6J("lcValidationErrors",n.formName)}}let te=(()=>{class u{constructor(e,n,i,r){this.data=e,this.formBuilder=n,this.dialogRef=i,this.validationService=r,this.maxInventoryNumber=Ct,this.labels=bt,this.formName="equipment_form",this.inventoryNumberErrorOptions={message:"\u0418\u043d\u0432\u0435\u043d\u0442\u0430\u0440\u043d\u044b\u0439 \u043d\u043e\u043c\u0435\u0440 \u0443\u0436\u0435 \u0441\u0443\u0449\u0435\u0441\u0442\u0432\u0443\u0435\u0442"},this.technicalIssuesOptions=[M.is,M.not],this.equipmentCategories=[],this.petKinds=[],this.petSizes=[],this.modalHeader="",this.actionButtonText="",this.inventoryNumbersValidator=h=>!((!this.equipment||this.equipment.inventoryNumber!==h)&&this.inventoryNumbers&&this.inventoryNumbers.includes(h))}ngOnInit(){this.data.equipment&&(this.equipment={...this.data.equipment}),this.inventoryNumbers=this.data.inventoryNumbers,this.petSizes=this.data.petSizes||[],this.petKinds=this.data.petKinds||[],this.equipmentCategories=this.data.categories||[],this.modalHeader=this.equipment?g.EditEquipmentHeader:g.AddEquipmentHeader,this.actionButtonText=this.equipment?g.EditEquipmentModalButtonText:g.AddEquipmentModalButtonText,this.createForm(this.equipment),this.conditionControl=this.form?.get("condition"),this.photoIdControl=this.form?.get("photoID")}createForm(e){this.form=this.formBuilder.group({category:[e?.category||null,a.kI.required],compensationCost:[this.equipment?.compensationCost||null,[a.kI.required,a.kI.max(9999999999)]],condition:[{value:e?.condition||null,disabled:!e||this.getConditionDisableState(e)},a.kI.maxLength(1e3)],description:[e?.description||"",a.kI.required],inventoryNumber:[e?.inventoryNumber||null,[a.kI.required,a.kI.max(Ct),this.validationService.getCustomValidator(this.inventoryNumberErrorOptions,this.inventoryNumbersValidator)]],location:[1,a.kI.required],maximumDays:[e?.maximumDays||null,[a.kI.required,a.kI.min(1)]],name:[e?.name||"",a.kI.required],nameSubstring:[""],petKinds:[e?.petKinds||[null],a.kI.required],petSize:[e?.petSize?e.petSize:null,a.kI.required],photoID:[e?.photoID||null,a.kI.required],receiptDate:[e?.receiptDate?new Date(e.receiptDate):"",a.kI.required],status:[1,a.kI.required],subCategory:[1],supplier:[e?.supplier||"",[a.kI.required,a.kI.maxLength(50)]],technicalIssues:[e?this.getTechnicalIssuesValue(e):null,[a.kI.required]],termsOfUse:[e?.termsOfUse||"",[a.kI.required,a.kI.maxLength(249)]],title:[e?.title||"",[a.kI.required,a.kI.maxLength(49)]]})}getTechnicalIssuesValue(e){return e.technicalIssues?M.is:M.not}getConditionDisableState(e){return!e.technicalIssues}setConditionState(e){this.setControlState(e===M.is,this.conditionControl)}setControlState(e,n){e?n?.enable():(n?.disable(),n?.setValue(null)),n?.setValidators(e?a.kI.required:null)}choosePhoto(){this.photoInput?.nativeElement.click()}preventDefault(e){e.preventDefault()}addPhoto(e){let n=e.target;this.file=n?.files?.length?n.files[0]:void 0,this.file&&this.photoIdControl?.setValue(this.file.name)}returnEquipment(){this.validationService.emitSubmit(this.formName),this.form?.valid&&this.dialogRef.close({file:this.file,equipment:new Vt(this.form.value)})}static#t=this.\u0275fac=function(n){return new(n||u)(t.Y36(p.WI),t.Y36(a.qu),t.Y36(p.so),t.Y36(J.R))};static#e=this.\u0275cmp=t.Xpm({type:u,selectors:[["lc-equipment"]],viewQuery:function(n,i){if(1&n&&t.Gf(jt,5),2&n){let r;t.iGM(r=t.CRH())&&(i.photoInput=r.first)}},decls:9,vars:5,consts:[[3,"headerTitle"],["body",""],[3,"formGroup",4,"ngIf"],["footer",""],[1,"buttons"],["mat-button","",1,"cancel",3,"mat-dialog-close"],["mat-raised-button","","color","primary",3,"click"],[3,"formGroup"],[1,"row"],[1,"column"],["appearance","fill","floatLabel","auto"],["matInput","","formControlName","name",3,"lcValidationErrors"],["matInput","","formControlName","title",3,"lcValidationErrors"],["width","370px","appearance","fill"],["rows","4","matInput","","formControlName","description",3,"lcValidationErrors"],["floatLabel","auto"],["formControlName","category",3,"lcValidationErrors"],[3,"value",4,"ngFor","ngForOf"],["floatLabel","auto","appearance","fill"],["formControlName","technicalIssues",3,"lcValidationErrors","valueChange"],["appearance","fill"],["matInput","","rows","4","formControlName","condition",3,"maxlength"],["matInput","","type","number","formControlName","inventoryNumber",3,"max","lcValidationErrors"],["matInput","","type","number","formControlName","compensationCost",3,"lcValidationErrors"],["matInput","","formControlName","supplier",3,"lcValidationErrors"],["matInput","","type","url","formControlName","termsOfUse",3,"lcValidationErrors"],["formControlName","petKinds","multiple","",3,"lcValidationErrors"],["formControlName","petSize",3,"lcValidationErrors"],["matInput","","type","number","formControlName","maximumDays",3,"lcValidationErrors"],["floatLabel","auto","appearance","fill",1,"registration-form-field-input"],["matInput","","formControlName","receiptDate",3,"matDatepicker","lcValidationErrors"],["matSuffix","",3,"for"],["picker",""],[1,"photo-field"],["mat-flat-button","","type","button",1,"registration-controls-button",3,"click"],["color","primary"],["matInput","","formControlName","photoID","type","text",3,"lcValidationErrors","keydown"],[1,"hidden"],["type","file",1,"registration-form-field-input",3,"change"],["photoInput",""],[3,"value"]],template:function(n,i){1&n&&(t.TgZ(0,"lc-modal-layout",0),t.ynx(1,1),t.YNc(2,Ht,83,38,"form",2),t.BQk(),t.ynx(3,3),t.TgZ(4,"div",4)(5,"button",5),t._uU(6),t.qZA(),t.TgZ(7,"button",6),t.NdJ("click",function(){return i.returnEquipment()}),t._uU(8),t.qZA()(),t.BQk(),t.qZA()),2&n&&(t.Q6J("headerTitle",i.modalHeader),t.xp6(2),t.Q6J("ngIf",i.form),t.xp6(3),t.Q6J("mat-dialog-close",!1),t.xp6(1),t.hij(" ",i.labels.cancel," "),t.xp6(2),t.hij(" ",i.actionButtonText," "))},dependencies:[m.sg,m.O5,A.m,R.D,x.lW,v.Mq,v.hl,v.nW,p.ZT,Et.Hw,Dt.Nt,b.KE,b.hX,b.R9,ut.gD,nt.ey,a._Y,a.Fj,a.wV,a.JJ,a.JL,a.nD,a.Fd,a.sg,a.u],styles:["form[_ngcontent-%COMP%]{width:789px}form[_ngcontent-%COMP%]   .row[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:flex-start;margin-bottom:16px}form[_ngcontent-%COMP%]   .column[_ngcontent-%COMP%]{width:370px}form[_ngcontent-%COMP%]   .column[_ngcontent-%COMP%]   mat-form-field[_ngcontent-%COMP%]{margin-bottom:16px}form[_ngcontent-%COMP%]   .column[_ngcontent-%COMP%]   mat-form-field[_ngcontent-%COMP%]:last-child{margin-bottom:0}form[_ngcontent-%COMP%]   .condition[_ngcontent-%COMP%]{height:56px}form[_ngcontent-%COMP%]   mat-form-field[_ngcontent-%COMP%]{width:370px}textarea[_ngcontent-%COMP%]{resize:none;height:157px}.photo-field[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{height:54px;margin-right:5px}.photo-field[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{font-size:24px;width:24px;height:24px}.photo-field[_ngcontent-%COMP%]   mat-form-field[_ngcontent-%COMP%]{width:188px}.buttons[_ngcontent-%COMP%]{display:flex;justify-content:flex-end;align-items:center}.buttons[_ngcontent-%COMP%]   .cancel[_ngcontent-%COMP%]{margin-right:24px;font-style:normal;font-weight:500;color:#00677f}.buttons[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{height:56px;border-radius:10px;font-style:normal;font-weight:400;line-height:20px;padding:16px;text-transform:uppercase}.hidden[_ngcontent-%COMP%]{display:none}"],changeDetection:0})}return u})();function ee(u,o){if(1&u&&(t.ynx(0),t.TgZ(1,"p"),t._uU(2),t.TgZ(3,"strong"),t._uU(4),t.qZA(),t._uU(5,"?"),t.qZA(),t.TgZ(6,"p"),t._uU(7),t.qZA(),t.BQk()),2&u){const e=t.oxw();t.xp6(2),t.hij("",e.isUserBlocked?e.ModalEnum.UnblockConfirmationText:e.ModalEnum.BlockConfirmationText," "),t.xp6(2),t.AsE("",e.user.name,"",e.user.surname?" "+e.user.surname:"",""),t.xp6(3),t.Oqu(e.isUserBlocked?e.ModalEnum.UnblockDescriptionText:e.ModalEnum.BlockDescriptionText)}}let ue=(()=>{class u{constructor(){this.ModalEnum=f,this.isUserBlocked=!1}ngOnInit(){this.data&&(this.user=this.data,this.isUserBlocked=this.user.is_readonly)}static#t=this.\u0275fac=function(n){return new(n||u)};static#e=this.\u0275cmp=t.Xpm({type:u,selectors:[["lc-block-user-modal-content"]],inputs:{data:"data"},decls:1,vars:1,consts:[[4,"ngIf"]],template:function(n,i){1&n&&t.YNc(0,ee,8,4,"ng-container",0),2&n&&t.Q6J("ngIf",i.user)},dependencies:[m.O5],changeDetection:0})}return u})();function ne(u,o){if(1&u&&(t.ynx(0),t.TgZ(1,"p"),t._uU(2),t.TgZ(3,"strong"),t._uU(4),t.qZA(),t._uU(5,"?"),t.qZA(),t.BQk()),2&u){const e=t.oxw();t.xp6(2),t.hij("",e.ModalEnum.DeleteConfirmationText," "),t.xp6(2),t.AsE("",e.user.name,"",e.user.surname?" "+e.user.surname:"","")}}let oe=(()=>{class u{constructor(){this.ModalEnum=f}ngOnInit(){this.data&&(this.user=this.data)}static#t=this.\u0275fac=function(n){return new(n||u)};static#e=this.\u0275cmp=t.Xpm({type:u,selectors:[["lc-delete-user-modal-content"]],inputs:{data:"data"},decls:1,vars:1,consts:[[4,"ngIf"]],template:function(n,i){1&n&&t.YNc(0,ne,6,3,"ng-container",0),2&n&&t.Q6J("ngIf",i.user)},dependencies:[m.O5],encapsulation:2,changeDetection:0})}return u})();var P=function(u){return u.AssignTitle="\u041d\u0430\u0437\u043d\u0430\u0447\u0438\u0442\u044c \u0440\u043e\u043b\u044c",u.AssignButtonText="\u041d\u0430\u0437\u043d\u0430\u0447\u0438\u0442\u044c",u.DeleteTitle="\u0423\u0434\u0430\u043b\u0438\u0442\u044c \u0440\u043e\u043b\u044c",u.DeleteButtonText="\u0423\u0434\u0430\u043b\u0438\u0442\u044c",u.DeleteConfirmationText="\u0412\u044b \u0443\u0432\u0435\u0440\u0435\u043d\u044b, \u0447\u0442\u043e \u0445\u043e\u0442\u0438\u0442\u0435 \u0443\u0434\u0430\u043b\u0438\u0442\u044c \u0440\u043e\u043b\u044c",u.CancelButtonText="\u041e\u0442\u043c\u0435\u043d\u0438\u0442\u044c",u.User="\u041f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044c",u.Role="\u0420\u043e\u043b\u044c",u}(P||{});function ie(u,o){if(1&u&&(t.ynx(0),t.TgZ(1,"p"),t._uU(2),t.TgZ(3,"strong"),t._uU(4),t.qZA(),t._uU(5," \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044f "),t.TgZ(6,"strong"),t._uU(7),t.qZA(),t._uU(8,"?"),t.qZA(),t.BQk()),2&u){const e=t.oxw();t.xp6(2),t.hij("",e.ModalEnum.DeleteConfirmationText," "),t.xp6(2),t.Oqu(e.user.role.name),t.xp6(3),t.AsE("",e.user.name,"",e.user.surname?" "+e.user.surname:"","")}}let ae=(()=>{class u{constructor(){this.ModalEnum=P}ngOnInit(){this.data&&(this.user=this.data)}static#t=this.\u0275fac=function(n){return new(n||u)};static#e=this.\u0275cmp=t.Xpm({type:u,selectors:[["lc-delete-role-modal-content"]],inputs:{data:"data"},decls:1,vars:1,consts:[[4,"ngIf"]],template:function(n,i){1&n&&t.YNc(0,ie,9,4,"ng-container",0),2&n&&t.Q6J("ngIf",i.user)},dependencies:[m.O5],changeDetection:0})}return u})();var se=s(7921),ot=s(4630);function re(u,o){if(1&u&&(t.TgZ(0,"mat-option",13)(1,"div",14)(2,"p",15),t._uU(3),t.qZA(),t.TgZ(4,"p",16),t._uU(5),t.qZA()()()),2&u){const e=o.$implicit;t.Q6J("value",e),t.xp6(3),t.AsE("",e.name," ",e.surname,""),t.xp6(2),t.Oqu(e.email)}}function le(u,o){if(1&u&&(t.TgZ(0,"mat-option",13),t._uU(1),t.qZA()),2&u){const e=o.$implicit;t.Q6J("value",e.id),t.xp6(1),t.Oqu(e.name)}}let it=class pt{constructor(o,e,n,i){this.data=o,this.formBuilder=e,this.validationService=n,this.dialogRef=i,this.formName="role_assignment_form",this.labels=P,this.roles=[],this.form=this.formBuilder.group({user:[null,a.kI.required],role:[null,a.kI.required]})}ngOnInit(){this.roles=this.data.roles,this.filteredUserOptions$=this.form.get("user")?.valueChanges.pipe((0,se.O)(""),(0,C.U)(o=>{const e="string"==typeof o?o:o&&o?.name;return e?this.filterUsersByName(e):this.data.users.slice()}),(0,d.t)(this))}getUserName(o){return o&&o.name?`${o.name} ${o.surname}`:""}filterUsersByName(o){const e=o.toLowerCase();return this.data.users.filter(n=>n.name.toLowerCase().includes(e)||n.surname.toLowerCase().includes(e)||n.email.toLowerCase().includes(e))}assignRole(){const{role:o,user:e}=this.form.value;this.validationService.emitSubmit(this.formName),this.form?.valid&&this.dialogRef.close({roleId:o&&o,userId:e&&e.id})}static#t=this.\u0275fac=function(e){return new(e||pt)(t.Y36(p.WI),t.Y36(a.qu),t.Y36(J.R),t.Y36(p.so))};static#e=this.\u0275cmp=t.Xpm({type:pt,selectors:[["lc-assign-role-modal"]],decls:18,vars:15,consts:[[3,"headerTitle"],["body",""],[1,"form",3,"formGroup"],["appearance","fill",1,"field"],["type","text","matInput","","formControlName","user",3,"placeholder","matAutocomplete","lcValidationErrors"],[3,"displayWith"],["auto","matAutocomplete"],[3,"value",4,"ngFor","ngForOf"],["formControlName","role",3,"placeholder","lcValidationErrors"],["footer",""],[1,"buttons"],["mat-button","",1,"cancel",3,"mat-dialog-close"],["mat-raised-button","","color","primary",3,"click"],[3,"value"],[1,"option"],[1,"option-title"],[1,"option-subtitle"]],template:function(e,n){if(1&e&&(t.TgZ(0,"lc-modal-layout",0),t.ynx(1,1),t.TgZ(2,"form",2)(3,"mat-form-field",3),t._UZ(4,"input",4),t.TgZ(5,"mat-autocomplete",5,6),t.YNc(7,re,6,4,"mat-option",7),t.ALo(8,"async"),t.qZA()(),t.TgZ(9,"mat-form-field",3)(10,"mat-select",8),t.YNc(11,le,2,2,"mat-option",7),t.qZA()()(),t.BQk(),t.ynx(12,9),t.TgZ(13,"div",10)(14,"button",11),t._uU(15),t.qZA(),t.TgZ(16,"button",12),t.NdJ("click",function(){return n.assignRole()}),t._uU(17),t.qZA()(),t.BQk(),t.qZA()),2&e){const i=t.MAs(6);t.Q6J("headerTitle",n.labels.AssignTitle),t.xp6(2),t.Q6J("formGroup",n.form),t.xp6(2),t.s9C("placeholder",n.labels.User),t.Q6J("matAutocomplete",i)("lcValidationErrors",n.formName),t.xp6(1),t.Q6J("displayWith",n.getUserName),t.xp6(2),t.Q6J("ngForOf",t.lcZ(8,13,n.filteredUserOptions$)),t.xp6(3),t.s9C("placeholder",n.labels.Role),t.Q6J("lcValidationErrors",n.formName),t.xp6(1),t.Q6J("ngForOf",n.roles),t.xp6(3),t.Q6J("mat-dialog-close",!1),t.xp6(1),t.hij(" ",n.labels.CancelButtonText," "),t.xp6(2),t.hij(" ",n.labels.AssignButtonText," ")}},dependencies:[m.sg,A.m,R.D,x.lW,p.ZT,Dt.Nt,b.KE,ut.gD,nt.ey,ot.XC,ot.ZL,a._Y,a.Fj,a.JJ,a.JL,a.sg,a.u,m.Ov],styles:[".form[_ngcontent-%COMP%]{display:flex;flex-direction:column}.option[_ngcontent-%COMP%]{display:flex;flex-direction:column;line-height:.8;padding:10px 0}.option-subtitle[_ngcontent-%COMP%]{font-size:14px;color:#656565}.buttons[_ngcontent-%COMP%]{display:flex;justify-content:flex-end;align-items:center}.buttons[_ngcontent-%COMP%]   .cancel[_ngcontent-%COMP%]{margin-right:24px;font-style:normal;font-weight:500;color:#00677f}.buttons[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{height:56px;border-radius:10px;font-style:normal;font-weight:400;line-height:20px;padding:16px;text-transform:uppercase}.field[_ngcontent-%COMP%]{margin-bottom:22px}"],changeDetection:0})};it=(0,D.gn)([d.c],it);var S=function(u){return u.inReview="in review",u.approved="approved",u.inProgress="in progress",u.rejected="rejected",u.closed="closed",u.prepared="prepared",u.overdue="overdue",u.blocked="blocked",u}(S||{});function ce(u,o){if(1&u&&(t.TgZ(0,"mat-option",18),t._uU(1),t.qZA()),2&u){const e=o.$implicit;t.Q6J("value",e.name),t.xp6(1),t.Oqu(e.translation)}}function pe(u,o){if(1&u&&(t.TgZ(0,"mat-form-field",15)(1,"mat-label"),t._uU(2,"\u041d\u043e\u0432\u044b\u0439 \u0441\u0442\u0430\u0442\u0443\u0441"),t.qZA(),t.TgZ(3,"mat-select",16),t.YNc(4,ce,2,2,"mat-option",17),t.qZA()()),2&u){const e=t.oxw(2);t.xp6(3),t.Q6J("lcValidationErrors",e.formName),t.xp6(1),t.Q6J("ngForOf",e.statuses)}}function me(u,o){if(1&u&&(t.TgZ(0,"div",7),t._UZ(1,"lc-fake-input",8)(2,"lc-fake-input",9)(3,"lc-fake-input",10)(4,"lc-fake-input",11),t.TgZ(5,"div",12),t._UZ(6,"lc-fake-input",13),t.YNc(7,pe,5,2,"mat-form-field",14),t.qZA()()),2&u){const e=t.oxw();t.xp6(1),t.Q6J("text",e.equipment.title),t.xp6(1),t.Q6J("text",e.equipment.name),t.xp6(1),t.Q6J("text",e.equipment.inventoryNumber),t.xp6(1),t.Q6J("text",e.rentPeriod),t.xp6(1),t.Q6J("formGroup",e.form),t.xp6(1),t.Q6J("text",e.statusName),t.xp6(1),t.Q6J("ngIf",e.statuses)}}let de=(()=>{class u{constructor(e,n,i,r){this.data=e,this.dialogRef=n,this.validationService=i,this.fb=r,this.formName="application status form",this.statuses=[],this.rentPeriod="",this.statusName="",this.form=this.fb.group({newStatusId:[null,a.kI.required]})}ngOnInit(){const e=this.data;this.equipment=e.application.equipments[0],this.rentPeriod=e.rentPeriod,this.statusName=e.statusTranslation,this.statuses=this.getStatuses(e.statuses,e.application.last_status.status)}getStatuses(e,n){return e.filter(i=>{const r=i.name;return r!==n&&r!==S.inProgress})}saveStatus(){this.validationService.emitSubmit(this.formName),this.form.valid&&this.dialogRef.close(this.form.value.newStatusId)}static#t=this.\u0275fac=function(n){return new(n||u)(t.Y36(p.WI),t.Y36(p.so),t.Y36(J.R),t.Y36(a.qu))};static#e=this.\u0275cmp=t.Xpm({type:u,selectors:[["lc-edit-application-status"]],decls:9,vars:2,consts:[["headerTitle","\u0418\u0437\u043c\u0435\u043d\u0438\u0442\u044c \u0441\u0442\u0430\u0442\u0443\u0441 \u0437\u0430\u044f\u0432\u043a\u0438"],["body",""],["class","content",4,"ngIf"],["footer",""],[1,"buttons"],["mat-button","",1,"cancel",3,"mat-dialog-close"],["mat-raised-button","","color","primary",3,"click"],[1,"content"],["label","\u041d\u0430\u0437\u0432\u0430\u043d\u0438\u0435",3,"text"],["label","\u041d\u0430\u0438\u043c\u0435\u043d\u043e\u0432\u0430\u043d\u0438\u0435",3,"text"],["label","\u0418\u043d\u0432\u0435\u043d\u0442\u0430\u0440\u043d\u044b\u0439 \u043d\u043e\u043c\u0435\u0440",3,"text"],["label","\u041f\u0435\u0440\u0438\u043e\u0434 \u0431\u0440\u043e\u043d\u0438\u0440\u043e\u0432\u0430\u043d\u0438\u044f",3,"text"],[1,"status",3,"formGroup"],["label","\u0410\u043a\u0442\u0443\u0430\u043b\u044c\u043d\u044b\u0439 \u0441\u0442\u0430\u0442\u0443\u0441",3,"text"],["floatLabel","auto",4,"ngIf"],["floatLabel","auto"],["formControlName","newStatusId",3,"lcValidationErrors"],[3,"value",4,"ngFor","ngForOf"],[3,"value"]],template:function(n,i){1&n&&(t.TgZ(0,"lc-modal-layout",0),t.ynx(1,1),t.YNc(2,me,8,7,"div",2),t.BQk(),t.ynx(3,3),t.TgZ(4,"div",4)(5,"button",5),t._uU(6," \u041e\u0442\u043c\u0435\u043d\u0438\u0442\u044c "),t.qZA(),t.TgZ(7,"button",6),t.NdJ("click",function(){return i.saveStatus()}),t._uU(8," \u0421\u043e\u0445\u0440\u0430\u043d\u0438\u0442\u044c "),t.qZA()(),t.BQk(),t.qZA()),2&n&&(t.xp6(2),t.Q6J("ngIf",i.equipment),t.xp6(3),t.Q6J("mat-dialog-close",!1))},dependencies:[m.sg,m.O5,ft,A.m,R.D,x.lW,p.ZT,b.KE,b.hX,ut.gD,nt.ey,a.JJ,a.JL,a.sg,a.u],styles:[".content[_ngcontent-%COMP%]   lc-fake-input[_ngcontent-%COMP%]{margin-bottom:20px}.content[_ngcontent-%COMP%]   .status[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:flex-end}.content[_ngcontent-%COMP%]   .status[_ngcontent-%COMP%]   lc-fake-input[_ngcontent-%COMP%]{width:200px;margin-bottom:0}.buttons[_ngcontent-%COMP%]{display:flex;justify-content:flex-end;align-items:center}.buttons[_ngcontent-%COMP%]   .cancel[_ngcontent-%COMP%]{margin-right:24px;font-style:normal;font-weight:500;color:#00677f}.buttons[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{height:56px;border-radius:10px;font-style:normal;font-weight:400;line-height:20px;padding:16px;text-transform:uppercase}"],changeDetection:0})}return u})();var I=function(u){return u.added="\u041e\u0431\u043e\u0440\u0443\u0434\u043e\u0432\u0430\u043d\u0438\u0435 \u0434\u043e\u0431\u0430\u0432\u043b\u0435\u043d\u043e",u.archived="\u0431\u044b\u043b\u043e \u0437\u0430\u0430\u0440\u0445\u0438\u0432\u0438\u0440\u043e\u0432\u0430\u043d\u043e!",u.blocked="\u0431\u044b\u043b\u043e \u0437\u0430\u0431\u043b\u043e\u043a\u0438\u0440\u043e\u0432\u0430\u043d\u043e!",u.edited="\u041e\u0431\u043e\u0440\u0443\u0434\u043e\u0432\u0430\u043d\u0438\u0435 \u043e\u0442\u0440\u0435\u0434\u0430\u043a\u0442\u0438\u0440\u043e\u0432\u0430\u043d\u043e",u.unblocked="\u041e\u0431\u043e\u0440\u0443\u0434\u043e\u0432\u0430\u043d\u0438\u0435 \u0440\u0430\u0437\u0431\u043b\u043e\u043a\u0438\u0440\u043e\u0432\u0430\u043d\u043e",u}(I||{});const yt={[c.vk.Archivate]:{tooltip:"",disabled:!1},[c.vk.Edit]:{tooltip:"",disabled:!1},[c.vk.Block]:{tooltip:"",disabled:!1},[c.vk.Orders]:{tooltip:"",disabled:!1}};var V=s(7626),$=s(543);let he=(()=>{class u{createDictionary(e,n){e.forEach(i=>n[i.id]=i.translation||i.name)}getDictionaryValue(e,n){return e[n]||void 0}static#t=this.\u0275fac=function(n){return new(n||u)};static#e=this.\u0275prov=t.Yz7({token:u,factory:u.\u0275fac,providedIn:"root"})}return u})();var B=s(186);let Y=class z{get equipmentData$(){return this.equipmentDataSubj$.asObservable()}constructor(o,e,n,i,r,h){this.dialog=o,this.api=e,this.notificationService=n,this.mainHeaderService=i,this.dictionaryService=r,this.store=h,this.equipmentDataSubj$=new F.X([]),this.inventoryNumbers=[],this.categoryDictionary={},this.statusDictionary={},this.statusIdsDictionary={...Qt}}manageEvent(o){switch(o.action){case O.v.Block:this.manageBlock(o);break;case O.v.Edit:this.manageEquipment(o.row.entity);break;case O.v.Archivate:this.archivateEquipment(o)}}fetchEquipments(){return this.api.getAllEquipment().pipe((0,q.b)(o=>this.inventoryNumbers=o.items.map(e=>e.inventoryNumber)),(0,C.U)(o=>this.createRows(o.items)),(0,q.b)(o=>this.equipmentDataSubj$.next(o)))}createRows(o){return o.map(e=>({entity:e,name:e.name,title:e.title,inventoryNumber:e.inventoryNumber,categoryName:this.getCategoryName(e),statusName:this.getStatusName(e),actions:this.getActions(e)}))}getStatusName(o){return this.dictionaryService.getDictionaryValue(this.statusDictionary,o.status)||""}getCategoryName(o){return this.dictionaryService.getDictionaryValue(this.categoryDictionary,o.category)||""}getActions(o){return o.status===this.statusIdsDictionary.archived?{...yt,[O.v.Archivate]:{tooltip:"",disabled:!0},[O.v.Edit]:{tooltip:"",disabled:!0},[O.v.Block]:{tooltip:"",disabled:!0}}:{...yt}}manageBlock(o){const e=o.row.entity;let n;this.api.getUnavailablePeriodsById(e.id).pipe((0,C.U)(r=>(n=r.items?r.items:[],r.items)),(0,l.w)(r=>this.openBlockEquipmentModal(e,r)),(0,E.h)(Boolean),(0,l.w)(r=>"unblock equipment"===r?this.unblockEquipment(e):this.blockEquipment(e,r,n,o.action)),(0,l.w)(()=>this.fetchEquipments()),(0,d.t)(this)).subscribe()}blockEquipment(o,e,n,i){return(0,k.of)(this.isPeriodsIntersect(e,n)).pipe((0,l.w)(r=>r?this.openOrderNotificationModal(i):(0,k.of)(!0)),(0,E.h)(Boolean),(0,l.w)(()=>this.api.blockEquipment(o.id,e)),(0,q.b)(()=>this.notificationService.openSuccess(`${o.title} ${I.blocked}`)))}unblockEquipment(o){return this.api.unblockEquipment(o.id).pipe((0,q.b)(()=>{this.notificationService.openSuccess(`${o.title} ${I.unblocked}`)}))}isPeriodsIntersect(o,e){for(const n of e)if(this.isDateInPeriod(o.startDate,n)||this.isDateInPeriod(o.endDate,n))return!0;return!1}isDateInPeriod(o,e){const n=new Date(e.start_date),i=new Date(e.end_date);return o.getTime(),o>=n&&o<=i}archivateEquipment(o){const e=o.row.entity;this.openArchiveEquipmentModal(e).pipe((0,E.h)(Boolean),(0,l.w)(()=>this.api.getEquipmentUnavailabilityPeriods(e.id)),(0,l.w)(n=>n.items&&n.items.length?this.openOrderNotificationModal(o.action):(0,k.of)(!0)),(0,E.h)(Boolean),(0,l.w)(()=>this.api.archiveEquipment(e.id)),(0,l.w)(()=>this.fetchEquipments()),(0,d.t)(this)).subscribe(()=>{this.notificationService.openSuccess(`${e.title} ${I.archived}}`)})}openOrderNotificationModal(o){return this.dialog.open(Rt,{..._,data:o}).afterClosed()}openArchiveEquipmentModal(o){return this.dialog.open(It,{..._,data:o}).afterClosed()}openBlockEquipmentModal(o,e){return this.dialog.open(tt,{..._,data:{equipment:o,unavailablePeriods:e||[]}}).afterClosed()}createCategoryDictionary(o){this.dictionaryService.createDictionary(o,this.categoryDictionary)}createStatusDictionary(o){this.dictionaryService.createDictionary(o,this.statusDictionary)}createEquipmentStatusIds(o){o.forEach(e=>{this.statusIdsDictionary[e.name]=e.id})}manageEquipment(o){this.openEquipmentModal(o).pipe((0,E.h)(Boolean),(0,l.w)(e=>(0,wt.D)({photo:e.file?this.api.uploadPhoto(e.file):(0,k.of)(null),equipment:(0,k.of)(e.equipment)})),(0,l.w)(e=>(e.photo&&(e.equipment.photoID=e.photo.data.id),o?this.api.editEquipment(e.equipment,o.id):this.api.registerEquipment(e.equipment))),(0,l.w)(()=>this.fetchEquipments()),(0,d.t)(this)).subscribe(e=>{this.notificationService.openSuccess(o?I.edited:I.added)})}addNewEquipment(){this.manageEquipment()}openEquipmentModal(o){const e=this.store.snapshot().application_data;return this.dialog.open(te,{autoFocus:!1,data:{inventoryNumbers:this.inventoryNumbers||[],equipment:o?this.prepareEquipmentForModal(o):void 0,petKinds:e?.petKinds||[],petSizes:e?.petSizes||[],categories:e?.equipmentCategories||[]}}).afterClosed()}prepareEquipmentForModal(o){const e=this.store.snapshot().application_data.petKinds,n={...o};return n.receiptDate=+`${n.receiptDate}000`,n.petKinds=o.petKinds.map(i=>{if("number"==typeof i)return i;const r=e.find(h=>h.name===i.name);return r?r.id:0}),n}setPageHeader(){this.mainHeaderService.setPageTitle("\u041e\u0431\u043e\u0440\u0443\u0434\u043e\u0432\u0430\u043d\u0438\u0435")}static#t=this.\u0275fac=function(e){return new(e||z)(t.LFG(p.uw),t.LFG(y),t.LFG(V.T),t.LFG($.I),t.LFG(he),t.LFG(B.yh))};static#e=this.\u0275prov=t.Yz7({token:z,factory:z.\u0275fac})};function fe(u,o){if(1&u&&(t.TgZ(0,"p"),t._uU(1),t.qZA()),2&u){const e=t.oxw();t.xp6(1),t.Oqu(e.body)}}function ge(u,o){1&u&&t.GkF(0)}function Ee(u,o){if(1&u&&(t.TgZ(0,"button",8),t._uU(1),t.qZA()),2&u){const e=t.oxw();t.Q6J("mat-dialog-close",!1),t.xp6(1),t.hij(" ",e.cancelButtonText," ")}}function Ce(u,o){if(1&u&&(t.TgZ(0,"button",9),t._uU(1),t.qZA()),2&u){const e=t.oxw();t.Q6J("mat-dialog-close",!0),t.xp6(1),t.hij(" ",e.applyButtonText," ")}}Y=(0,D.gn)([d.c],Y),s(3103),s(3104);const xe=function(u){return{data:u}};let at=(()=>{class u{constructor(e){this.confirmationModalData=e,this.title="",this.contentComponent=null}ngOnInit(){this.title=this.confirmationModalData.title,this.body=this.confirmationModalData.body,this.contentComponent=this.confirmationModalData.contentComponent||null,this.contentComponentData=this.confirmationModalData.contentComponentData,this.applyButtonText=this.confirmationModalData.applyButtonText,this.cancelButtonText=this.confirmationModalData.cancelButtonText}static#t=this.\u0275fac=function(n){return new(n||u)(t.Y36(p.WI))};static#e=this.\u0275cmp=t.Xpm({type:u,selectors:[["lc-confirmation-modal"]],decls:8,vars:8,consts:[[3,"headerTitle"],["body",""],[4,"ngIf"],[4,"ngComponentOutlet","ngComponentOutletInputs"],["footer",""],[1,"buttons"],["mat-button","","class","cancel",3,"mat-dialog-close",4,"ngIf"],["mat-raised-button","","color","primary",3,"mat-dialog-close",4,"ngIf"],["mat-button","",1,"cancel",3,"mat-dialog-close"],["mat-raised-button","","color","primary",3,"mat-dialog-close"]],template:function(n,i){1&n&&(t.TgZ(0,"lc-modal-layout",0),t.ynx(1,1),t.YNc(2,fe,2,1,"p",2),t.YNc(3,ge,1,0,"ng-container",3),t.BQk(),t.ynx(4,4),t.TgZ(5,"div",5),t.YNc(6,Ee,2,2,"button",6),t.YNc(7,Ce,2,2,"button",7),t.qZA(),t.BQk(),t.qZA()),2&n&&(t.Q6J("headerTitle",i.title),t.xp6(2),t.Q6J("ngIf",i.body),t.xp6(1),t.Q6J("ngComponentOutlet",i.contentComponent)("ngComponentOutletInputs",t.VKq(6,xe,i.contentComponentData)),t.xp6(3),t.Q6J("ngIf",i.cancelButtonText),t.xp6(1),t.Q6J("ngIf",i.applyButtonText))},dependencies:[m.$G,m.O5,x.lW,p.ZT,A.m],styles:[".buttons[_ngcontent-%COMP%]{display:flex;justify-content:flex-end;align-items:center}.buttons[_ngcontent-%COMP%]   .cancel[_ngcontent-%COMP%]{font-style:normal;font-weight:500;color:#00677f}.buttons[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{font-style:normal;font-weight:400;margin-right:24px;line-height:20px;text-transform:uppercase;height:56px;border-radius:10px}.buttons[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]:last-child{margin-right:0}"],changeDetection:0})}return u})();var vt=s(9079),L=(s(6341),s(4274),s(2389),s(155),s(7248));const _t={[c.Vw.Profile]:{tooltip:"",disabled:!1},[c.Vw.Block]:{tooltip:"",disabled:!1},[c.Vw.Delete]:{tooltip:"",disabled:!0}};let G=class W{constructor(o,e,n,i){this.api=o,this.notificationService=e,this.dialog=n,this.mainPageHeaderService=i,this.usersSubject$=new F.X([])}get users$(){return this.usersSubject$.asObservable()}setPageTitle(o){this.mainPageHeaderService.setPageTitle(o)}fetchUsers(){return this.api.getAllUsers().pipe((0,q.b)(o=>this.usersSubject$.next(this.createRows(o.items))))}editUser(o){switch(o.action){case c.Vw.Profile:break;case c.Vw.Block:this.updateUserBlockingStatus(o);break;case c.Vw.Delete:this.deleteUser(o)}}updateUserBlockingStatus(o){const e=o.row.entity;this.openBlockUserModal(e).pipe((0,E.h)(Boolean),(0,l.w)(()=>this.api.updateUserReadonlyAccess(e.id,!e.is_readonly)),(0,l.w)(()=>this.fetchUsers()),(0,d.t)(this)).subscribe(()=>{this.notificationService.openSuccess(e.is_readonly?Q.Unblocked:Q.Blocked)})}openBlockUserModal(o){return this.dialog.open(at,{..._,data:{title:o.is_readonly?f.UnblockTitle:f.BlockTitle,contentComponentData:o,contentComponent:ue,applyButtonText:o.is_readonly?f.UnblockButtonText:f.BlockButtonText,cancelButtonText:f.CancelButtonText}}).afterClosed()}deleteUser(o){const e=o.row.entity;this.openDeleteUserModal(e).pipe((0,E.h)(Boolean),(0,l.w)(()=>this.api.deleteUser(e.id)),(0,l.w)(()=>this.fetchUsers()),(0,d.t)(this)).subscribe(()=>{this.notificationService.openSuccess(Q.Deleted)})}openDeleteUserModal(o){return this.dialog.open(at,{..._,data:{title:f.DeleteTitle,contentComponentData:o,contentComponent:oe,applyButtonText:f.DeleteButtonText,cancelButtonText:f.CancelButtonText}}).afterClosed()}createRows(o){return o.map(e=>({...e,entity:e,email:e.email,name:e.name,surname:e.surname,phone_number:e.phone_number,statusName:this.getUserStatus(e),actions:this.getActions(e)}))}getUserStatus(o){return o.is_readonly?et.Blocked:et.Active}getActions(o){return o.is_readonly?{..._t,[c.Vw.Delete]:{tooltip:w.Delete,disabled:!1}}:{..._t}}static#t=this.\u0275fac=function(e){return new(e||W)(t.LFG(y),t.LFG(V.T),t.LFG(p.uw),t.LFG($.I))};static#e=this.\u0275prov=t.Yz7({token:W,factory:W.\u0275fac})};G=(0,D.gn)([d.c],G);var Bt=function(u){return u.Delete="delete",u}(Bt||{}),st=function(u){return u.Deleted="\u0420\u043e\u043b\u044c \u0443\u0434\u0430\u043b\u0435\u043d\u0430",u.Assigned="\u0420\u043e\u043b\u044c \u043d\u0430\u0437\u043d\u0430\u0447\u0435\u043d\u0430",u}(st||{}),Z=s(6150);let j=class K{constructor(o,e,n,i,r){this.api=o,this.notificationService=e,this.dialog=n,this.mainPageHeaderService=i,this.store=r,this.rolesSubject$=new F.X([]),this.roles=this.store.selectSnapshot(Z.in).roles,this.users=[]}get roles$(){return this.rolesSubject$.asObservable()}setPageTitle(){this.mainPageHeaderService.setPageTitle("\u0420\u043e\u043b\u0438")}fetchRoles(){return this.api.getAllUsers().pipe((0,q.b)(o=>{this.users=o.items,this.rolesSubject$.next(this.createRows(o.items))}))}manageEvent(o){o.action===Bt.Delete&&this.deleteRole(o)}assignRole(){this.openAssignRoleModal().pipe((0,E.h)(Boolean),(0,l.w)(o=>this.api.assignRoleToUser(o.userId,o.roleId)),(0,l.w)(()=>this.fetchRoles()),(0,d.t)(this)).subscribe(()=>{this.notificationService.openSuccess(st.Assigned)})}openAssignRoleModal(){return this.dialog.open(it,{..._,data:{roles:this.roles,users:this.users}}).afterClosed()}deleteRole(o){const e=o.row.entity;this.openDeleteRoleModal(e).pipe((0,E.h)(Boolean),(0,l.w)(()=>this.api.assignRoleToUser(e.id,this.userRoleId)),(0,l.w)(()=>this.fetchRoles()),(0,d.t)(this)).subscribe(()=>{this.notificationService.openSuccess(st.Deleted)})}openDeleteRoleModal(o){return this.dialog.open(at,{..._,data:{title:P.DeleteTitle,contentComponentData:o,contentComponent:ae,applyButtonText:P.DeleteButtonText,cancelButtonText:f.CancelButtonText}}).afterClosed()}createRows(o){return o.reduce((e,n)=>(n.role.id!==this.userRoleId&&e.push(this.createTableRow(n)),e),[])}createTableRow(o){return{entity:o,email:o.email,surname:o.surname,name:o.name,roleName:o.role.name}}get userRoleId(){return void 0!==this.userRoleIdSaved||(this.userRoleIdSaved=this.roles.find(o=>"user"===o.slug).id),this.userRoleIdSaved}static#t=this.\u0275fac=function(e){return new(e||K)(t.LFG(y),t.LFG(V.T),t.LFG(p.uw),t.LFG($.I),t.LFG(B.yh))};static#e=this.\u0275prov=t.Yz7({token:K,factory:K.\u0275fac})};j=(0,D.gn)([d.c],j);let Tt=(()=>{class u{constructor(e,n){this.api=e,this.store=n}getRoles(){return this.api.getAllRoles().pipe((0,l.w)(e=>this.store.dispatch(new Z.Dr(e))),(0,C.U)(e=>e.application_data?.roles))}static#t=this.\u0275fac=function(n){return new(n||u)(t.LFG(y),t.LFG(B.yh))};static#e=this.\u0275prov=t.Yz7({token:u,factory:u.\u0275fac})}return u})();var rt=function(u){return u["in review"]="\u041e\u0436\u0438\u0434\u0430\u0435\u0442",u.approved="\u041e\u0434\u043e\u0431\u0440\u0435\u043d\u043e",u["in progress"]="\u0418\u0441\u043f\u043e\u043b\u044c\u0437\u0443\u0435\u0442\u0441\u044f",u.rejected="\u041e\u0442\u043a\u043b\u043e\u043d\u0435\u043d\u043e",u.closed="\u0417\u0430\u043a\u0440\u044b\u0442\u043e",u.prepared="\u0413\u043e\u0442\u043e\u0432\u043e \u043a \u0432\u044b\u0434\u0430\u0447\u0435",u.overdue="\u041f\u0440\u043e\u0441\u0440\u043e\u0447\u0435\u043d\u043e",u.blocked="\u0417\u0430\u0431\u043b\u043e\u043a\u0438\u0440\u043e\u0432\u0430\u043d\u043e",u}(rt||{});let At=(()=>{class u{constructor(e,n){this.api=e,this.store=n}getApplicationStatusNames(){return this.api.getApplicationStatuses().pipe((0,C.U)(e=>this.translateStatuses(e)),(0,l.w)(e=>this.store.dispatch(new Z.IQ(e))),(0,C.U)(e=>e.application_data?.applicationStatuses))}translateStatuses(e){return e.map(n=>({...n,translation:rt[n.name]||""}))}static#t=this.\u0275fac=function(n){return new(n||u)(t.LFG(y),t.LFG(B.yh))};static#e=this.\u0275prov=t.Yz7({token:u,factory:u.\u0275fac})}return u})();const be=function(){return[]};let U=class mt{constructor(o){this.controller=o,this.columns=Yt,this.equipments$=this.controller.equipmentData$}ngOnInit(){this.controller.setPageHeader(),this.controller.fetchEquipments().subscribe(),this.equipmentCategories.pipe((0,d.t)(this)).subscribe(o=>this.controller.createCategoryDictionary(o)),this.equipmentStatuses.pipe((0,d.t)(this)).subscribe(o=>{this.controller.createStatusDictionary(o),this.controller.createEquipmentStatusIds(o)})}editEquipment(o){this.controller.manageEvent(o)}addNewEquipment(){this.controller.addNewEquipment()}static#t=this.\u0275fac=function(e){return new(e||mt)(t.Y36(Y))};static#e=this.\u0275cmp=t.Xpm({type:mt,selectors:[["lc-equipments"]],features:[t._Bn([Y])],decls:7,vars:6,consts:[[3,"columns","limit","data","action"],["mat-raised-button","","color","primary",1,"add-equipment",3,"click"],[1,"content"]],template:function(e,n){1&e&&(t.TgZ(0,"lc-table",0),t.NdJ("action",function(r){return n.editEquipment(r)}),t.ALo(1,"async"),t.qZA(),t.TgZ(2,"button",1),t.NdJ("click",function(){return n.addNewEquipment()}),t.TgZ(3,"div",2)(4,"span"),t._uU(5,"+"),t.qZA(),t._uU(6,"\u0414\u043e\u0431\u0430\u0432\u0438\u0442\u044c \u043e\u0431\u043e\u0440\u0443\u0434\u043e\u0432\u0430\u043d\u0438\u0435"),t.qZA()()),2&e&&t.Q6J("columns",n.columns)("limit",20)("data",t.lcZ(1,3,n.equipments$)||t.DdM(5,be))},dependencies:[L.a,x.lW,m.Ov],styles:["lc-table[_ngcontent-%COMP%]{margin-bottom:30px}.add-equipment[_ngcontent-%COMP%]{position:fixed;bottom:24px;right:24px;height:56px;border-radius:28px;padding:20px}.add-equipment[_ngcontent-%COMP%]   .content[_ngcontent-%COMP%]{display:flex;align-items:center;color:#fff;font-size:14px;font-family:Roboto,serif;font-weight:400;text-transform:uppercase;line-height:24px;letter-spacing:1.25px;word-wrap:break-word}.add-equipment[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{font-size:24px;font-weight:100;margin-right:8px}"],changeDetection:0})};(0,D.gn)([(0,B.Ph)(Z.in.equipmentCategories)],U.prototype,"equipmentCategories",void 0),(0,D.gn)([(0,B.Ph)(Z.in.equipmentStatuses)],U.prototype,"equipmentStatuses",void 0),U=(0,D.gn)([d.c],U);var N=s(4614),De=s(1607);let lt=(()=>{class u{constructor(e,n){this.api=e,this.store=n}getEquipmentStatuses(){return this.api.getEquipmentStatuses().pipe((0,C.U)(e=>this.fillInStatusesTranslations(e)),(0,l.w)(e=>this.store.dispatch(new Z.xs(e))),(0,C.U)(e=>e.application_data?.equipmentStatuses))}fillInStatusesTranslations(e){return e.map(n=>{const i=Lt[n.name];return i&&(n.translation=i),n})}getEquipmentCategories(){return this.api.getEquipmentCategories().pipe((0,l.w)(e=>this.store.dispatch(new Z.FI(e.items))),(0,C.U)(e=>e.application_data?.equipmentCategories))}static#t=this.\u0275fac=function(n){return new(n||u)(t.LFG(y),t.LFG(B.yh))};static#e=this.\u0275prov=t.Yz7({token:u,factory:u.\u0275fac})}return u})(),qt=(()=>{class u{constructor(e){this.equipmentResolverService=e}resolve(){return this.equipmentResolverService.getEquipmentStatuses()}static#t=this.\u0275fac=function(n){return new(n||u)(t.LFG(lt))};static#e=this.\u0275prov=t.Yz7({token:u,factory:u.\u0275fac,providedIn:"root"})}return u})(),Ot=(()=>{class u{constructor(e){this.equipmentResolverService=e}resolve(){return this.equipmentResolverService.getEquipmentCategories()}static#t=this.\u0275fac=function(n){return new(n||u)(t.LFG(lt))};static#e=this.\u0275prov=t.Yz7({token:u,factory:u.\u0275fac,providedIn:"root"})}return u})();const ye=function(){return[]};let ve=(()=>{class u{constructor(e){this.controller=e,this.columns=Gt,this.users$=this.controller.users$}ngOnInit(){this.controller.fetchUsers().subscribe(),this.controller.setPageTitle(xt.Users)}editUser(e){this.controller.editUser(e)}static#t=this.\u0275fac=function(n){return new(n||u)(t.Y36(G))};static#e=this.\u0275cmp=t.Xpm({type:u,selectors:[["lc-users"]],features:[t._Bn([G])],decls:2,vars:5,consts:[[3,"columns","data","action"]],template:function(n,i){1&n&&(t.TgZ(0,"lc-table",0),t.NdJ("action",function(h){return i.editUser(h)}),t.ALo(1,"async"),t.qZA()),2&n&&t.Q6J("columns",i.columns)("data",t.lcZ(1,2,i.users$)||t.DdM(4,ye))},dependencies:[L.a,m.Ov],changeDetection:0})}return u})();const _e=[{header:"\u042d\u043b\u0435\u043a\u0442\u0440\u043e\u043d\u043d\u0430\u044f \u043f\u043e\u0447\u0442\u0430",columnDef:"email",style:{"minWidth.px":200}},{header:"\u0424\u0430\u043c\u0438\u043b\u0438\u044f",columnDef:"surname",style:{"minWidth.px":200}},{header:"\u0418\u043c\u044f",columnDef:"name",style:{"minWidth.px":200}},{header:"\u0420\u043e\u043b\u044c",columnDef:"roleName",style:{"width.px":150}},{header:"",columnDef:c.Vw.Delete,action:c.Vw.Delete,tooltip:"\u0423\u0434\u0430\u043b\u0435\u043d\u0438\u0435",style:{"width.px":32,"padding.px":0}}],Be=function(){return[]};let Te=(()=>{class u{constructor(e){this.controller=e,this.columns=_e,this.data$=this.controller.roles$}ngOnInit(){this.controller.setPageTitle(),this.controller.fetchRoles().subscribe()}editRole(e){this.controller.manageEvent(e)}assignRole(){this.controller.assignRole()}static#t=this.\u0275fac=function(n){return new(n||u)(t.Y36(j))};static#e=this.\u0275cmp=t.Xpm({type:u,selectors:[["lc-roles"]],features:[t._Bn([j])],decls:7,vars:6,consts:[[3,"columns","limit","data","action"],["mat-raised-button","","color","primary",1,"add-role",3,"click"],[1,"content"]],template:function(n,i){1&n&&(t.TgZ(0,"lc-table",0),t.NdJ("action",function(h){return i.editRole(h)}),t.ALo(1,"async"),t.qZA(),t.TgZ(2,"button",1),t.NdJ("click",function(){return i.assignRole()}),t.TgZ(3,"div",2)(4,"span"),t._uU(5,"+"),t.qZA(),t._uU(6,"\u041d\u0430\u0437\u043d\u0430\u0447\u0438\u0442\u044c \u0440\u043e\u043b\u044c"),t.qZA()()),2&n&&t.Q6J("columns",i.columns)("limit",20)("data",t.lcZ(1,3,i.data$)||t.DdM(5,Be))},dependencies:[L.a,x.lW,m.Ov],styles:[".add-role[_ngcontent-%COMP%]{position:fixed;bottom:24px;right:24px;height:56px;border-radius:28px;padding:20px}.add-role[_ngcontent-%COMP%]   .content[_ngcontent-%COMP%]{display:flex;align-items:center;color:#fff;font-size:14px;font-family:Roboto,serif;font-weight:400;text-transform:uppercase;line-height:24px;letter-spacing:1.25px;word-wrap:break-word}.add-role[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{font-size:24px;font-weight:100;margin-right:8px}"],changeDetection:0})}return u})();var T=function(u){return u.edit="edit",u.more="more_horiz",u}(T||{});const qe=[{header:"\u0421\u0442\u0430\u0442\u0443\u0441",columnDef:"status",style:{"width.px":150}},{header:"\u0418\u043d\u0432\u0435\u043d\u0442\u0430\u0440\u043d\u044b\u0439 \u043d\u043e\u043c\u0435\u0440",columnDef:"equipmentInventoryNumber",style:null},{header:"\u041f\u0435\u0440\u0438\u043e\u0434 \u0431\u0440\u043e\u043d\u0438\u0440\u043e\u0432\u0430\u043d\u0438\u044f",columnDef:"rentPeriod",style:null},{header:"\u041d\u0430\u0437\u0432\u0430\u043d\u0438\u0435",columnDef:"equipmentName",style:null},{header:"\u041d\u0430\u0438\u043c\u0435\u043d\u043e\u0432\u0430\u043d\u0438\u0435",columnDef:"equipmentTitle",style:null},{header:"\u0424\u0430\u043c\u0438\u043b\u0438\u044f",columnDef:"userSurname",style:null},{header:"\u0418\u043c\u044f",columnDef:"userName",style:null},{header:"\u0422\u0435\u043b\u0435\u0444\u043e\u043d",columnDef:"userPhoneNumber",style:null},{header:"",columnDef:T.edit,action:T.edit,tooltip:"\u0420\u0435\u0434\u0430\u043a\u0442\u0438\u0440\u043e\u0432\u0430\u043d\u0438\u0435",style:{"width.px":32,"padding.px":0}},{header:"",columnDef:T.more,action:T.more,tooltip:"???",style:{"width.px":32,"padding.px":0}}];let Mt=(()=>{class u{get applicationsData$(){return this.applicationsSub.asObservable()}constructor(e,n,i,r,h){this.api=e,this.dialog=n,this.store=i,this.notificationsService=r,this.mainPageHeaderService=h,this.applicationsSub=new F.X([])}get applicationStatuses(){return this.store.snapshot().application_data?.applicationStatuses||[]}setPageTitle(){this.mainPageHeaderService.setPageTitle("\u0417\u0430\u044f\u0432\u043a\u0438")}fetchApplications(){return this.api.getAllOrders().pipe((0,C.U)(e=>this.createRows(e.items)),(0,q.b)(e=>this.applicationsSub.next(e)))}createRows(e){return e.map(n=>({entity:n,...n,...this.getUserInfo(n.user),...this.getEquipmentInfo(n.equipments),rentPeriod:this.getRentPeriodValue(n),status:this.getApplicationStatusName(n.last_status),actions:this.getRowActions(n)}))}getRowActions(e){const n=e.last_status.status;return{[T.more]:{tooltip:"",disabled:!1},[T.edit]:{tooltip:"",disabled:n===S.closed||n===S.rejected}}}getApplicationStatusName(e){return rt[e.status]||""}getRentPeriodValue(e){const n=new Date(e.rent_start),i=new Date(e.rent_end);return`${n.getDate()}.${n.getMonth()+1}-${i.getDate()}.${i.getMonth()+1}`}getUserInfo(e){return{userName:e.name||"",userSurname:e.surname||"",userPhoneNumber:e.phone_number||""}}getEquipmentInfo(e){const n=e[0]||void 0;return{equipmentName:n?.name||"",equipmentTitle:n?.title||"",equipmentInventoryNumber:n?.inventoryNumber||""}}editApplication(e){e.action===T.edit&&this.editApplicationStatus(e.row.entity)}editApplicationStatus(e){let n;this.openEditApplicationStatusModal(e).pipe((0,E.h)(Boolean),(0,l.w)(i=>(n=i,this.checkNonChangeableStatuses(i))),(0,E.h)(Boolean),(0,l.w)(()=>{const i=this.getChangeStatusBody(e,n);return this.api.editApplicationStatus(i)}),(0,l.w)(()=>this.fetchApplications())).subscribe(()=>this.notificationsService.openSuccess("\u0421\u0442\u0430\u0442\u0443\u0441 \u0437\u0430\u044f\u0432\u043a\u0438 \u0438\u0437\u043c\u0435\u043d\u0435\u043d"))}checkNonChangeableStatuses(e){switch(e){case S.rejected:return this.openNotificationRejectedStatus();case S.closed:return this.openNotificationAboutClosedStatus();default:return(0,k.of)(!0)}}openNotificationAboutClosedStatus(){return this.dialog.open(vt.S,{width:"472px",data:{headerText:'\u0421\u0442\u0430\u0442\u0443\u0441 "\u0417\u0430\u043a\u0440\u044b\u0442\u043e"',infoMessage:'\u0415\u0441\u043b\u0438 \u0412\u044b \u0441\u043e\u0445\u0440\u0430\u043d\u0438\u0442\u0435 \u0437\u0430\u044f\u0432\u043a\u0443 \u0432 \u0441\u0442\u0430\u0442\u0443\u0441\u0435 "\u0417\u0430\u043a\u0440\u044b\u0442\u043e", \u0442\u043e \u0438\u0437\u043c\u0435\u043d\u0438\u0442\u044c \u0441\u0442\u0430\u0442\u0443\u0441 \u044d\u0442\u043e\u0439 \u0437\u0430\u044f\u0432\u043a\u0438 \u0432 \u0431\u0443\u0434\u0443\u0449\u0435\u043c \u0431\u0443\u0434\u0435\u0442 \u043d\u0435\u0432\u043e\u0437\u043c\u043e\u0436\u043d\u043e.',buttonOkText:"\u0421\u043e\u0445\u0440\u0430\u043d\u0438\u0442\u044c",buttonCancelText:"\u041e\u0442\u043c\u0435\u043d\u0438\u0442\u044c"}}).afterClosed()}openNotificationRejectedStatus(){return this.dialog.open(vt.S,{width:"472px",data:{headerText:'\u0421\u0442\u0430\u0442\u0443\u0441 "\u041e\u0442\u043a\u043b\u043e\u043d\u0435\u043d\u043e"',infoMessage:'\u0415\u0441\u043b\u0438 \u0412\u044b \u0441\u043e\u0445\u0440\u0430\u043d\u0438\u0442\u0435 \u0437\u0430\u044f\u0432\u043a\u0443 \u0432 \u0441\u0442\u0430\u0442\u0443\u0441\u0435 "\u041e\u0442\u043a\u043b\u043e\u043d\u0435\u043d\u043e", \u0442\u043e \u0438\u0437\u043c\u0435\u043d\u0438\u0442\u044c \u0441\u0442\u0430\u0442\u0443\u0441 \u044d\u0442\u043e\u0439 \u0437\u0430\u044f\u0432\u043a\u0438 \u0432 \u0431\u0443\u0434\u0443\u0449\u0435\u043c \u0431\u0443\u0434\u0435\u0442 \u043d\u0435\u0432\u043e\u0437\u043c\u043e\u0436\u043d\u043e.',buttonOkText:"\u0421\u043e\u0445\u0440\u0430\u043d\u0438\u0442\u044c",buttonCancelText:"\u041e\u0442\u043c\u0435\u043d\u0438\u0442\u044c"}}).afterClosed()}getChangeStatusBody(e,n){return{comment:"comment",created_at:new Date,order_id:e.id,status:n}}openEditApplicationStatusModal(e){return this.dialog.open(de,{..._,data:{application:e,statuses:this.applicationStatuses,statusTranslation:this.getApplicationStatusName(e.last_status),rentPeriod:this.getRentPeriodValue(e)}}).afterClosed()}static#t=this.\u0275fac=function(n){return new(n||u)(t.LFG(y),t.LFG(p.uw),t.LFG(B.yh),t.LFG(V.T),t.LFG($.I))};static#e=this.\u0275prov=t.Yz7({token:u,factory:u.\u0275fac})}return u})();const Oe=function(){return[]},ke=[{path:"",redirectTo:N.$.Equipments,pathMatch:"full"},{path:N.$.Equipments,resolve:{equipmentsStatuses:qt,equipmentCategories:Ot},pathMatch:"full",component:U},{path:N.$.Users,pathMatch:"full",component:ve},{path:N.$.Roles,resolve:{roles:(u,o,e=(0,t.f3M)(Tt))=>e.getRoles()},pathMatch:"full",component:Te},{path:N.$.Applications,pathMatch:"full",resolve:{applicationStatuses:(u,o,e=(0,t.f3M)(At))=>e.getApplicationStatusNames()},component:(()=>{class u{get applications$(){return this.controller.applicationsData$}constructor(e){this.controller=e,this.columns=qe}ngOnInit(){this.controller.fetchApplications().subscribe(),this.controller.setPageTitle()}editApplication(e){this.controller.editApplication(e)}static#t=this.\u0275fac=function(n){return new(n||u)(t.Y36(Mt))};static#e=this.\u0275cmp=t.Xpm({type:u,selectors:[["lc-applications"]],features:[t._Bn([Mt])],decls:2,vars:6,consts:[[3,"columns","limit","data","action"]],template:function(n,i){1&n&&(t.TgZ(0,"lc-table",0),t.NdJ("action",function(h){return i.editApplication(h)}),t.ALo(1,"async"),t.qZA()),2&n&&t.Q6J("columns",i.columns)("limit",20)("data",t.lcZ(1,3,i.applications$)||t.DdM(5,Oe))},dependencies:[L.a,m.Ov],changeDetection:0})}return u})()}];let Se=(()=>{class u{static#t=this.\u0275fac=function(n){return new(n||u)};static#e=this.\u0275mod=t.oAB({type:u});static#u=this.\u0275inj=t.cJS({providers:[De.u],imports:[ht.Bz.forChild(ke),ht.Bz]})}return u})();var Ie=s(325),we=s(2615);let Pe=(()=>{class u{static#t=this.\u0275fac=function(n){return new(n||u)};static#e=this.\u0275mod=t.oAB({type:u});static#u=this.\u0275inj=t.cJS({providers:[y,lt,qt,Ot,Tt,At],imports:[m.ez,Se,Ie.m,a.UX,we.x,ot.Bb]})}return u})()}}]);